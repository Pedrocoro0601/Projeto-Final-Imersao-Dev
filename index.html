<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Uberaba - MG </title>
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Fira+Code:wght@300;400;500;600&family=Inter:wght@300;400;600;700;800&family=Segoe+UI:wght@300;400;600;700&display=swap" rel="stylesheet">
    
    <!-- Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <!-- Libraries -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>

    <style>
        :root {
            /* --- WALLPAPER CONFIGURATION --- */
            --wallpaper-lock: url('Telabloqueio.jpg');
            --wallpaper-desk: url('Windows10.png');
            
            /* --- USER AVATAR --- */
            --user-avatar: url('Pedro.jpg'); 

            /* --- COLORS --- */
            --bg-black: #000000;
            --win-bg: #f3f3f3;
            --win-blue: #0078d7;
            --vscode-bg: #1e1e1e;
            --vscode-sidebar: #252526;
            --vscode-statusbar: #007acc;
            
            /* --- PREVIEW VARIABLES --- */
            --preview-bg: #050505;
            --preview-gold: #D4AF37;
            --gemini-grad-start: #4b90ff;
            --gemini-grad-end: #ff5546;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; cursor: default; }

        /* FIX: Lock body to viewport to prevent page scrolling on mobile */
        body {
            background: var(--bg-black);
            color: white;
            font-family: 'Segoe UI', sans-serif;
            overflow: hidden;
            width: 100vw;
            height: 100dvh; /* Use dynamic viewport height */
            position: fixed; /* Force fixed to prevent scroll bounce */
            inset: 0;
            user-select: none;
            -webkit-user-select: none;
        }

        /* =========================================
           SCENE 1: POWER BUTTON
           ========================================= */
        #scene-power {
            position: absolute; inset: 0;
            background: #050505;
            display: flex; flex-direction: column;
            justify-content: center; align-items: center;
            z-index: 100;
            padding: 20px;
            text-align: center;
        }

        .power-btn {
            width: 80px; height: 80px;
            border-radius: 50%;
            border: 2px solid #333;
            background: radial-gradient(circle, #222, #111);
            color: #555;
            font-size: 2rem;
            display: flex; justify-content: center; align-items: center;
            cursor: pointer;
            transition: all 0.3s;
        }

        .power-btn:hover {
            color: #fff;
            border-color: #fff;
            box-shadow: 0 0 20px rgba(255, 255, 255, 0.2);
        }

        .power-msg {
            margin-top: 30px;
            font-family: 'Fira Code', monospace;
            color: #666;
            font-size: 0.9rem;
            letter-spacing: 1px;
            opacity: 0;
            animation: fadeIn 2s forwards;
        }

        .mobile-disclaimer {
            margin-top: 20px;
            font-family: 'Segoe UI', sans-serif;
            color: #444;
            font-size: 0.8rem;
            max-width: 300px;
            line-height: 1.4;
            display: none; /* Hidden on Desktop */
            opacity: 0;
            animation: fadeIn 2s 1s forwards;
        }

        @keyframes fadeIn { to { opacity: 1; } }

        /* =========================================
           SCENE 2: BIOS / BOOT
           ========================================= */
        #scene-bios {
            position: absolute; inset: 0;
            background: black;
            padding: 40px;
            font-family: 'Fira Code', monospace;
            font-size: 14px;
            color: #ccc;
            display: none;
            z-index: 90;
            overflow-y: auto; /* Allow internal scroll if bios text is long */
        }
        .bios-line { margin-bottom: 5px; }
        .bios-highlight { color: yellow; }

        /* =========================================
           SCENE 3: WINDOWS LOCK & LOGIN
           ========================================= */
        #scene-login {
            position: absolute; inset: 0;
            background: var(--wallpaper-lock) no-repeat center center/cover;
            display: none;
            flex-direction: column;
            align-items: center;
            z-index: 80;
            transition: backdrop-filter 0.5s;
        }

        #lock-screen-content {
            margin-top: 15vh;
            text-align: center;
            text-shadow: 0 2px 10px rgba(0,0,0,0.5);
        }
        .lock-time { font-size: 6rem; font-weight: 300; }
        .lock-date { font-size: 2rem; font-weight: 400; }

        #login-form {
            display: none;
            flex-direction: column;
            align-items: center;
            
            /* CENTERING FIX */
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 90%; /* Mobile friendly */
            max-width: 400px; /* Desktop limit */
            
            background: rgba(0,0,0,0.4);
            padding: 40px;
            border-radius: 10px;
            backdrop-filter: blur(15px);
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            z-index: 85;
        }
        .user-avatar {
            width: 100px; height: 100px;
            background-color: #333;
            background-image: var(--user-avatar);
            background-size: cover;
            background-position: center;
            border-radius: 50%;
            margin-bottom: 15px;
            display: flex; justify-content: center; align-items: center;
            font-size: 2rem; color: white;
            border: 2px solid rgba(255,255,255,0.2);
        }
        .user-name { font-size: 1.5rem; margin-bottom: 20px; font-weight: 600; text-align: center; }
        .pass-input {
            background: rgba(255,255,255,0.9);
            border: 2px solid transparent;
            padding: 10px 15px;
            width: 100%;
            border-radius: 4px;
            font-size: 1rem;
            margin-bottom: 15px;
            pointer-events: none; /* Auto typed */
        }
        .login-btn {
            background: var(--win-blue);
            color: white; border: none;
            padding: 10px 30px;
            border-radius: 4px;
            font-weight: 600;
            opacity: 0.5;
            cursor: pointer;
        }

        /* =========================================
           SCENE 4: DESKTOP
           ========================================= */
        #scene-desktop {
            position: absolute; inset: 0;
            background: var(--wallpaper-desk) no-repeat center center/cover;
            display: none;
            z-index: 70;
        }

        .desktop-grid {
            padding: 20px;
            display: flex;
            flex-direction: column;
            flex-wrap: wrap;
            height: 90%;
            align-content: flex-start;
            gap: 15px;
        }

        .desktop-icon {
            width: 100px; margin: 5px;
            display: flex; flex-direction: column; align-items: center;
            text-align: center; color: white;
            text-shadow: 0 1px 3px black; cursor: pointer;
            padding: 10px; border: 1px solid transparent; border-radius: 4px;
            transition: background 0.2s;
        }
        .desktop-icon:hover { background: rgba(255,255,255,0.1); border-color: rgba(255,255,255,0.2); }
        .icon-img { font-size: 2.2rem; margin-bottom: 8px; filter: drop-shadow(0 4px 4px rgba(0,0,0,0.5)); }
        .icon-label { font-size: 0.8rem; line-height: 1.2; }

        /* --- PHOTOS FOLDER WINDOW --- */
        .os-window {
            position: absolute; top: 10%; left: 15%; width: 70%; height: 70%;
            background: #f0f0f0; color: #000;
            border: 1px solid #666;
            box-shadow: 0 15px 50px rgba(0,0,0,0.5);
            display: none; flex-direction: column;
            z-index: 150; font-family: 'Segoe UI', sans-serif;
            border-radius: 6px; overflow: hidden;
        }
        .os-header { background: #fff; padding: 0; border-bottom: 1px solid #ddd; display: flex; flex-direction: column; }
        .os-titlebar { display: flex; justify-content: space-between; align-items: center; padding: 8px 12px; }
        .os-title { font-size: 12px; display: flex; align-items: center; gap: 10px; color: #333; }
        .os-controls { display: flex; gap: 5px; }
        .os-btn { width: 40px; height: 30px; display: flex; justify-content: center; align-items: center; font-size: 14px; cursor: pointer; transition: 0.2s; border: none; background: transparent; }
        .os-btn:hover { background: #e5e5e5; }
        .os-btn.close:hover { background: #e81123; color: white; }
        
        .os-toolbar { padding: 8px 12px; background: #f9f9f9; border-bottom: 1px solid #ddd; display: flex; gap: 15px; font-size: 13px; color: #555; align-items: center; }
        .os-toolbar span { cursor: pointer; }
        .os-toolbar span:hover { color: #000; }

        .os-body { flex: 1; padding: 20px; overflow-y: auto; background: #fff; }
        
        .photo-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(160px, 1fr)); gap: 20px; }
        .photo-item {
            display: flex; flex-direction: column; align-items: center;
            padding: 10px; cursor: pointer; border: 1px solid transparent;
            border-radius: 4px;
        }
        .photo-item:hover { background: #e5f3ff; border-color: #cce8ff; }
        .photo-frame {
            width: 100%; height: 110px; background: #eee;
            margin-bottom: 8px; display: flex; justify-content: center; align-items: center;
            overflow: hidden; box-shadow: 0 2px 5px rgba(0,0,0,0.1); border: 1px solid #ddd;
        }
        .photo-frame img { width: 100%; height: 100%; object-fit: cover; transition: 0.3s; }
        .photo-item:hover img { transform: scale(1.05); }
        .photo-name { font-size: 12px; text-align: center; color: #333; word-break: break-all;}


        /* Windows Generic Error Dialog (Fake) */
        #win-error-box {
            position: absolute; top: 50%; left: 50%;
            transform: translate(-50%, -50%);
            width: 380px;
            background: #fff;
            color: #000;
            border: 1px solid #aaa;
            box-shadow: 5px 5px 15px rgba(0,0,0,0.3);
            display: none;
            flex-direction: column;
            z-index: 800;
            font-family: 'Segoe UI', sans-serif;
        }
        .win-err-header {
            background: white; padding: 8px 10px;
            display: flex; justify-content: space-between; align-items: center;
            font-size: 12px;
        }
        .win-err-title { font-weight: 500; }
        .win-err-close { 
            cursor: pointer; font-size: 16px; line-height: 1; color: #555; 
            width: 24px; height: 24px; display: flex; justify-content: center; align-items: center;
        }
        .win-err-close:hover { background: #e81123; color: white; }
        
        .win-err-body {
            padding: 20px; background: #f0f0f0; display: flex; gap: 15px; align-items: center;
        }
        .win-err-icon {
            font-size: 32px; color: #d92027;
        }
        .win-err-msg { font-size: 13px; color: #333; flex: 1; }
        
        .win-err-footer {
            background: #f0f0f0; padding: 15px; padding-top: 0;
            display: flex; justify-content: flex-end;
        }
        .win-err-btn {
            padding: 4px 25px; background: #e1e1e1; border: 1px solid #adadad;
            font-size: 12px; cursor: pointer; min-width: 80px;
        }
        .win-err-btn:hover { background: #e5f1fb; border-color: #0078d7; }
        .win-err-btn:focus { border-color: #0078d7; box-shadow: 0 0 0 1px #0078d7 inset; }


        /* Windows Notification */
        .win-notification {
            position: fixed; bottom: 20px; right: -400px;
            width: 350px; background: #1f1f1f;
            border: 1px solid #333; border-radius: 8px;
            padding: 15px; display: flex; gap: 15px;
            z-index: 2000; box-shadow: 0 10px 30px rgba(0,0,0,0.5);
            font-family: 'Segoe UI'; transition: right 0.5s ease;
        }
        .notif-icon { font-size: 24px; color: var(--win-blue); }
        .notif-content h4 { font-size: 14px; margin-bottom: 5px; color: white; }
        .notif-content p { font-size: 12px; color: #ccc; }

        /* Alert Modal (Critical Error inside VS Code) */
        #error-modal {
            position: absolute; top: 50%; left: 50%;
            transform: translate(-50%, -50%) scale(0.8);
            width: 400px;
            background: rgba(30, 30, 30, 0.95);
            border: 1px solid #ff3333;
            border-radius: 12px;
            padding: 0;
            display: none; opacity: 0;
            flex-direction: column;
            z-index: 3000;
            box-shadow: 0 20px 60px rgba(0,0,0,0.8);
            backdrop-filter: blur(10px);
        }
        .modal-header {
            padding: 15px; border-bottom: 1px solid #444;
            display: flex; justify-content: space-between; align-items: center;
            background: rgba(255, 0, 0, 0.1);
            border-radius: 12px 12px 0 0;
        }
        .modal-title { color: white; font-weight: 600; font-size: 14px; display: flex; align-items: center; gap: 10px; }
        .modal-close { cursor: pointer; color: #aaa; transition: 0.2s; font-size: 16px; width: 24px; height: 24px; display: flex; align-items: center; justify-content: center; border-radius: 4px; }
        .modal-close:hover { background: #ff3333; color: white; }
        
        .modal-body { padding: 30px 20px; text-align: center; color: #ddd; font-size: 14px; line-height: 1.5; }
        .error-icon { font-size: 40px; color: #ff3333; margin-bottom: 15px; display: block; }
        .modal-footer { padding: 15px; border-top: 1px solid #444; text-align: right; }
        .modal-btn { padding: 8px 20px; background: #333; color: white; border: 1px solid #555; border-radius: 4px; cursor: pointer; font-size: 12px; }
        .modal-btn:hover { background: #444; }

        /* GEMINI SUCCESS MODAL */
        #gemini-success-modal {
            position: absolute; top: 50%; left: 50%;
            transform: translate(-50%, -50%) scale(0.8);
            width: 500px;
            background: rgba(20, 20, 30, 0.95);
            border: 2px solid transparent;
            background-image: linear-gradient(rgba(20, 20, 30, 0.95), rgba(20, 20, 30, 0.95)), linear-gradient(45deg, #4b90ff, #ff5546);
            background-origin: border-box;
            background-clip: content-box, border-box;
            
            border-radius: 16px;
            padding: 0;
            display: none; opacity: 0;
            flex-direction: column;
            z-index: 3100;
            box-shadow: 0 0 50px rgba(75, 144, 255, 0.2);
            backdrop-filter: blur(15px);
        }

        .gemini-header {
            padding: 20px;
            background: linear-gradient(to right, rgba(75, 144, 255, 0.1), rgba(255, 85, 70, 0.1));
            display: flex; justify-content: space-between; align-items: center;
            border-radius: 14px 14px 0 0;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }
        .gemini-title {
            font-size: 18px; font-weight: 700;
            background: linear-gradient(to right, #4b90ff, #ff5546);
            -webkit-background-clip: text; background-clip: text; color: transparent;
            display: flex; align-items: center; gap: 10px;
        }
        
        .gemini-body {
            padding: 30px; text-align: center; color: #eee;
        }
        .gemini-body h2 { font-size: 24px; margin-bottom: 15px; font-weight: 300; }
        .gemini-body strong { color: #fff; font-weight: 700; }
        .gemini-body p { margin-bottom: 15px; line-height: 1.6; color: #ccc; font-size: 14px; }

        .gemini-close {
            cursor: pointer; width: 30px; height: 30px;
            display: flex; justify-content: center; align-items: center;
            border-radius: 50%; background: rgba(255,255,255,0.1);
            color: white; font-size: 14px; transition: 0.3s;
        }
        .gemini-close:hover { background: rgba(255,255,255,0.3); transform: rotate(90deg); }


        /* =========================================
           SCENE 5: VS CODE (The App)
           ========================================= */
        #scene-vscode {
            position: absolute; top: 50%; left: 50%;
            width: 95%; height: 90%;
            transform: translate(-50%, -50%) scale(0.8);
            background: var(--vscode-bg);
            display: none; flex-direction: column;
            z-index: 75; opacity: 0;
            border-radius: 8px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.5);
            overflow: hidden; border: 1px solid #333;
        }

        /* Title Bar */
        .vs-titlebar {
            height: 30px; background: #333;
            display: flex; align-items: center; justify-content: center;
            color: #ccc; font-size: 12px; position: relative;
            flex-shrink: 0;
        }
        .vs-controls { position: absolute; right: 0; display: flex; }
        .vs-control { width: 40px; height: 30px; display: flex; justify-content: center; align-items: center; }
        .vs-control.close:hover { background: #e81123; color: white; }

        /* Main Area */
        .vs-body { flex: 1; display: flex; overflow: hidden; }

        /* Sidebar */
        .vs-activitybar { width: 50px; background: #333; display: flex; flex-direction: column; align-items: center; padding-top: 10px; gap: 20px; color: #858585; font-size: 24px; flex-shrink: 0; }
        .vs-activitybar i:first-child { color: white; border-left: 2px solid white; padding-left: 10px; margin-left: -12px; }
        
        .vs-sidebar { width: 200px; background: var(--vscode-sidebar); border-right: 1px solid #111; padding: 10px; font-size: 13px; color: #ccc; flex-shrink: 0; }
        .vs-file-tree { margin-top: 10px; margin-left: 10px; }
        .vs-file { display: flex; align-items: center; gap: 6px; padding: 3px; color: #d4d4d4; cursor: pointer; background: transparent; }
        .vs-file.active { background: #37373d; }
        .vs-file i.react-icon { color: #61dbfb; }
        
        /* Gemini Icon in Sidebar */
        .gemini-file { 
            margin-top: 20px; border-top: 1px solid #333; padding-top: 10px; 
            color: #aaa; cursor: pointer; opacity: 0.5; transition: all 0.3s;
        }
        .gemini-file:hover, .gemini-file.pulse { color: white; opacity: 1; }
        .gemini-file.pulse { animation: pulse-glow 1.5s infinite; }
        
        @keyframes pulse-glow {
            0% { text-shadow: 0 0 0px rgba(75, 144, 255, 0); }
            50% { text-shadow: 0 0 10px rgba(75, 144, 255, 0.8); }
            100% { text-shadow: 0 0 0px rgba(75, 144, 255, 0); }
        }

        .gemini-icon-glow {
            background: linear-gradient(to right, var(--gemini-grad-start), var(--gemini-grad-end));
            -webkit-background-clip: text; background-clip: text; color: transparent;
        }

        /* Editor Area */
        .vs-editor-area { flex: 1; display: flex; }
        
        /* Code Panel (Left) */
        .vs-code-panel { 
            width: 60%; 
            background: var(--vscode-bg); 
            display: flex; flex-direction: column;
            border-right: 1px solid #111;
            min-height: 0; /* FIX: Prevent flex item from overflowing parent */
        }
        .vs-tabs { background: var(--vscode-sidebar); display: flex; height: 35px; flex-shrink: 0; }
        .vs-tab { 
            background: var(--vscode-bg); color: #fff; 
            padding: 8px 15px; font-size: 13px; 
            border-top: 1px solid #007acc;
            display: flex; align-items: center; gap: 8px;
        }
        .vs-code-content {
            flex: 1; padding: 10px; 
            font-family: 'Fira Code', monospace; 
            font-size: 12px; line-height: 1.5;
            color: #d4d4d4; 
            overflow-y: auto;
            position: relative; 
            scroll-behavior: smooth;
            white-space: pre;
            min-height: 0; /* FIX: Critical for flex containers scrolling correctly */
        }
        
        /* Preview Panel (Right) - Adapted for the new request */
        .vs-preview-panel { 
            width: 40%; 
            background-color: var(--preview-bg); /* Uses new CSS var */
            position: relative; 
            overflow: hidden;
            display: flex; 
            justify-content: center; 
            align-items: center;
            opacity: 0; /* Starts Hidden */
            transition: opacity 1.5s ease-in;
        }
        
        /* Syntax Highlighting for Code Editor */
        .k-import { color: #c586c0; } 
        .k-var { color: #569cd6; }   
        .k-func { color: #dcdcaa; }  
        .k-tag { color: #569cd6; }    
        .k-attr { color: #9cdcfe; }   
        .k-str { color: #ce9178; }    
        .k-comment { color: #6a9955; }
        .k-bracket { color: #ffd700; }
        .k-def { color: #9cdcfe; }
        .k-obj { color: #4ec9b0; }
        
        .typing-cursor {
            display: inline-block; width: 2px; height: 16px; background: white;
            animation: blink 1s infinite; vertical-align: middle;
        }

        .typing-hint {
            position: absolute; bottom: 30px; right: 20px;
            background: #252526; padding: 8px 15px; border: 1px solid #333;
            color: #aaa; font-size: 12px; font-family: 'Segoe UI';
            border-radius: 4px; pointer-events: none;
            opacity: 0.8; animation: pulse 2s infinite;
        }

        /* Glitch Effect Class */
        .glitch-error {
            animation: glitch-anim 0.2s infinite;
            filter: hue-rotate(90deg) contrast(1.2);
            border: 2px solid red !important;
            box-shadow: 0 0 20px rgba(255, 0, 0, 0.3);
        }
        
        @keyframes glitch-anim {
            0% { transform: translate(-50%, -50%) scale(1); }
            20% { transform: translate(calc(-50% - 2px), calc(-50% + 2px)) scale(1); }
            40% { transform: translate(calc(-50% - 2px), calc(-50% - 2px)) scale(1); }
            60% { transform: translate(calc(-50% + 2px), calc(-50% + 2px)) scale(1); }
            80% { transform: translate(calc(-50% + 2px), calc(-50% - 2px)) scale(1); }
            100% { transform: translate(-50%, -50%) scale(1); }
        }

        /* --- PREVIEW UI ELEMENTS (New Request) --- */
        #scene-container {
            position: absolute;
            inset: 0;
            z-index: 1;
            background: radial-gradient(circle at center, #111 0%, #000 100%);
        }

        canvas {
            display: block;
            width: 100%;
            height: 100%;
            outline: none;
        }

        .interface-layer {
            position: absolute;
            inset: 0;
            z-index: 10;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            pointer-events: none;
        }

        .brand-container {
            text-align: center;
            pointer-events: auto;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .brand-title {
            font-size: 2.5rem; /* Scaled down for preview panel */
            font-weight: 800;
            color: white;
            text-align: center;
            text-shadow: 0 0 30px rgba(255, 255, 255, 0.3);
            line-height: 1.1;
            margin-bottom: 10px;
            font-family: 'Inter', sans-serif;
        }

        .cursor {
            display: inline-block;
            width: 4px;
            height: 1em;
            background-color: #fff;
            vertical-align: bottom;
            animation: blink 1s step-end infinite;
            margin-left: 5px;
        }

        .brand-meta {
            margin-top: 15px;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 5px;
        }

        .alura-gemini-text {
            font-weight: 700;
            font-size: 0.8rem;
            letter-spacing: 2px;
            background: linear-gradient(to right, #ffffff, #4b90ff);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            opacity: 0;
            transform: translateY(20px);
            font-family: 'Inter', sans-serif;
        }

        .project-subtitle {
            font-size: 0.9rem;
            letter-spacing: 4px;
            color: #888;
            text-transform: uppercase;
            font-weight: 300;
            opacity: 0;
            transform: translateY(20px);
            font-family: 'Inter', sans-serif;
        }

        .primary-action {
            margin-top: 30px;
            padding: 10px 30px;
            background: transparent;
            border: 1px solid rgba(255, 255, 255, 0.3);
            color: white;
            border-radius: 50px;
            font-size: 0.8rem;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
            font-weight: 600;
            letter-spacing: 2px;
            opacity: 0;
            transform: translateY(20px);
            font-family: 'Inter', sans-serif;
            pointer-events: auto;
        }

        .primary-action:hover {
            background: white;
            color: black;
            box-shadow: 0 0 30px rgba(255, 255, 255, 0.5);
            transform: translateY(20px) scale(1.05);
        }

        .primary-action:active {
            transform: translateY(20px) scale(0.95);
        }

        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #1e1e1e; }
        ::-webkit-scrollbar-thumb { background: #444; border-radius: 4px; }
        
        @keyframes pulse { 0%,100% {opacity: 0.5} 50% {opacity: 1} }
        @keyframes blink { 50% {opacity: 0} }

        /* =========================================
           MOBILE RESPONSIVENESS (Advanced)
           ========================================= */
        @media (max-width: 768px) {
            body { 
                overflow: hidden; 
                position: fixed; 
                height: 100%; 
                width: 100%; 
            }
            
            .desktop-icon { width: 80px; }
            .icon-img { font-size: 1.8rem; }
            .icon-label { font-size: 0.7rem; }
            .desktop-grid { flex-direction: row; align-content: flex-start; gap: 10px; padding: 15px; }

            .mobile-disclaimer { display: block; }

            /* VS Code Mobile Layout */
            #scene-vscode {
                width: 100%;
                height: 100%;
                border: none;
                border-radius: 0;
                transform: none !important;
                top: 0; left: 0;
            }

            .vs-body {
                flex-direction: column;
            }

            /* Hide Sidebars on Mobile to maximize space */
            .vs-activitybar, .vs-sidebar {
                display: none;
            }

            .vs-editor-area {
                flex-direction: column;
                height: 100%;
                overflow: hidden; /* Prevents container expansion */
            }

            /* Code Panel on Top (50%) */
            .vs-code-panel {
                width: 100%;
                height: 50%; /* Strict height */
                flex-basis: 50%;
                border-right: none;
                border-bottom: 1px solid #333;
            }

            .vs-code-content {
                font-size: 10px; /* Smaller font for code */
                padding: 5px;
            }

            /* Preview Panel on Bottom (50%) */
            .vs-preview-panel {
                width: 100%;
                height: 50%; /* Strict height */
                flex-basis: 50%;
                opacity: 1; /* Visible immediately on mobile */
            }

            /* Adjust Preview Elements for small space */
            .brand-title {
                font-size: 1.8rem;
                margin-bottom: 5px;
            }
            .alura-gemini-text { font-size: 0.6rem; }
            .project-subtitle { font-size: 0.7rem; }
            
            .primary-action {
                margin-top: 15px;
                padding: 8px 20px;
                font-size: 0.7rem;
                transform: translateY(0); /* Reset transform logic for simple show */
            }

            .typing-hint {
                bottom: 5px; right: 5px;
                padding: 4px 8px; font-size: 10px;
            }
        }

    </style>
</head>
<body>

    <!-- NOTIFICATION SYSTEM -->
    <div class="win-notification" id="win-notif">
        <div class="notif-icon"><i class="fa-brands fa-windows"></i></div>
        <div class="notif-content" id="notif-text">
            <h4>Sistema Pronto</h4>
            <p>Clique no ícone VS Code para iniciar.</p>
        </div>
    </div>

    <!-- DESKTOP WINDOWS ERROR DIALOG -->
    <div id="win-error-box">
        <div class="win-err-header">
            <span class="win-err-title">Erro do Sistema</span>
            <div class="win-err-close" onclick="closeWinError()">✕</div>
        </div>
        <div class="win-err-body">
            <div class="win-err-icon">
                <i class="fa-solid fa-circle-xmark"></i>
            </div>
            <div class="win-err-msg" id="win-error-msg-text">
                O Windows não pode abrir este arquivo. Acesso restrito ao ambiente de desenvolvimento.
            </div>
        </div>
        <div class="win-err-footer">
            <button class="win-err-btn" onclick="closeWinError()">OK</button>
        </div>
    </div>

    <!-- ALERT MODAL (CRITICAL ERROR IN VSCODE) -->
    <div id="error-modal">
        <div class="modal-header">
            <div class="modal-title">
                <i class="fa-solid fa-triangle-exclamation" style="color: #ff3333"></i> Runtime Error
            </div>
            <div class="modal-close" id="btn-close-modal"><i class="fa-solid fa-xmark"></i></div>
        </div>
        <div class="modal-body">
            <i class="fa-solid fa-bug error-icon"></i>
            <p><strong>CRITICAL FAILURE DETECTED</strong></p>
            <p style="margin-top: 10px; color: #aaa;">O código contém erros de sintaxe que impossibilitam a compilação do projeto.</p>
            <p style="margin-top: 10px; color: #fff;">Sugerido: Utilize a extensão <strong>Google Gemini AI</strong> na barra lateral para reescrever e corrigir o código.</p>
        </div>
        <div class="modal-footer">
            <button class="modal-btn" id="btn-ack-error">Entendido</button>
        </div>
    </div>

    <!-- SUCCESS MODAL (GEMINI PROMO) -->
    <div id="gemini-success-modal">
        <div class="gemini-header">
            <div class="gemini-title">
                <i class="fa-solid fa-wand-magic-sparkles"></i> Google Gemini AI
            </div>
            <div class="gemini-close" id="btn-close-success">
                <i class="fa-solid fa-xmark"></i>
            </div>
        </div>
        <div class="gemini-body">
            <h2>Código Otimizado com Sucesso!</h2>
            <p>
                Através da parceria <strong>Alura + Google Gemini</strong>, utilizamos o poder da inteligência artificial para acelerar o desenvolvimento e corrigir bugs complexos em segundos.
            </p>
            <p style="color: #888; font-size: 12px;">Imersão Dev • Projeto Uberaba City • 2025</p>
        </div>
    </div>

    <!-- 1. POWER SCENE -->
    <div id="scene-power">
        <div class="power-btn" id="btn-power">
            <i class="fa-solid fa-power-off"></i>
        </div>
        <div class="power-msg">LIGAR COMPUTADOR </div>
        <!-- Mobile Disclaimer -->
        <div class="mobile-disclaimer">
            A imersão completa de programar a entrada do site é somente quando acessado pelo computador. Pelo celular o processo é automático.
        </div>
    </div>

    <!-- 2. BIOS SCENE -->
    <div id="scene-bios">
        <div id="bios-text"></div>
    </div>

    <!-- 3. LOGIN SCENE -->
    <div id="scene-login">
        <div id="lock-screen-content">
            <div class="lock-time" id="clock-time">10:00</div>
            <div class="lock-date" id="clock-date">Terça-feira, 20 de Maio</div>
        </div>

        <div id="login-form">
            <div class="user-avatar">
                <i class="fa-solid fa-user" style="opacity: 0.5;"></i>
            </div>
            <div class="user-name">Pedro Henrique</div>
            <input type="password" class="pass-input" id="pass-input" placeholder="Senha">
            <button class="login-btn">Entrar</button>
        </div>
    </div>

    <!-- 4. DESKTOP SCENE -->
    <div id="scene-desktop">
        <div class="desktop-grid">
            <div class="desktop-icon" onclick="openTrash()">
                <i class="fa-solid fa-trash-can icon-img" style="color: #ddd"></i>
                <div class="icon-label">Lixeira</div>
            </div>
            <div class="desktop-icon" onclick="wrongIcon('Meu Computador')">
                <i class="fa-solid fa-desktop icon-img" style="color: #fff"></i>
                <div class="icon-label">Meu Computador</div>
            </div>
            <div class="desktop-icon" onclick="openPhotos()">
                <i class="fa-solid fa-images icon-img" style="color: #00bcd4"></i>
                <div class="icon-label">Fotos</div>
            </div>
            <div class="desktop-icon" onclick="wrongIcon('Spotify')">
                <i class="fa-brands fa-spotify icon-img" style="color: #1db954"></i>
                <div class="icon-label">Spotify</div>
            </div>
            <div class="desktop-icon" id="icon-vscode">
                <i class="fa-solid fa-code icon-img" style="color: #0078d7"></i>
                <div class="icon-label">Visual Studio Code</div>
            </div>
            <div class="desktop-icon" onclick="wrongIcon('Configurações')">
                <i class="fa-solid fa-gear icon-img" style="color: #aaa"></i>
                <div class="icon-label">Configurações</div>
            </div>
            <div class="desktop-icon" onclick="wrongIcon('Google Chrome')">
                <i class="fa-brands fa-chrome icon-img" style="color: #ffce44"></i>
                <div class="icon-label">Google Chrome</div>
            </div>
        </div>

        <!-- PHOTOS FOLDER WINDOW -->
        <div id="window-photos" class="os-window">
            <div class="os-header">
                <div class="os-titlebar">
                    <div class="os-title"><i class="fa-solid fa-folder-open" style="color:#ffce44;"></i> Fotos - Uberaba Site</div>
                    <div class="os-controls">
                        <button class="os-btn"><i class="fa-solid fa-minus"></i></button>
                        <button class="os-btn"><i class="fa-regular fa-square"></i></button>
                        <button class="os-btn close" onclick="closePhotos()"><i class="fa-solid fa-xmark"></i></button>
                    </div>
                </div>
                <div class="os-toolbar">
                    <span>Arquivo</span>
                    <span>Início</span>
                    <span>Compartilhar</span>
                    <span>Exibir</span>
                </div>
            </div>
            <div class="os-body">
                <div class="photo-grid">
                    <div class="photo-item">
                        <div class="photo-frame"><img src="Museu.png" alt="Print 1"></div>
                        <div class="photo-name">PrintSiteMuseu</div>
                    </div>
                    <div class="photo-item">
                        <div class="photo-frame"><img src="Time.png" alt="Print 2"></div>
                        <div class="photo-name">PrintSiteTme</div>
                    </div>
                    <div class="photo-item">
                        <div class="photo-frame"><img src="CIA.png" alt="Print 3"></div>
                        <div class="photo-name">PrintSiteCia</div>
                    </div>
                    <div class="photo-item">
                        <div class="photo-frame"><img src="Gnetica de ouro.png" alt="Print 4"></div>
                        <div class="photo-name">PrintSiteGenetica</div>
                    </div>
                    <div class="photo-item">
                        <div class="photo-frame"><img src="Inicio.png" alt="Print 5"></div>
                        <div class="photo-name">PrintSiteInicio</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- WINDOW TRASH -->
        <div id="window-trash" class="os-window">
            <div class="os-header">
                <div class="os-titlebar">
                    <div class="os-title"><i class="fa-solid fa-trash-can" style="color:#888;"></i> Lixeira</div>
                    <div class="os-controls">
                        <button class="os-btn"><i class="fa-solid fa-minus"></i></button>
                        <button class="os-btn"><i class="fa-regular fa-square"></i></button>
                        <button class="os-btn close" onclick="closeTrash()"><i class="fa-solid fa-xmark"></i></button>
                    </div>
                </div>
                <div class="os-toolbar">
                    <span>Arquivo</span>
                    <span>Início</span>
                    <span>Compartilhar</span>
                    <span>Exibir</span>
                    <span style="color: red; margin-left: auto; font-size: 11px; font-weight: 600;">Ferramentas de Lixeira</span>
                </div>
            </div>
            <div class="os-body">
                <div class="photo-grid">
                    <div class="photo-item">
                        <div class="photo-frame"><img src="Lixo1.webp" alt="Arquivo Deletado 1"></div>
                        <div class="photo-name"></div>
                    </div>
                    <div class="photo-item">
                        <div class="photo-frame"><img src="Lixo2.png" alt="Arquivo Deletado 2"></div>
                        <div class="photo-name"></div>
                    </div>
                </div>
            </div>
        </div>

    </div>

    <!-- 5. VS CODE SCENE -->
    <div id="scene-vscode">
        <div class="vs-titlebar">
            <span id="vs-window-title">index.html - Visual Studio Code</span>
            <div class="vs-controls">
                <div class="vs-control"><i class="fa-solid fa-minus"></i></div>
                <div class="vs-control"><i class="fa-regular fa-square"></i></div>
                <div class="vs-control close"><i class="fa-solid fa-xmark"></i></div>
            </div>
        </div>

        <div class="vs-body">
            <!-- Sidebar -->
            <div class="vs-activitybar">
                <i class="fa-regular fa-file"></i>
                <i class="fa-solid fa-magnifying-glass"></i>
                <i class="fa-solid fa-code-branch"></i>
            </div>

            <div class="vs-sidebar">
                <div>EXPLORER</div>
                <div class="vs-file-tree">
                    <div style="font-weight: bold; margin-bottom: 5px;"><i class="fa-solid fa-angle-down"></i> PROJETO-UBERABA</div>
                    <div id="file-html" class="vs-file active"><i class="fa-brands fa-html5" style="color: #e65100"></i> index.html</div>
                    <div id="file-css" class="vs-file"><i class="fa-brands fa-css3" style="color: #42a5f5"></i> styles.css</div>
                    <div id="file-js" class="vs-file"><i class="fa-brands fa-js" style="color: #fdd835"></i> main.js</div>
                    <div class="vs-file"><i class="fa-solid fa-gear" style="color: #aaa"></i> config.json</div>
                    
                    <!-- Gemini File -->
                    <div class="gemini-file" id="gemini-tool">
                        <i class="fa-solid fa-wand-magic-sparkles gemini-icon-glow"></i> 
                        <span style="margin-left: 8px; font-weight: bold; font-size: 11px;">USAR GEMINI</span>
                    </div>
                </div>
            </div>

            <!-- Editor -->
            <div class="vs-editor-area">
                <div class="vs-code-panel">
                    <div class="vs-tabs">
                        <div class="vs-tab" id="active-tab">
                            <i class="fa-brands fa-html5" style="color: #e65100"></i> index.html 
                        </div>
                    </div>
                    <div class="vs-code-content" id="code-container">
                        <span class="typing-cursor"></span>
                    </div>
                    <div class="typing-hint" id="typing-hint"><i class="fa-regular fa-keyboard"></i> DIGITE QUALQUER TECLA PARA CODAR</div>
                </div>

                <!-- Preview -->
                <div class="vs-preview-panel" id="preview-container">
                    <!-- 3D Canvas Layer -->
                    <div id="scene-container">
                        <canvas id="canvas-preview"></canvas>
                    </div>

                    <!-- UI Overlay Layer -->
                    <main class="interface-layer">
                        <div class="brand-container">
                            <!-- Título com efeito de digitação -->
                            <h1 class="brand-title">
                                <span id="typewriter-text"></span><span class="cursor"></span>
                            </h1>
                            
                            <!-- Subtítulos -->
                            <div class="brand-meta">
                                <p id="sub-brand" class="alura-gemini-text">DA ALURA + GEMINI</p>
                                <p id="sub-proj" class="project-subtitle">PROJETO UBERABA</p>
                            </div>

                            <!-- Botão de Ação -->
                            <button id="cta-btn" class="primary-action">
                                ACESSAR SITE
                            </button>
                        </div>
                    </main>
                </div>
            </div>
        </div>
        <div style="height: 22px; background: #007acc; display: flex; align-items: center; padding: 0 10px; font-size: 12px; color: white; flex-shrink: 0;">
             <span id="status-bar-text">READY</span>
        </div>
    </div>

    <script>
        // ==========================================
        // TIME & UTILS
        // ==========================================
        function updateClock() {
            const now = new Date();
            const timeStr = now.toLocaleTimeString('pt-BR', {hour: '2-digit', minute:'2-digit'});
            const dateStr = now.toLocaleDateString('pt-BR', { weekday: 'long', day: 'numeric', month: 'long' });
            if(document.getElementById('clock-time')) {
                document.getElementById('clock-time').innerText = timeStr;
                document.getElementById('clock-date').innerText = dateStr;
            }
        }
        setInterval(updateClock, 1000);
        updateClock();

        // ==========================================
        // BOOT SEQUENCE
        // ==========================================
        const btnPower = document.getElementById('btn-power');
        
        btnPower.addEventListener('click', () => {
            btnPower.style.color = '#00ff00';
            btnPower.style.boxShadow = '0 0 30px #00ff00';
            document.querySelector('.power-msg').innerText = "INICIANDO SISTEMA...";
            
            setTimeout(() => {
                document.getElementById('scene-power').style.display = 'none';
                runBios();
            }, 1500);
        });

        function runBios() {
            const bios = document.getElementById('scene-bios');
            const text = document.getElementById('bios-text');
            bios.style.display = 'block';

            const lines = [
                "AMIBIOS(C)2025 American Megatrends, Inc.",
                "ASUS PRIME Z790-A ACPI BIOS Revision 1203",
                "CPU: Intel(R) Core(TM) i9-14900K CPU @ 6.00GHz",
                "Checking NVRAM..",
                "Initializing USB Controllers.. Done.",
                "Detecting Memory... <span class='bios-highlight'>64GB OK</span>",
                "Detecting Storage... <span class='bios-highlight'>NVMe M.2 2TB OK</span>",
                "Loading Windows Kernel...",
                "Booting..."
            ];

            let delay = 0;
            lines.forEach((line) => {
                setTimeout(() => {
                    text.innerHTML += `<div class="bios-line">${line}</div>`;
                    window.scrollTo(0, document.body.scrollHeight);
                }, delay);
                delay += 400; 
            });

            setTimeout(() => {
                bios.style.display = 'none';
                showLockScreen();
            }, 5000);
        }

        function showLockScreen() {
            const loginScene = document.getElementById('scene-login');
            const lockContent = document.getElementById('lock-screen-content');
            const loginForm = document.getElementById('login-form');
            
            loginScene.style.display = 'flex';
            
            setTimeout(() => {
                // Move clock out
                gsap.to(lockContent, { y: -200, opacity: 0, duration: 0.8 });
                
                // Show Login Form (Centered)
                loginForm.style.display = 'flex';
                
                // Animate using Scale/Opacity to preserve CSS Transform centering
                gsap.fromTo(loginForm, 
                    { opacity: 0, scale: 0.9 },
                    { opacity: 1, scale: 1, duration: 0.8, ease: "back.out(1.7)" }
                );
                
                const avatarDiv = document.querySelector('.user-avatar');
                const style = getComputedStyle(document.body);
                const bgImg = style.getPropertyValue('--user-avatar');
                if(bgImg && bgImg.includes('url') && bgImg.length > 10) {
                    avatarDiv.innerHTML = ''; 
                }

                setTimeout(() => {
                    const passInput = document.getElementById('pass-input');
                    const pass = "********";
                    let i = 0;
                    const typePass = setInterval(() => {
                        passInput.value += pass[i];
                        i++;
                        if(i >= pass.length) {
                            clearInterval(typePass);
                            setTimeout(() => {
                                const btn = document.querySelector('.login-btn');
                                btn.style.opacity = 1;
                                btn.style.transform = "scale(0.95)";
                                setTimeout(loadDesktop, 1500);
                            }, 500);
                        }
                    }, 300); 
                }, 1500);

            }, 2500);
        }

        function loadDesktop() {
            document.getElementById('scene-login').style.display = 'none';
            document.getElementById('scene-desktop').style.display = 'block';

            setTimeout(() => {
                const notif = document.getElementById('win-notif');
                notif.style.right = '20px';
                setTimeout(() => {
                    notif.style.right = '-400px';
                }, 5000);
            }, 1000);
        }
        
        function wrongIcon(name) {
            const box = document.getElementById('win-error-box');
            const msg = document.getElementById('win-error-msg-text');
            msg.innerText = `O aplicativo '${name}' não pode ser iniciado. O acesso é restrito ao ambiente de desenvolvimento VS Code.`;
            box.style.display = 'flex';
        }

        function closeWinError() {
            document.getElementById('win-error-box').style.display = 'none';
        }

        function openPhotos() {
            const win = document.getElementById('window-photos');
            win.style.display = 'flex';
            gsap.fromTo(win, {scale: 0.9, opacity: 0}, {scale: 1, opacity: 1, duration: 0.2, ease: "power2.out"});
        }

        function closePhotos() {
            const win = document.getElementById('window-photos');
            gsap.to(win, {scale: 0.9, opacity: 0, duration: 0.15, onComplete: () => win.style.display = 'none'});
        }

        function openTrash() {
            const win = document.getElementById('window-trash');
            win.style.display = 'flex';
            gsap.fromTo(win, {scale: 0.9, opacity: 0}, {scale: 1, opacity: 1, duration: 0.2, ease: "power2.out"});
        }

        function closeTrash() {
            const win = document.getElementById('window-trash');
            gsap.to(win, {scale: 0.9, opacity: 0, duration: 0.15, onComplete: () => win.style.display = 'none'});
        }

        document.getElementById('icon-vscode').addEventListener('dblclick', openVSCode);
        document.getElementById('icon-vscode').addEventListener('click', openVSCode);

        function openVSCode() {
            const vs = document.getElementById('scene-vscode');
            vs.style.display = 'flex';

            const isMobile = window.innerWidth < 768;

            gsap.to(vs, { 
                scale: isMobile ? 1 : 1, // Ensure full scale on mobile too
                opacity: 1, 
                duration: 1.5, 
                ease: "expo.out",
                onComplete: () => {
                    state.isCoding = true;
                    initGeminiPreview(); 
                    if (isMobile) {
                        // Auto run code on mobile
                        startMobileAutoTyping();
                    }
                }
            });
        }

        // ==========================================
        // HACKER TYPER LOGIC
        // ==========================================
        const state = { isCoding: false, index: 0, errorStage: false, fixed: false, accessGranted: false, previewVisible: false };
        const container = document.getElementById('code-container');

        // UPDATED CODE SNIPPETS (ESCAPED FOR JS STRINGS)
        const htmlCode = `
<span class="k-tag">&lt;!DOCTYPE html&gt;</span>
<span class="k-tag">&lt;html</span> <span class="k-attr">lang</span>=<span class="k-str">"pt-br"</span><span class="k-tag">&gt;</span>
<span class="k-tag">&lt;head&gt;</span>
    <span class="k-tag">&lt;meta</span> <span class="k-attr">charset</span>=<span class="k-str">"UTF-8"</span><span class="k-tag">&gt;</span>
    <span class="k-tag">&lt;meta</span> <span class="k-attr">name</span>=<span class="k-str">"viewport"</span> <span class="k-attr">content</span>=<span class="k-str">"width=device-width, initial-scale=1.0"</span><span class="k-tag">&gt;</span>
    <span class="k-tag">&lt;title&gt;</span>Uberaba Experience | Immersive Core<span class="k-tag">&lt;/title&gt;</span>
    
    <span class="k-comment">&lt;!-- Fonts --&gt;</span>
    <span class="k-tag">&lt;link</span> <span class="k-attr">rel</span>=<span class="k-str">"preconnect"</span> <span class="k-attr">href</span>=<span class="k-str">"https://fonts.googleapis.com"</span><span class="k-tag">&gt;</span>
    <span class="k-tag">&lt;link</span> <span class="k-attr">rel</span>=<span class="k-str">"preconnect"</span> <span class="k-attr">href</span>=<span class="k-str">"https://fonts.gstatic.com"</span> <span class="k-attr">crossorigin</span><span class="k-tag">&gt;</span>
    <span class="k-tag">&lt;link</span> <span class="k-attr">href</span>=<span class="k-str">"https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;800&display=swap"</span> <span class="k-attr">rel</span>=<span class="k-str">"stylesheet"</span><span class="k-tag">&gt;</span>
    
    <span class="k-comment">&lt;!-- Styles --&gt;</span>
    <span class="k-tag">&lt;link</span> <span class="k-attr">rel</span>=<span class="k-str">"stylesheet"</span> <span class="k-attr">href</span>=<span class="k-str">"style.css"</span><span class="k-tag">&gt;</span>

    <span class="k-comment">&lt;!-- Libraries --&gt;</span>
    <span class="k-tag">&lt;script</span> <span class="k-attr">src</span>=<span class="k-str">"https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"</span><span class="k-tag">&gt;</span><span class="k-tag">&lt;/script&gt;</span>
    <span class="k-tag">&lt;script</span> <span class="k-attr">src</span>=<span class="k-str">"https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"</span><span class="k-tag">&gt;</span><span class="k-tag">&lt;/script&gt;</span>
<span class="k-tag">&lt;/head&gt;</span>
<span class="k-tag">&lt;body&gt;</span>

    <span class="k-comment">&lt;!-- 3D Canvas Layer --&gt;</span>
    <span class="k-tag">&lt;div</span> <span class="k-attr">id</span>=<span class="k-str">"scene-container"</span><span class="k-tag">&gt;</span>
        <span class="k-tag">&lt;canvas</span> <span class="k-attr">id</span>=<span class="k-str">"canvas-preview"</span><span class="k-tag">&gt;</span><span class="k-tag">&lt;/canvas&gt;</span>
    <span class="k-tag">&lt;/div&gt;</span>

    <span class="k-comment">&lt;!-- UI Overlay Layer --&gt;</span>
    <span class="k-tag">&lt;main</span> <span class="k-attr">class</span>=<span class="k-str">"interface-layer"</span><span class="k-tag">&gt;</span>
        <span class="k-tag">&lt;div</span> <span class="k-attr">class</span>=<span class="k-str">"brand-container"</span><span class="k-tag">&gt;</span>
            <span class="k-comment">&lt;!-- Título com efeito de digitação --&gt;</span>
            <span class="k-tag">&lt;h1</span> <span class="k-attr">class</span>=<span class="k-str">"brand-title"</span><span class="k-tag">&gt;</span>
                <span class="k-tag">&lt;span</span> <span class="k-attr">id</span>=<span class="k-str">"typewriter-text"</span><span class="k-tag">&gt;</span><span class="k-tag">&lt;/span&gt;</span><span class="k-tag">&lt;span</span> <span class="k-attr">class</span>=<span class="k-str">"cursor"</span><span class="k-tag">&gt;</span><span class="k-tag">&lt;/span&gt;</span>
            <span class="k-tag">&lt;/h1&gt;</span>
            
            <span class="k-comment">&lt;!-- Subtítulos --&gt;</span>
            <span class="k-tag">&lt;div</span> <span class="k-attr">class</span>=<span class="k-str">"brand-meta"</span><span class="k-tag">&gt;</span>
                <span class="k-tag">&lt;p</span> <span class="k-attr">id</span>=<span class="k-str">"sub-brand"</span> <span class="k-attr">class</span>=<span class="k-str">"alura-gemini-text"</span><span class="k-tag">&gt;</span>DA ALURA + GEMINI<span class="k-tag">&lt;/p&gt;</span>
                <span class="k-tag">&lt;p</span> <span class="k-attr">id</span>=<span class="k-str">"sub-proj"</span> <span class="k-attr">class</span>=<span class="k-str">"project-subtitle"</span><span class="k-tag">&gt;</span>PROJETO UBERABA<span class="k-tag">&lt;/p&gt;</span>
            <span class="k-tag">&lt;/div&gt;</span>

            <span class="k-comment">&lt;!-- Botão de Ação --&gt;</span>
            <span class="k-tag">&lt;button</span> <span class="k-attr">id</span>=<span class="k-str">"cta-btn"</span> <span class="k-attr">class</span>=<span class="k-str">"primary-action"</span><span class="k-tag">&gt;</span>
                ACESSAR SITE
            <span class="k-tag">&lt;/button&gt;</span>
        <span class="k-tag">&lt;/div&gt;</span>
    <span class="k-tag">&lt;/main&gt;</span>

    <span class="k-comment">&lt;!-- Logic --&gt;</span>
    <span class="k-tag">&lt;script</span> <span class="k-attr">src</span>=<span class="k-str">"script.js"</span><span class="k-tag">&gt;</span><span class="k-tag">&lt;/script&gt;</span>
<span class="k-tag">&lt;/body&gt;</span>
<span class="k-tag">&lt;/html&gt;</span>`;

        const cssCode = `
<span class="k-tag">:root</span> {
    <span class="k-var">--bg-space</span>: <span class="k-str">#050505</span>;
    <span class="k-var">--accent-gold</span>: <span class="k-str">#D4AF37</span>;
    <span class="k-var">--text-primary</span>: <span class="k-str">#ffffff</span>;
    <span class="k-var">--gemini-grad-start</span>: <span class="k-str">#4b90ff</span>;
    <span class="k-var">--gemini-grad-end</span>: <span class="k-str">#ff5546</span>;
    <span class="k-var">--font-display</span>: <span class="k-str">'Inter', sans-serif</span>;
}

<span class="k-tag">*</span> {
    <span class="k-attr">margin</span>: <span class="k-str">0</span>;
    <span class="k-attr">padding</span>: <span class="k-str">0</span>;
    <span class="k-attr">box-sizing</span>: <span class="k-str">border-box</span>;
}

<span class="k-tag">body</span> {
    <span class="k-attr">background-color</span>: <span class="k-var">var(--bg-space)</span>;
    <span class="k-attr">color</span>: <span class="k-var">var(--text-primary)</span>;
    <span class="k-attr">font-family</span>: <span class="k-var">var(--font-display)</span>;
    <span class="k-attr">overflow</span>: <span class="k-str">hidden</span>;
    <span class="k-attr">height</span>: <span class="k-str">100vh</span>;
    <span class="k-attr">width</span>: <span class="k-str">100vw</span>;
    <span class="k-attr">display</span>: <span class="k-str">flex</span>;
    <span class="k-attr">justify-content</span>: <span class="k-str">center</span>;
    <span class="k-attr">align-items</span>: <span class="k-str">center</span>;
}

<span class="k-comment">/* --- 3D Scene Container --- */</span>
<span class="k-tag">#scene-container</span> {
    <span class="k-attr">position</span>: <span class="k-str">absolute</span>;
    <span class="k-attr">inset</span>: <span class="k-str">0</span>;
    <span class="k-attr">z-index</span>: <span class="k-str">1</span>;
    <span class="k-attr">background</span>: <span class="k-func">radial-gradient</span>(<span class="k-str">circle at center</span>, <span class="k-str">#111 0%</span>, <span class="k-str">#000 100%</span>);
}

<span class="k-tag">canvas</span> {
    <span class="k-attr">display</span>: <span class="k-str">block</span>;
    <span class="k-attr">width</span>: <span class="k-str">100%</span>;
    <span class="k-attr">height</span>: <span class="k-str">100%</span>;
    <span class="k-attr">outline</span>: <span class="k-str">none</span>;
}

<span class="k-comment">/* --- Interface Overlay --- */</span>
<span class="k-tag">.interface-layer</span> {
    <span class="k-attr">position</span>: <span class="k-str">absolute</span>;
    <span class="k-attr">inset</span>: <span class="k-str">0</span>;
    <span class="k-attr">z-index</span>: <span class="k-str">10</span>;
    <span class="k-attr">display</span>: <span class="k-str">flex</span>;
    <span class="k-attr">flex-direction</span>: <span class="k-str">column</span>;
    <span class="k-attr">justify-content</span>: <span class="k-str">center</span>;
    <span class="k-attr">align-items</span>: <span class="k-str">center</span>;
    <span class="k-attr">pointer-events</span>: <span class="k-str">none</span>;
}

<span class="k-tag">.brand-container</span> {
    <span class="k-attr">text-align</span>: <span class="k-str">center</span>;
    <span class="k-attr">pointer-events</span>: <span class="k-str">auto</span>;
    <span class="k-attr">display</span>: <span class="k-str">flex</span>;
    <span class="k-attr">flex-direction</span>: <span class="k-str">column</span>;
    <span class="k-attr">align-items</span>: <span class="k-str">center</span>;
}

<span class="k-comment">/* --- Typography --- */</span>
<span class="k-tag">.brand-title</span> {
    <span class="k-attr">font-size</span>: <span class="k-str">3.5rem</span>;
    <span class="k-attr">font-weight</span>: <span class="k-str">800</span>;
    <span class="k-attr">color</span>: <span class="k-str">white</span>;
    <span class="k-attr">text-align</span>: <span class="k-str">center</span>;
    <span class="k-attr">text-shadow</span>: <span class="k-str">0 0 30px rgba(255, 255, 255, 0.3)</span>;
    <span class="k-attr">line-height</span>: <span class="k-str">1.1</span>;
    <span class="k-attr">margin-bottom</span>: <span class="k-str">10px</span>;
}

<span class="k-tag">.cursor</span> {
    <span class="k-attr">display</span>: <span class="k-str">inline-block</span>;
    <span class="k-attr">width</span>: <span class="k-str">4px</span>;
    <span class="k-attr">height</span>: <span class="k-str">1em</span>;
    <span class="k-attr">background-color</span>: <span class="k-str">#fff</span>;
    <span class="k-attr">vertical-align</span>: <span class="k-str">bottom</span>;
    <span class="k-attr">animation</span>: <span class="k-str">blink 1s step-end infinite</span>;
    <span class="k-attr">margin-left</span>: <span class="k-str">5px</span>;
}

<span class="k-tag">.brand-meta</span> {
    <span class="k-attr">margin-top</span>: <span class="k-str">15px</span>;
    <span class="k-attr">display</span>: <span class="k-str">flex</span>;
    <span class="k-attr">flex-direction</span>: <span class="k-str">column</span>;
    <span class="k-attr">align-items</span>: <span class="k-str">center</span>;
    <span class="k-attr">gap</span>: <span class="k-str">5px</span>;
}

<span class="k-tag">.alura-gemini-text</span> {
    <span class="k-attr">font-weight</span>: <span class="k-str">700</span>;
    <span class="k-attr">font-size</span>: <span class="k-str">0.9rem</span>;
    <span class="k-attr">letter-spacing</span>: <span class="k-str">2px</span>;
    <span class="k-attr">background</span>: <span class="k-func">linear-gradient</span>(<span class="k-str">to right</span>, <span class="k-str">#ffffff</span>, <span class="k-str">#4b90ff</span>);
    <span class="k-attr">-webkit-background-clip</span>: <span class="k-str">text</span>;
    <span class="k-attr">background-clip</span>: <span class="k-str">text</span>;
    <span class="k-attr">color</span>: <span class="k-str">transparent</span>;
    <span class="k-attr">opacity</span>: <span class="k-str">0</span>;
    <span class="k-attr">transform</span>: <span class="k-func">translateY</span>(<span class="k-str">20px</span>);
}

<span class="k-tag">.project-subtitle</span> {
    <span class="k-attr">font-size</span>: <span class="k-str">1rem</span>;
    <span class="k-attr">letter-spacing</span>: <span class="k-str">4px</span>;
    <span class="k-attr">color</span>: <span class="k-str">#888</span>;
    <span class="k-attr">text-transform</span>: <span class="k-str">uppercase</span>;
    <span class="k-attr">font-weight</span>: <span class="k-str">300</span>;
    <span class="k-attr">opacity</span>: <span class="k-str">0</span>;
    <span class="k-attr">transform</span>: <span class="k-func">translateY</span>(<span class="k-str">20px</span>);
}

<span class="k-comment">/* --- Button --- */</span>
<span class="k-tag">.primary-action</span> {
    <span class="k-attr">margin-top</span>: <span class="k-str">50px</span>;
    <span class="k-attr">padding</span>: <span class="k-str">15px 40px</span>;
    <span class="k-attr">background</span>: <span class="k-str">transparent</span>;
    <span class="k-attr">border</span>: <span class="k-str">1px solid rgba(255, 255, 255, 0.3)</span>;
    <span class="k-attr">color</span>: <span class="k-str">white</span>;
    <span class="k-attr">border-radius</span>: <span class="k-str">50px</span>;
    <span class="k-attr">font-size</span>: <span class="k-str">0.9rem</span>;
    <span class="k-attr">cursor</span>: <span class="k-str">pointer</span>;
    <span class="k-attr">transition</span>: <span class="k-str">all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1)</span>;
    <span class="k-attr">font-weight</span>: <span class="k-str">600</span>;
    <span class="k-attr">letter-spacing</span>: <span class="k-str">2px</span>;
    <span class="k-attr">opacity</span>: <span class="k-str">0</span>;
    <span class="k-attr">transform</span>: <span class="k-func">translateY</span>(<span class="k-str">20px</span>);
    <span class="k-attr">font-family</span>: <span class="k-var">var(--font-display)</span>;
}

<span class="k-tag">.primary-action:hover</span> {
    <span class="k-attr">background</span>: <span class="k-str">white</span>;
    <span class="k-attr">color</span>: <span class="k-str">black</span>;
    <span class="k-attr">box-shadow</span>: <span class="k-str">0 0 30px rgba(255, 255, 255, 0.5)</span>;
    <span class="k-attr">transform</span>: <span class="k-func">translateY</span>(<span class="k-str">20px</span>) <span class="k-func">scale</span>(<span class="k-str">1.05</span>);
}

<span class="k-tag">.primary-action:active</span> {
    <span class="k-attr">transform</span>: <span class="k-func">translateY</span>(<span class="k-str">20px</span>) <span class="k-func">scale</span>(<span class="k-str">0.95</span>);
}

<span class="k-comment">/* --- Animations --- */</span>
<span class="k-tag">@keyframes</span> <span class="k-def">blink</span> {
    <span class="k-str">0%, 100%</span> { <span class="k-attr">opacity</span>: <span class="k-str">1</span>; }
    <span class="k-str">50%</span> { <span class="k-attr">opacity</span>: <span class="k-str">0</span>; }
}

<span class="k-comment">/* Responsividade */</span>
<span class="k-tag">@media</span> (<span class="k-attr">max-width</span>: <span class="k-str">768px</span>) {
    <span class="k-tag">.brand-title</span> { <span class="k-attr">font-size</span>: <span class="k-str">2rem</span>; }
    <span class="k-tag">.alura-gemini-text</span> { <span class="k-attr">font-size</span>: <span class="k-str">0.7rem</span>; }
    <span class="k-tag">.project-subtitle</span> { <span class="k-attr">font-size</span>: <span class="k-str">0.8rem</span>; }
}`;

        const jsCode = `
<span class="k-comment">// ==========================================</span>
<span class="k-comment">// 1. THREE.JS SCENE SETUP</span>
<span class="k-comment">// ==========================================</span>
<span class="k-var">const</span> <span class="k-def">canvas</span> = <span class="k-obj">document</span>.<span class="k-func">getElementById</span>(<span class="k-str">'canvas-preview'</span>);
<span class="k-var">const</span> <span class="k-def">container</span> = <span class="k-obj">document</span>.<span class="k-func">getElementById</span>(<span class="k-str">'scene-container'</span>);

<span class="k-comment">// Cena</span>
<span class="k-var">const</span> <span class="k-def">scene</span> = <span class="k-import">new</span> <span class="k-obj">THREE</span>.<span class="k-obj">Scene</span>();

<span class="k-comment">// Câmera</span>
<span class="k-var">const</span> <span class="k-def">camera</span> = <span class="k-import">new</span> <span class="k-obj">THREE</span>.<span class="k-obj">PerspectiveCamera</span>(<span class="k-str">75</span>, <span class="k-obj">window</span>.<span class="k-obj">innerWidth</span> / <span class="k-obj">window</span>.<span class="k-obj">innerHeight</span>, <span class="k-str">0.1</span>, <span class="k-str">1000</span>);
<span class="k-def">camera</span>.<span class="k-obj">position</span>.<span class="k-obj">z</span> = <span class="k-str">3</span>;

<span class="k-comment">// Renderizador</span>
<span class="k-var">const</span> <span class="k-def">renderer</span> = <span class="k-import">new</span> <span class="k-obj">THREE</span>.<span class="k-obj">WebGLRenderer</span>({ 
    <span class="k-attr">canvas</span>: <span class="k-def">canvas</span>, 
    <span class="k-attr">alpha</span>: <span class="k-var">true</span>, 
    <span class="k-attr">antialias</span>: <span class="k-var">true</span> 
});
<span class="k-def">renderer</span>.<span class="k-func">setSize</span>(<span class="k-obj">window</span>.<span class="k-obj">innerWidth</span>, <span class="k-obj">window</span>.<span class="k-obj">innerHeight</span>);
<span class="k-def">renderer</span>.<span class="k-func">setPixelRatio</span>(<span class="k-obj">Math</span>.<span class="k-func">min</span>(<span class="k-obj">window</span>.<span class="k-obj">devicePixelRatio</span>, <span class="k-str">2</span>));

<span class="k-comment">// ==========================================</span>
<span class="k-comment">// 2. PARTICLE SYSTEM</span>
<span class="k-comment">// ==========================================</span>
<span class="k-var">const</span> <span class="k-def">geometry</span> = <span class="k-import">new</span> <span class="k-obj">THREE</span>.<span class="k-obj">BufferGeometry</span>();
<span class="k-var">const</span> <span class="k-def">particlesCount</span> = <span class="k-str">3000</span>;
<span class="k-var">const</span> <span class="k-def">posArray</span> = <span class="k-import">new</span> <span class="k-obj">Float32Array</span>(<span class="k-def">particlesCount</span> * <span class="k-str">3</span>);

<span class="k-comment">// Distribuição aleatória de partículas</span>
<span class="k-import">for</span>(<span class="k-var">let</span> <span class="k-def">i</span> = <span class="k-str">0</span>; <span class="k-def">i</span> < <span class="k-def">particlesCount</span> * <span class="k-str">3</span>; <span class="k-def">i</span>++) {
    <span class="k-def">posArray</span>[<span class="k-def">i</span>] = (<span class="k-obj">Math</span>.<span class="k-func">random</span>() - <span class="k-str">0.5</span>) * <span class="k-str">15</span>; 
}

<span class="k-def">geometry</span>.<span class="k-func">setAttribute</span>(<span class="k-str">'position'</span>, <span class="k-import">new</span> <span class="k-obj">THREE</span>.<span class="k-obj">BufferAttribute</span>(<span class="k-def">posArray</span>, <span class="k-str">3</span>));

<span class="k-comment">// Material das partículas</span>
<span class="k-var">const</span> <span class="k-def">material</span> = <span class="k-import">new</span> <span class="k-obj">THREE</span>.<span class="k-obj">PointsMaterial</span>({
    <span class="k-attr">size</span>: <span class="k-str">0.02</span>,
    <span class="k-attr">color</span>: <span class="k-str">0x0078d7</span>, <span class="k-comment">// Azul Azure</span>
    <span class="k-attr">transparent</span>: <span class="k-var">true</span>,
    <span class="k-attr">opacity</span>: <span class="k-str">0.8</span>,
    <span class="k-attr">blending</span>: <span class="k-obj">THREE</span>.<span class="k-obj">AdditiveBlending</span>,
    <span class="k-attr">sizeAttenuation</span>: <span class="k-var">true</span>
});

<span class="k-comment">// Mesh</span>
<span class="k-var">const</span> <span class="k-def">particlesMesh</span> = <span class="k-import">new</span> <span class="k-obj">THREE</span>.<span class="k-obj">Points</span>(<span class="k-def">geometry</span>, <span class="k-def">material</span>);
<span class="k-def">scene</span>.<span class="k-func">add</span>(<span class="k-def">particlesMesh</span>);

<span class="k-comment">// ==========================================</span>
<span class="k-comment">// 3. INTERACTION & ANIMATION</span>
<span class="k-comment">// ==========================================</span>

<span class="k-comment">// Mouse Interaction (Parallax Suave)</span>
<span class="k-var">let</span> <span class="k-def">mouseX</span> = <span class="k-str">0</span>;
<span class="k-var">let</span> <span class="k-def">mouseY</span> = <span class="k-str">0</span>;
<span class="k-var">let</span> <span class="k-def">targetX</span> = <span class="k-str">0</span>;
<span class="k-var">let</span> <span class="k-def">targetY</span> = <span class="k-str">0</span>;

<span class="k-var">const</span> <span class="k-def">windowHalfX</span> = <span class="k-obj">window</span>.<span class="k-obj">innerWidth</span> / <span class="k-str">2</span>;
<span class="k-var">const</span> <span class="k-def">windowHalfY</span> = <span class="k-obj">window</span>.<span class="k-obj">innerHeight</span> / <span class="k-str">2</span>;

<span class="k-obj">document</span>.<span class="k-func">addEventListener</span>(<span class="k-str">'mousemove'</span>, (<span class="k-def">event</span>) => {
    <span class="k-def">mouseX</span> = (<span class="k-def">event</span>.<span class="k-def">clientX</span> - <span class="k-def">windowHalfX</span>);
    <span class="k-def">mouseY</span> = (<span class="k-def">event</span>.<span class="k-def">clientY</span> - <span class="k-def">windowHalfY</span>);
});

<span class="k-var">const</span> <span class="k-def">clock</span> = <span class="k-import">new</span> <span class="k-obj">THREE</span>.<span class="k-obj">Clock</span>();

<span class="k-func">function</span> <span class="k-func">animate</span>() {
    <span class="k-var">const</span> <span class="k-def">elapsedTime</span> = <span class="k-def">clock</span>.<span class="k-func">getElapsedTime</span>();

    <span class="k-comment">// Rotação automática constante</span>
    <span class="k-def">particlesMesh</span>.<span class="k-obj">rotation</span>.<span class="k-obj">y</span> = <span class="k-def">elapsedTime</span> * <span class="k-str">0.05</span>;
    <span class="k-def">particlesMesh</span>.<span class="k-obj">rotation</span>.<span class="k-obj">x</span> = <span class="k-def">elapsedTime</span> * <span class="k-str">0.02</span>;

    <span class="k-comment">// Efeito Parallax com Mouse (Suavizado)</span>
    <span class="k-def">targetX</span> = <span class="k-def">mouseX</span> * <span class="k-str">0.001</span>;
    <span class="k-def">targetY</span> = <span class="k-def">mouseY</span> * <span class="k-str">0.001</span>;

    <span class="k-def">particlesMesh</span>.<span class="k-obj">rotation</span>.<span class="k-obj">y</span> += <span class="k-str">0.05</span> * (<span class="k-def">targetX</span> - <span class="k-def">particlesMesh</span>.<span class="k-obj">rotation</span>.<span class="k-obj">y</span>);
    <span class="k-def">particlesMesh</span>.<span class="k-obj">rotation</span>.<span class="k-obj">x</span> += <span class="k-str">0.05</span> * (<span class="k-def">targetY</span> - <span class="k-def">particlesMesh</span>.<span class="k-obj">rotation</span>.<span class="k-obj">x</span>);

    <span class="k-def">renderer</span>.<span class="k-func">render</span>(<span class="k-def">scene</span>, <span class="k-def">camera</span>);
    <span class="k-func">requestAnimationFrame</span>(<span class="k-func">animate</span>);
}

<span class="k-func">animate</span>();`;

        const fileSequence = [
            { id: 'html', type: 'html', code: htmlCode, name: 'index.html', icon: 'fa-html5', color: '#e65100' },
            { id: 'css', type: 'css', code: cssCode, name: 'styles.css', icon: 'fa-css3', color: '#42a5f5' },
            { id: 'js', type: 'js', code: jsCode, name: 'main.js', icon: 'fa-js', color: '#fdd835' }
        ];

        let currentFileIndex = 0;
        let currentCodeChunks = [];

        function updateUIForFile(fileData) {
            document.querySelectorAll('.vs-file').forEach(el => el.classList.remove('active'));
            document.getElementById(`file-${fileData.id}`).classList.add('active');

            const tab = document.getElementById('active-tab');
            tab.innerHTML = `<i class="fa-brands ${fileData.icon}" style="color: ${fileData.color}"></i> ${fileData.name}`;
            
            document.getElementById('vs-window-title').innerText = `${fileData.name} - Visual Studio Code`;

            container.innerHTML = '<span class="typing-cursor"></span>';
            state.index = 0;
            currentCodeChunks = fileData.code.split(/(?=<span)|(?<=<\/span>)/g);
        }

        updateUIForFile(fileSequence[0]);

        // Function to type the next chunk (reusable)
        function typeNextChunk() {
            if (!state.previewVisible) {
                state.previewVisible = true;
                const prevPanel = document.getElementById('preview-container');
                prevPanel.style.opacity = 1;
            }

            if (state.index >= currentCodeChunks.length) {
                if (currentFileIndex < fileSequence.length - 1) {
                    currentFileIndex++;
                    updateUIForFile(fileSequence[currentFileIndex]);
                } else {
                    checkCodeProgress(container.innerText);
                }
                return;
            }

            const chunk = currentCodeChunks[state.index];
            const cursor = document.querySelector('.typing-cursor');
            if(cursor) {
                cursor.insertAdjacentHTML('beforebegin', chunk);
                state.index++;
                // Important: Only scroll the internal container, never the window
                if(container) container.scrollTop = container.scrollHeight;
            }

            if (fileSequence[currentFileIndex].id === 'js') {
                checkCodeProgress(container.innerText);
            }
        }

        document.addEventListener('keydown', (e) => {
            if(!state.isCoding || state.errorStage) return;
            typeNextChunk();
        });

        let typeWriterStarted = false;
        function checkCodeProgress(text) {
            if(text.includes('const scene') && !typeWriterStarted) {
                typeWriterStarted = true;
                typeWriter("IMERSÃO DEV", document.getElementById('typewriter-text'));
            }

            if(text.includes('particlesMesh = new THREE.Points')) {
                gsap.to('#sub-brand', { opacity: 1, y: 0, duration: 0.8, ease: "power2.out" });
                gsap.to('#sub-proj', { opacity: 1, y: 0, duration: 0.8, ease: "power2.out", delay: 0.2 });
            }

            if(text.includes('animate();')) {
                // Only trigger error on Desktop
                if(window.innerWidth >= 768) {
                    // Wait a bit then trigger error logic (managed by user input usually, but let's leave logic for CTA)
                } else {
                    // Mobile: Ensure state is set to access granted immediately
                    state.accessGranted = true;
                }
                
                gsap.to('#cta-btn', { opacity: 1, y: 0, duration: 0.8, ease: "back.out(1.7)" });
                
                const hint = document.getElementById('typing-hint');
                if(window.innerWidth < 768) {
                    hint.innerText = "CÓDIGO AUTOMATIZADO. ACESSO LIBERADO.";
                } else {
                    hint.innerHTML = "CÓDIGO FINALIZADO. CLIQUE EM 'ACESSAR SITE'.";
                }
                
                document.getElementById('status-bar-text').innerText = "COMPILATION SUCCESS";
            }
        }

        function typeWriter(text, element) {
            let i = 0;
            const interval = setInterval(() => {
                element.innerHTML += text.charAt(i);
                i++;
                if(i >= text.length) clearInterval(interval);
            }, 100);
        }

        // ==========================================
        // MOBILE AUTO TYPING
        // ==========================================
        function startMobileAutoTyping() {
            // Slower typing speed for mobile to be readable
            const typingSpeed = 40; 
            
            const autoTyper = setInterval(() => {
                // Stop if we are done with all files
                if (currentFileIndex === fileSequence.length - 1 && state.index >= currentCodeChunks.length) {
                    clearInterval(autoTyper);
                    return;
                }
                typeNextChunk();
            }, typingSpeed);
        }

        // ==========================================
        // ERROR & GEMINI FIX SEQUENCE
        // ==========================================
        const prevBtn = document.getElementById('cta-btn'); 
        const modal = document.getElementById('error-modal');
        const closeModal = document.getElementById('btn-close-modal');
        const ackModal = document.getElementById('btn-ack-error');
        const geminiTool = document.getElementById('gemini-tool');
        const successModal = document.getElementById('gemini-success-modal');
        const closeSuccess = document.getElementById('btn-close-success');

        function triggerError() {
            state.errorStage = true;
            
            if (currentFileIndex !== 2) {
                currentFileIndex = 2;
                updateUIForFile(fileSequence[2]);
                const cursor = document.querySelector('.typing-cursor');
                currentCodeChunks.forEach(c => cursor.insertAdjacentHTML('beforebegin', c));
            }

            document.getElementById('scene-vscode').classList.add('glitch-error');
            document.getElementById('code-container').style.color = 'red';
            document.getElementById('status-bar-text').innerText = "CRITICAL ERROR DETECTED";
            document.getElementById('status-bar-text').style.background = "red";
            
            modal.style.display = 'flex';
            gsap.to(modal, { opacity: 1, scale: 1, duration: 0.3, ease: "back.out" });
        }

        function hideErrorModal() {
            gsap.to(modal, { opacity: 0, scale: 0.8, duration: 0.2, onComplete: () => {
                modal.style.display = 'none';
                geminiTool.classList.add('pulse');
                document.getElementById('typing-hint').innerText = "CLIQUE NO BOTÃO GEMINI (BARRA LATERAL) PARA CORRIGIR.";
            }});
        }
        closeModal.addEventListener('click', hideErrorModal);
        ackModal.addEventListener('click', hideErrorModal);

        geminiTool.addEventListener('click', () => {
            if(!state.errorStage || state.fixed) return;
            
            geminiTool.classList.remove('pulse');
            currentFileIndex = 2; 
            updateUIForFile(fileSequence[2]); 

            const container = document.getElementById('code-container');
            container.style.color = '#d4d4d4'; 
            document.getElementById('scene-vscode').classList.remove('glitch-error');
            document.getElementById('status-bar-text').innerText = "GEMINI AI REWRITING...";
            document.getElementById('status-bar-text').style.background = "#8e24aa"; 

            triggerGeminiRewrite();
        });

        function triggerGeminiRewrite() {
            const chunks = jsCode.split(/(?=<span)|(?<=<\/span>)/g);
            let i = 0;

            const slowType = setInterval(() => {
                if(i >= chunks.length) {
                    clearInterval(slowType);
                    state.fixed = true;
                    state.errorStage = false;
                    showSuccessModal();
                    return;
                }
                
                const cursor = document.querySelector('.typing-cursor');
                let chunk = chunks[i];
                if(chunk.includes('k-')) chunk = chunk.replace('class="', 'class="gemini-glow ');
                
                cursor.insertAdjacentHTML('beforebegin', chunk);
                if(container) container.scrollTop = container.scrollHeight;
                i++;
            }, 20); 
        }

        function showSuccessModal() {
            successModal.style.display = 'flex';
            gsap.to(successModal, { opacity: 1, scale: 1, duration: 0.5, ease: "back.out" });
        }

        closeSuccess.addEventListener('click', () => {
            gsap.to(successModal, { opacity: 0, scale: 0.9, duration: 0.3, onComplete: () => {
                successModal.style.display = 'none';
                
                state.accessGranted = true;
                document.getElementById('typing-hint').innerText = "CORREÇÃO COMPLETA. ACESSO LIBERADO.";
                document.getElementById('status-bar-text').innerText = "READY";
                document.getElementById('status-bar-text').style.background = "#007acc";
                
                // Reset button style in preview
                const btn = document.getElementById('cta-btn');
                if(btn) {
                    btn.style.border = "1px solid #00ff00";
                    btn.style.color = "#00ff00";
                }
            }});
        });

        // ==========================================
        // THREE.JS STARFIELD (PREVIEW LOGIC)
        // ==========================================
        let particlesMesh, camera, material; 

        function initGeminiPreview() {
            const canvas = document.getElementById('canvas-preview');
            const container = document.getElementById('preview-container'); // Use preview container for sizing

            const scene = new THREE.Scene();
            
            // Correct Sizing based on container
            const width = container.clientWidth;
            const height = container.clientHeight;

            camera = new THREE.PerspectiveCamera(75, width / height, 0.1, 1000);
            camera.position.z = 3;

            const renderer = new THREE.WebGLRenderer({ canvas: canvas, alpha: true, antialias: true });
            renderer.setSize(width, height);
            renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));

            const geometry = new THREE.BufferGeometry();
            const count = 3000;
            const posArray = new Float32Array(count * 3);

            for(let i=0; i<count*3; i++) {
                posArray[i] = (Math.random() - 0.5) * 15; 
            }

            geometry.setAttribute('position', new THREE.BufferAttribute(posArray, 3));
            
            material = new THREE.PointsMaterial({ 
                size: 0.02, 
                color: 0x0078d7, 
                transparent: true, 
                opacity: 0.8,
                blending: THREE.AdditiveBlending,
                sizeAttenuation: true
            });
            
            particlesMesh = new THREE.Points(geometry, material);
            scene.add(particlesMesh);

            // Mouse Interaction Logic
            let mouseX = 0;
            let mouseY = 0;
            const windowHalfX = width / 2;
            const windowHalfY = height / 2;

            container.addEventListener('mousemove', (event) => {
                const rect = container.getBoundingClientRect();
                mouseX = (event.clientX - rect.left) - windowHalfX;
                mouseY = (event.clientY - rect.top) - windowHalfY;
            });

            // Handle Resize Logic for vertical layout on mobile
            window.addEventListener('resize', () => {
                const newWidth = container.clientWidth;
                const newHeight = container.clientHeight;
                renderer.setSize(newWidth, newHeight);
                camera.aspect = newWidth / newHeight;
                camera.updateProjectionMatrix();
            });

            const clock = new THREE.Clock();

            const animate = () => {
                requestAnimationFrame(animate);
                
                const elapsedTime = clock.getElapsedTime();

                particlesMesh.rotation.y = elapsedTime * 0.05;
                particlesMesh.rotation.x = elapsedTime * 0.02;

                const targetX = mouseX * 0.001;
                const targetY = mouseY * 0.001;

                particlesMesh.rotation.y += 0.05 * (targetX - particlesMesh.rotation.y);
                particlesMesh.rotation.x += 0.05 * (targetY - particlesMesh.rotation.x);
                
                // Error state visual feedback
                if(state.errorStage && !state.fixed) {
                    material.color.setHex(0xff0000);
                    particlesMesh.rotation.z += 0.05;
                } else if(state.fixed) {
                    material.color.setHex(0x00ff00);
                } else {
                    material.color.setHex(0x0078d7);
                }

                renderer.render(scene, camera);
            };
            animate();

            // Button Interaction inside Preview
            const ctaBtn = document.getElementById('cta-btn');
            if(ctaBtn) {
                ctaBtn.addEventListener('click', (e) => {
                    // Mobile check: always allow access on mobile
                    const isMobile = window.innerWidth < 768;
                    
                    if(!state.accessGranted && !isMobile) {
                        triggerError();
                        return;
                    }

                    const btn = e.target;
                    btn.innerHTML = "CARREGANDO...";
                    material.color.setHex(0x00ff00);
                    
                    gsap.to(particlesMesh.rotation, {
                        z: 5, duration: 2, ease: "expo.in"
                    });

                    gsap.to(camera.position, {
                        z: 0.5, duration: 2, ease: "expo.in",
                        onComplete: () => {
                            window.location.href = "main.html"; 
                        }
                    });
                });
            }
        }

    </script>
</body>
</html>