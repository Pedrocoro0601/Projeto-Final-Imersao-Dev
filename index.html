<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Uberaba - MG </title>
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Fira+Code:wght@300;400;500;600&family=Inter:wght@300;400;600;700;800&family=Segoe+UI:wght@300;400;600;700&family=Special+Elite&display=swap" rel="stylesheet">
    
    <!-- Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <!-- Libraries -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>

    <style>
        :root {
            /* --- WALLPAPER CONFIGURATION --- */
            --wallpaper-lock: url('Telabloqueio.jpg');
            --wallpaper-desk: url('Windows10.png');
            
            /* --- USER AVATAR --- */
            --user-avatar: url('Pedro.jpg'); 

            /* --- COLORS --- */
            --bg-black: #000000;
            --win-bg: #f3f3f3;
            --win-blue: #0078d7;
            --vscode-bg: #1e1e1e;
            --vscode-sidebar: #252526;
            --vscode-statusbar: #007acc;
            
            /* --- PREVIEW VARIABLES --- */
            --preview-bg: #050505;
            --preview-gold: #D4AF37;
            --gemini-grad-start: #4b90ff;
            --gemini-grad-end: #ff5546;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; cursor: default; }

        /* FIX: Lock body to viewport to prevent page scrolling on mobile */
        body {
            background: var(--bg-black);
            color: white;
            font-family: 'Segoe UI', sans-serif;
            overflow: hidden;
            width: 100vw;
            height: 100dvh; /* Use dynamic viewport height */
            position: fixed; /* Force fixed to prevent scroll bounce */
            inset: 0;
            user-select: none;
            -webkit-user-select: none;
        }

        /* =========================================
           SCENE 1: POWER BUTTON
           ========================================= */
        #scene-power {
            position: absolute; inset: 0;
            background: #050505;
            display: flex; flex-direction: column;
            justify-content: center; align-items: center;
            z-index: 100;
            padding: 20px;
            text-align: center;
        }

        .power-btn {
            width: 80px; height: 80px;
            border-radius: 50%;
            border: 2px solid #333;
            background: radial-gradient(circle, #222, #111);
            color: #555;
            font-size: 2rem;
            display: flex; justify-content: center; align-items: center;
            cursor: pointer;
            transition: all 0.3s;
        }

        .power-btn:hover {
            color: #fff;
            border-color: #fff;
            box-shadow: 0 0 20px rgba(255, 255, 255, 0.2);
        }

        .power-msg {
            margin-top: 30px;
            font-family: 'Fira Code', monospace;
            color: #666;
            font-size: 0.9rem;
            letter-spacing: 1px;
            opacity: 0;
            animation: fadeIn 2s forwards;
        }

        .mobile-disclaimer {
            margin-top: 20px;
            font-family: 'Segoe UI', sans-serif;
            color: #444;
            font-size: 0.8rem;
            max-width: 300px;
            line-height: 1.4;
            display: none; /* Hidden on Desktop */
            opacity: 0;
            animation: fadeIn 2s 1s forwards;
        }

        @keyframes fadeIn { to { opacity: 1; } }

        /* =========================================
           SCENE 2: BIOS / BOOT
           ========================================= */
        #scene-bios {
            position: absolute; inset: 0;
            background: black;
            padding: 40px;
            font-family: 'Fira Code', monospace;
            font-size: 14px;
            color: #ccc;
            display: none;
            z-index: 90;
            overflow-y: auto; /* Allow internal scroll if bios text is long */
        }
        .bios-line { margin-bottom: 5px; }
        .bios-highlight { color: yellow; }

        /* =========================================
           SCENE 3: WINDOWS LOCK & LOGIN
           ========================================= */
        #scene-login {
            position: absolute; inset: 0;
            background: var(--wallpaper-lock) no-repeat center center/cover;
            display: none;
            flex-direction: column;
            align-items: center;
            z-index: 80;
            transition: backdrop-filter 0.5s;
        }

        #lock-screen-content {
            margin-top: 15vh;
            text-align: center;
            text-shadow: 0 2px 10px rgba(0,0,0,0.5);
        }
        .lock-time { font-size: 6rem; font-weight: 300; }
        .lock-date { font-size: 2rem; font-weight: 400; }

        #login-form {
            display: none;
            flex-direction: column;
            align-items: center;
            
            /* CENTERING FIX */
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 90%; /* Mobile friendly */
            max-width: 400px; /* Desktop limit */
            
            background: rgba(0,0,0,0.4);
            padding: 40px;
            border-radius: 10px;
            backdrop-filter: blur(15px);
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            z-index: 85;
        }
        .user-avatar {
            width: 100px; height: 100px;
            background-color: #333;
            background-image: var(--user-avatar);
            background-size: cover;
            background-position: center;
            border-radius: 50%;
            margin-bottom: 15px;
            display: flex; justify-content: center; align-items: center;
            font-size: 2rem; color: white;
            border: 2px solid rgba(255,255,255,0.2);
        }
        .user-name { font-size: 1.5rem; margin-bottom: 20px; font-weight: 600; text-align: center; }
        .pass-input {
            background: rgba(255,255,255,0.9);
            border: 2px solid transparent;
            padding: 10px 15px;
            width: 100%;
            border-radius: 4px;
            font-size: 1rem;
            margin-bottom: 15px;
            pointer-events: none; /* Auto typed */
        }
        .login-btn {
            background: var(--win-blue);
            color: white; border: none;
            padding: 10px 30px;
            border-radius: 4px;
            font-weight: 600;
            opacity: 0.5;
            cursor: pointer;
        }

        /* =========================================
           SCENE 4: DESKTOP
           ========================================= */
        #scene-desktop {
            position: absolute; inset: 0;
            background: var(--wallpaper-desk) no-repeat center center/cover;
            display: none;
            z-index: 70;
            overflow: hidden; /* Prevent scrollbars from falling icons */
        }

        .desktop-grid {
            padding: 20px;
            display: flex;
            flex-direction: column;
            flex-wrap: wrap;
            height: 90%;
            align-content: flex-start;
            gap: 15px;
        }

        .desktop-icon {
            width: 100px; margin: 5px;
            display: flex; flex-direction: column; align-items: center;
            text-align: center; color: white;
            text-shadow: 0 1px 3px black; cursor: pointer;
            padding: 10px; border: 1px solid transparent; border-radius: 4px;
            transition: background 0.2s;
            position: relative; /* For gravity logic */
        }
        .desktop-icon:hover { background: rgba(255,255,255,0.1); border-color: rgba(255,255,255,0.2); }
        .icon-img { font-size: 2.2rem; margin-bottom: 8px; filter: drop-shadow(0 4px 4px rgba(0,0,0,0.5)); }
        
        /* GTA CUSTOM IMAGE ICON */
        .custom-icon-img {
            width: 40px; height: 40px; object-fit: contain; margin-bottom: 8px;
            filter: drop-shadow(0 4px 4px rgba(0,0,0,0.5));
        }

        .icon-label { font-size: 0.8rem; line-height: 1.2; }
        
        /* --- WINDOWS (GENERIC & PRANK) --- */
        .os-window {
            position: absolute; top: 10%; left: 15%; width: 70%; height: 70%;
            background: #f0f0f0; color: #000;
            border: 1px solid #666;
            box-shadow: 0 15px 50px rgba(0,0,0,0.5);
            display: none; flex-direction: column;
            z-index: 150; font-family: 'Segoe UI', sans-serif;
            border-radius: 6px; overflow: hidden;
        }
        .os-header { background: #fff; padding: 0; border-bottom: 1px solid #ddd; display: flex; flex-direction: column; }
        .os-titlebar { display: flex; justify-content: space-between; align-items: center; padding: 8px 12px; }
        .os-title { font-size: 12px; display: flex; align-items: center; gap: 10px; color: #333; }
        .os-controls { display: flex; gap: 5px; }
        .os-btn { width: 40px; height: 30px; display: flex; justify-content: center; align-items: center; font-size: 14px; cursor: pointer; transition: 0.2s; border: none; background: transparent; }
        .os-btn:hover { background: #e5e5e5; }
        .os-btn.close:hover { background: #e81123; color: white; }
        
        .os-toolbar { padding: 8px 12px; background: #f9f9f9; border-bottom: 1px solid #ddd; display: flex; gap: 15px; font-size: 13px; color: #555; align-items: center; }
        .os-address-bar { padding: 4px 10px; border: 1px solid #ccc; background: white; width: 100%; margin: 5px 10px; font-size: 12px; color: #555; display: flex; align-items: center; gap: 5px;}
        .os-toolbar span { cursor: pointer; }
        .os-toolbar span:hover { color: #000; }

        .os-body { flex: 1; padding: 20px; overflow-y: auto; background: #fff; position: relative; }
        
        .photo-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(100px, 1fr)); gap: 20px; }
        .photo-item {
            display: flex; flex-direction: column; align-items: center;
            padding: 10px; cursor: pointer; border: 1px solid transparent;
            border-radius: 4px;
        }
        .photo-item:hover { background: #e5f3ff; border-color: #cce8ff; }
        .photo-frame {
            width: 100%; height: 80px;
            margin-bottom: 8px; display: flex; justify-content: center; align-items: center;
            overflow: hidden; 
        }
        .photo-frame img { width: 100%; height: 100%; object-fit: cover; transition: 0.3s; }
        .photo-frame i { font-size: 3rem; } /* For Folder Icons */
        .photo-item:hover img { transform: scale(1.05); }
        .photo-name { font-size: 12px; text-align: center; color: #333; word-break: break-word;}


        /* Windows Generic Error Dialog (Fake) */
        #win-error-box {
            position: absolute; top: 50%; left: 50%;
            transform: translate(-50%, -50%);
            width: 380px;
            background: #fff;
            color: #000;
            border: 1px solid #aaa;
            box-shadow: 5px 5px 15px rgba(0,0,0,0.3);
            display: none;
            flex-direction: column;
            z-index: 6000; /* High Z-Index for Prank */
            font-family: 'Segoe UI', sans-serif;
        }
        .win-err-header {
            background: white; padding: 8px 10px;
            display: flex; justify-content: space-between; align-items: center;
            font-size: 12px;
        }
        .win-err-title { font-weight: 500; }
        .win-err-close { 
            cursor: pointer; font-size: 16px; line-height: 1; color: #555; 
            width: 24px; height: 24px; display: flex; justify-content: center; align-items: center;
        }
        .win-err-close:hover { background: #e81123; color: white; }
        
        .win-err-body {
            padding: 20px; background: #f0f0f0; display: flex; gap: 15px; align-items: center;
        }
        .win-err-icon {
            font-size: 32px; color: #d92027;
        }
        .win-err-msg { font-size: 13px; color: #333; flex: 1; }
        
        .win-err-footer {
            background: #f0f0f0; padding: 15px; padding-top: 0;
            display: flex; justify-content: flex-end;
        }
        .win-err-btn {
            padding: 4px 25px; background: #e1e1e1; border: 1px solid #adadad;
            font-size: 12px; cursor: pointer; min-width: 80px;
        }
        .win-err-btn:hover { background: #e5f1fb; border-color: #0078d7; }
        .win-err-btn:focus { border-color: #0078d7; box-shadow: 0 0 0 1px #0078d7 inset; }


        /* Windows Notification */
        .win-notification {
            position: fixed; bottom: 20px; right: -400px;
            width: 350px; background: #1f1f1f;
            border: 1px solid #333; border-radius: 8px;
            padding: 15px; display: flex; gap: 15px;
            z-index: 2000; box-shadow: 0 10px 30px rgba(0,0,0,0.5);
            font-family: 'Segoe UI'; transition: right 0.5s ease;
        }
        .notif-icon { font-size: 24px; color: var(--win-blue); }
        .notif-content h4 { font-size: 14px; margin-bottom: 5px; color: white; }
        .notif-content p { font-size: 12px; color: #ccc; }

        /* Programmer Alert Modal (New) */
        #programmer-alert-modal {
            position: absolute; top: 50%; left: 50%;
            transform: translate(-50%, -50%) scale(0.9);
            width: 400px;
            background: rgba(30, 30, 30, 0.95);
            border: 1px solid #00ff9d; /* Cyber Green */
            border-radius: 12px;
            padding: 0;
            display: none; opacity: 0;
            flex-direction: column;
            z-index: 3000;
            box-shadow: 0 20px 60px rgba(0,255,157,0.15);
            backdrop-filter: blur(10px);
        }
        
        #programmer-alert-modal .modal-header {
            background: rgba(0, 255, 157, 0.1);
            border-bottom: 1px solid rgba(0, 255, 157, 0.3);
        }
        
        #programmer-alert-modal .modal-title {
            color: #00ff9d;
        }

        #programmer-alert-modal .modal-btn {
            background: transparent;
            border: 1px solid #00ff9d;
            color: #00ff9d;
            transition: all 0.3s;
        }
        
        #programmer-alert-modal .modal-btn:hover {
            background: #00ff9d;
            color: #000;
            box-shadow: 0 0 15px #00ff9d;
        }

        /* --- DOCUMENT MODAL (OFFICIAL TERM) --- */
        #prank-term-modal {
            position: fixed; inset: 0;
            background: rgba(0,0,0,0.85);
            z-index: 5000;
            display: none; align-items: center; justify-content: center;
            backdrop-filter: blur(5px);
        }
        
        .document-paper {
            background: #f4f1ea;
            color: #333;
            width: 90%; max-width: 550px;
            padding: 40px;
            box-shadow: 0 0 50px rgba(0,0,0,0.8), inset 0 0 60px rgba(0,0,0,0.1);
            font-family: 'Special Elite', 'Courier New', monospace;
            position: relative;
            transform: rotate(-1deg);
            border: 1px solid #d3d3d3;
        }
        
        .document-paper::before {
            content: 'CONFIDENTIAL';
            position: absolute;
            top: 50%; left: 50%;
            transform: translate(-50%, -50%) rotate(-45deg);
            font-size: 4rem;
            color: rgba(255, 0, 0, 0.1);
            border: 5px solid rgba(255, 0, 0, 0.1);
            padding: 10px 40px;
            pointer-events: none;
            font-weight: bold;
        }

        .doc-seal {
            text-align: center;
            margin-bottom: 20px;
        }
        .doc-seal i { font-size: 40px; color: #444; }
        
        .doc-title {
            text-align: center; font-size: 1.5rem; 
            font-weight: bold; text-decoration: underline;
            margin-bottom: 20px; letter-spacing: 1px;
        }
        
        .doc-text {
            font-size: 0.9rem; line-height: 1.6; text-align: justify;
            margin-bottom: 20px;
        }
        
        .doc-input-group {
            margin-top: 30px;
            border-top: 2px solid #333;
            padding-top: 20px;
        }
        
        .doc-input {
            width: 100%; padding: 10px;
            background: transparent; border: none; border-bottom: 2px dashed #333;
            font-family: 'Special Elite', monospace; font-size: 1.2rem;
            color: #000; outline: none;
            text-align: center; text-transform: uppercase;
        }
        
        .doc-label {
            display: block; text-align: center; font-size: 0.8rem; margin-top: 5px; color: #666;
        }
        
        .doc-actions {
            display: flex; justify-content: space-between; margin-top: 30px; gap: 15px;
        }
        
        .doc-btn {
            flex: 1; padding: 12px;
            border: 2px solid #333; background: transparent;
            font-family: 'Special Elite', monospace; font-weight: bold;
            cursor: pointer; transition: 0.3s;
            text-transform: uppercase;
        }
        
        .doc-btn.accept {
            background: #333; color: #f4f1ea; opacity: 0.5; pointer-events: none;
        }
        .doc-btn.accept.active { opacity: 1; pointer-events: auto; }
        .doc-btn.accept:hover { background: #000; }
        
        .doc-btn.deny { color: #333; }
        .doc-btn.deny:hover { background: #e8e8e8; }

        /* FAKE FILE VIEWER */
        #fake-viewer-modal {
            position: absolute; top: 50%; left: 50%;
            transform: translate(-50%, -50%);
            width: 500px; height: 400px;
            background: #fff; border: 1px solid #000;
            display: none; flex-direction: column;
            box-shadow: 10px 10px 0 rgba(0,0,0,0.5);
            z-index: 5500;
            font-family: 'Courier New', monospace;
        }
        .viewer-header {
            background: #000080; color: white; padding: 5px 10px;
            display: flex; justify-content: space-between; align-items: center;
            font-family: 'Segoe UI', sans-serif; font-size: 13px;
        }
        .viewer-content {
            flex: 1; padding: 20px; overflow: auto;
            background: #fff; color: #000; white-space: pre-wrap;
        }
        .viewer-image {
            width: 100%; height: 100%; object-fit: contain; background: #000;
        }

        #palmeiras-overlay {
            position: fixed; inset: 0;
            background: #004400;
            z-index: 9999;
            display: none; align-items: center; justify-content: center; flex-direction: column;
        }
        .palm-img { max-width: 80%; max-height: 60vh; border: 10px solid white; box-shadow: 0 0 50px #fff; }
        .palm-text {
            font-family: 'Impact', sans-serif;
            font-size: 5rem; color: white; text-transform: uppercase;
            margin-top: 20px; text-shadow: 5px 5px 0px black;
            text-align: center;
        }

        @keyframes shake {
            0% { transform: translate(1px, 1px) rotate(0deg); }
            10% { transform: translate(-1px, -2px) rotate(-1deg); }
            20% { transform: translate(-3px, 0px) rotate(1deg); }
            30% { transform: translate(3px, 2px) rotate(0deg); }
            40% { transform: translate(1px, -1px) rotate(1deg); }
            50% { transform: translate(-1px, 2px) rotate(-1deg); }
            60% { transform: translate(-3px, 1px) rotate(0deg); }
            70% { transform: translate(3px, 1px) rotate(-1deg); }
            80% { transform: translate(-1px, -1px) rotate(1deg); }
            90% { transform: translate(1px, 2px) rotate(0deg); }
            100% { transform: translate(1px, -2px) rotate(-1deg); }
        }

        /* GTA 6 DOWNLOAD BAR */
        .download-window-content {
            display: flex; flex-direction: column; gap: 10px; justify-content: center; align-items: center; height: 100%;
        }
        .download-bar-container {
            width: 100%; height: 20px; background: #ddd; border: 1px solid #999; position: relative;
        }
        .download-bar {
            height: 100%; width: 0%; background: #00cc00; transition: width 0.1s linear;
        }
        .download-text { font-size: 12px; font-family: 'Segoe UI'; color: #333; }

        /* RUNNING BUTTON */
        .running-btn {
            position: absolute; transition: all 0.1s ease; 
        }

        /* QUIZ STYLES */
        .quiz-option {
            display: block; width: 100%; padding: 8px; margin-bottom: 5px;
            background: #e1e1e1; border: 1px solid #adadad; cursor: pointer; text-align: left;
        }
        .quiz-option:hover { background: #d1d1d1; }

        /* BACKGROUND MESSAGE FOR FOLDERS */
        .bg-message-overlay {
            position: absolute; inset: 0; display: flex; justify-content: center; align-items: center;
            font-size: 5rem; font-weight: bold; color: rgba(0,0,0,0.1); z-index: 0;
            pointer-events: none; text-transform: uppercase; text-align: center;
        }

        /* Alert Modal (Critical Error inside VS Code) */
        #error-modal {
            position: absolute; top: 50%; left: 50%;
            transform: translate(-50%, -50%) scale(0.8);
            width: 400px;
            background: rgba(30, 30, 30, 0.95);
            border: 1px solid #ff3333;
            border-radius: 12px;
            padding: 0;
            display: none; opacity: 0;
            flex-direction: column;
            z-index: 3000;
            box-shadow: 0 20px 60px rgba(0,0,0,0.8);
            backdrop-filter: blur(10px);
        }
        .modal-header {
            padding: 15px; border-bottom: 1px solid #444;
            display: flex; justify-content: space-between; align-items: center;
            background: rgba(255, 0, 0, 0.1);
            border-radius: 12px 12px 0 0;
        }
        .modal-title { color: white; font-weight: 600; font-size: 14px; display: flex; align-items: center; gap: 10px; }
        .modal-close { cursor: pointer; color: #aaa; transition: 0.2s; font-size: 16px; width: 24px; height: 24px; display: flex; align-items: center; justify-content: center; border-radius: 4px; }
        .modal-close:hover { background: #ff3333; color: white; }
        
        .modal-body { padding: 30px 20px; text-align: center; color: #ddd; font-size: 14px; line-height: 1.5; }
        .error-icon { font-size: 40px; color: #ff3333; margin-bottom: 15px; display: block; }
        .modal-footer { padding: 15px; border-top: 1px solid #444; text-align: right; }
        .modal-btn { padding: 8px 20px; background: #333; color: white; border: 1px solid #555; border-radius: 4px; cursor: pointer; font-size: 12px; }
        .modal-btn:hover { background: #444; }

        /* GEMINI SUCCESS MODAL */
        #gemini-success-modal {
            position: absolute; top: 50%; left: 50%;
            transform: translate(-50%, -50%) scale(0.8);
            width: 500px;
            background: rgba(20, 20, 30, 0.95);
            border: 2px solid transparent;
            background-image: linear-gradient(rgba(20, 20, 30, 0.95), rgba(20, 20, 30, 0.95)), linear-gradient(45deg, #4b90ff, #ff5546);
            background-origin: border-box;
            background-clip: content-box, border-box;
            
            border-radius: 16px;
            padding: 0;
            display: none; opacity: 0;
            flex-direction: column;
            z-index: 3100;
            box-shadow: 0 0 50px rgba(75, 144, 255, 0.2);
            backdrop-filter: blur(15px);
        }

        .gemini-header {
            padding: 20px;
            background: linear-gradient(to right, rgba(75, 144, 255, 0.1), rgba(255, 85, 70, 0.1));
            display: flex; justify-content: space-between; align-items: center;
            border-radius: 14px 14px 0 0;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }
        .gemini-title {
            font-size: 18px; font-weight: 700;
            background: linear-gradient(to right, #4b90ff, #ff5546);
            -webkit-background-clip: text; background-clip: text; color: transparent;
            display: flex; align-items: center; gap: 10px;
        }
        
        .gemini-body {
            padding: 30px; text-align: center; color: #eee;
        }
        .gemini-body h2 { font-size: 24px; margin-bottom: 15px; font-weight: 300; }
        .gemini-body strong { color: #fff; font-weight: 700; }
        .gemini-body p { margin-bottom: 15px; line-height: 1.6; color: #ccc; font-size: 14px; }

        .gemini-close {
            cursor: pointer; width: 30px; height: 30px;
            display: flex; justify-content: center; align-items: center;
            border-radius: 50%; background: rgba(255,255,255,0.1);
            color: white; font-size: 14px; transition: 0.3s;
        }
        .gemini-close:hover { background: rgba(255,255,255,0.3); transform: rotate(90deg); }


        /* =========================================
           SCENE 5: VS CODE (The App)
           ========================================= */
        #scene-vscode {
            position: absolute; top: 50%; left: 50%;
            width: 95%; height: 90%;
            transform: translate(-50%, -50%) scale(0.8);
            background: var(--vscode-bg);
            display: none; flex-direction: column;
            z-index: 75; opacity: 0;
            border-radius: 8px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.5);
            overflow: hidden; border: 1px solid #333;
        }

        /* Title Bar */
        .vs-titlebar {
            height: 30px; background: #333;
            display: flex; align-items: center; justify-content: center;
            color: #ccc; font-size: 12px; position: relative;
            flex-shrink: 0;
        }
        .vs-controls { position: absolute; right: 0; display: flex; }
        .vs-control { width: 40px; height: 30px; display: flex; justify-content: center; align-items: center; }
        .vs-control.close:hover { background: #e81123; color: white; }

        /* Main Area */
        .vs-body { flex: 1; display: flex; overflow: hidden; }

        /* Sidebar */
        .vs-activitybar { width: 50px; background: #333; display: flex; flex-direction: column; align-items: center; padding-top: 10px; gap: 20px; color: #858585; font-size: 24px; flex-shrink: 0; }
        .vs-activitybar i:first-child { color: white; border-left: 2px solid white; padding-left: 10px; margin-left: -12px; }
        
        .vs-sidebar { width: 200px; background: var(--vscode-sidebar); border-right: 1px solid #111; padding: 10px; font-size: 13px; color: #ccc; flex-shrink: 0; }
        .vs-file-tree { margin-top: 10px; margin-left: 10px; }
        .vs-file { display: flex; align-items: center; gap: 6px; padding: 3px; color: #d4d4d4; cursor: pointer; background: transparent; }
        .vs-file.active { background: #37373d; }
        .vs-file i.react-icon { color: #61dbfb; }
        
        /* Gemini Icon in Sidebar */
        .gemini-file { 
            margin-top: 20px; border-top: 1px solid #333; padding-top: 10px; 
            color: #aaa; cursor: pointer; opacity: 0.5; transition: all 0.3s;
        }
        .gemini-file:hover, .gemini-file.pulse { color: white; opacity: 1; }
        .gemini-file.pulse { animation: pulse-glow 1.5s infinite; }
        
        @keyframes pulse-glow {
            0% { text-shadow: 0 0 0px rgba(75, 144, 255, 0); }
            50% { text-shadow: 0 0 10px rgba(75, 144, 255, 0.8); }
            100% { text-shadow: 0 0 0px rgba(75, 144, 255, 0); }
        }

        .gemini-icon-glow {
            background: linear-gradient(to right, var(--gemini-grad-start), var(--gemini-grad-end));
            -webkit-background-clip: text; background-clip: text; color: transparent;
        }

        /* Editor Area */
        .vs-editor-area { flex: 1; display: flex; }
        
        /* Code Panel (Left) */
        .vs-code-panel { 
            width: 60%; 
            background: var(--vscode-bg); 
            display: flex; flex-direction: column;
            border-right: 1px solid #111;
            min-height: 0; /* FIX: Prevent flex item from overflowing parent */
        }
        .vs-tabs { background: var(--vscode-sidebar); display: flex; height: 35px; flex-shrink: 0; }
        .vs-tab { 
            background: var(--vscode-bg); color: #fff; 
            padding: 8px 15px; font-size: 13px; 
            border-top: 1px solid #007acc;
            display: flex; align-items: center; gap: 8px;
        }
        .vs-code-content {
            flex: 1; padding: 10px; 
            font-family: 'Fira Code', monospace; 
            font-size: 12px; line-height: 1.5;
            color: #d4d4d4; 
            overflow-y: auto;
            position: relative; 
            scroll-behavior: smooth;
            white-space: pre;
            min-height: 0; /* FIX: Critical for flex containers scrolling correctly */
        }
        
        /* Preview Panel (Right) - Adapted for the new request */
        .vs-preview-panel { 
            width: 40%; 
            background-color: var(--preview-bg); /* Uses new CSS var */
            position: relative; 
            overflow: hidden;
            display: flex; 
            justify-content: center; 
            align-items: center;
            opacity: 0; /* Starts Hidden */
            transition: opacity 1.5s ease-in;
        }
        
        /* Syntax Highlighting for Code Editor */
        .k-import { color: #c586c0; } 
        .k-var { color: #569cd6; }   
        .k-func { color: #dcdcaa; }  
        .k-tag { color: #569cd6; }    
        .k-attr { color: #9cdcfe; }   
        .k-str { color: #ce9178; }    
        .k-comment { color: #6a9955; }
        .k-bracket { color: #ffd700; }
        .k-def { color: #9cdcfe; }
        .k-obj { color: #4ec9b0; }
        
        .typing-cursor {
            display: inline-block; width: 2px; height: 16px; background: white;
            animation: blink 1s infinite; vertical-align: middle;
        }

        .typing-hint {
            position: absolute; bottom: 30px; right: 20px;
            background: #252526; padding: 8px 15px; border: 1px solid #333;
            color: #aaa; font-size: 12px; font-family: 'Segoe UI';
            border-radius: 4px; pointer-events: none;
            opacity: 0.8; animation: pulse 2s infinite;
        }

        /* Glitch Effect Class */
        .glitch-error {
            animation: glitch-anim 0.2s infinite;
            filter: hue-rotate(90deg) contrast(1.2);
            border: 2px solid red !important;
            box-shadow: 0 0 20px rgba(255, 0, 0, 0.3);
        }
        
        @keyframes glitch-anim {
            0% { transform: translate(-50%, -50%) scale(1); }
            20% { transform: translate(calc(-50% - 2px), calc(-50% + 2px)) scale(1); }
            40% { transform: translate(calc(-50% - 2px), calc(-50% - 2px)) scale(1); }
            60% { transform: translate(calc(-50% + 2px), calc(-50% + 2px)) scale(1); }
            80% { transform: translate(calc(-50% + 2px), calc(-50% - 2px)) scale(1); }
            100% { transform: translate(-50%, -50%) scale(1); }
        }

        /* --- PREVIEW UI ELEMENTS (New Request) --- */
        #scene-container {
            position: absolute;
            inset: 0;
            z-index: 1;
            background: radial-gradient(circle at center, #111 0%, #000 100%);
        }

        canvas {
            display: block;
            width: 100%;
            height: 100%;
            outline: none;
        }

        .interface-layer {
            position: absolute;
            inset: 0;
            z-index: 10;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            pointer-events: none;
        }

        .brand-container {
            text-align: center;
            pointer-events: auto;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .brand-title {
            font-size: 2.5rem; /* Scaled down for preview panel */
            font-weight: 800;
            color: white;
            text-align: center;
            text-shadow: 0 0 30px rgba(255, 255, 255, 0.3);
            line-height: 1.1;
            margin-bottom: 10px;
            font-family: 'Inter', sans-serif;
        }

        .cursor {
            display: inline-block;
            width: 4px;
            height: 1em;
            background-color: #fff;
            vertical-align: bottom;
            animation: blink 1s step-end infinite;
            margin-left: 5px;
        }

        .brand-meta {
            margin-top: 15px;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 5px;
        }

        .alura-gemini-text {
            font-weight: 700;
            font-size: 0.8rem;
            letter-spacing: 2px;
            background: linear-gradient(to right, #ffffff, #4b90ff);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            opacity: 0;
            transform: translateY(20px);
            font-family: 'Inter', sans-serif;
        }

        .project-subtitle {
            font-size: 0.9rem;
            letter-spacing: 4px;
            color: #888;
            text-transform: uppercase;
            font-weight: 300;
            opacity: 0;
            transform: translateY(20px);
            font-family: 'Inter', sans-serif;
        }

        .primary-action {
            margin-top: 30px;
            padding: 10px 30px;
            background: transparent;
            border: 1px solid rgba(255, 255, 255, 0.3);
            color: white;
            border-radius: 50px;
            font-size: 0.8rem;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
            font-weight: 600;
            letter-spacing: 2px;
            opacity: 0;
            transform: translateY(20px);
            font-family: 'Inter', sans-serif;
            pointer-events: auto;
        }

        .primary-action:hover {
            background: white;
            color: black;
            box-shadow: 0 0 30px rgba(255, 255, 255, 0.5);
            transform: translateY(20px) scale(1.05);
        }

        .primary-action:active {
            transform: translateY(20px) scale(0.95);
        }

        /* DARKNESS OVERLAY & FLASHLIGHT */
        #darkness-overlay {
            position: absolute; inset: 0;
            background-color: #000;
            z-index: 200; /* Above everything on desktop */
            pointer-events: none;
            opacity: 0;
            transition: opacity 3s ease;
        }
        #darkness-overlay.active {
            pointer-events: auto;
            cursor: none; /* Hide default cursor */
            /* Flashlight Mask */
            mask-image: radial-gradient(circle 150px at var(--x, 50%) var(--y, 50%), transparent 0%, transparent 90%, black 100%);
            -webkit-mask-image: radial-gradient(circle 150px at var(--x, 50%) var(--y, 50%), transparent 0%, black 100%);
            /* Invert mask logic: we want to SEE through the hole. 
               Actually, simpler: make the overlay black, and mask allows seeing through.
               Wait, standard mask reveals where it is opaque.
               So we want the overlay to be opaque everywhere EXCEPT the circle.
            */
            -webkit-mask-image: radial-gradient(circle 100px at var(--x, 50%) var(--y, 50%), transparent 0%, black 100%);
            mask-image: radial-gradient(circle 100px at var(--x, 50%) var(--y, 50%), transparent 0%, black 100%);
        }

        /* Gravity Fall Class */
        .falling {
            transition: transform 1s cubic-bezier(0.5, 0, 0.5, 1), rotate 1s ease;
        }

        /* ANTI-GRAVITY ANIMATION */
        .anti-gravity-active {
            transition: top 5s ease-in-out;
            top: 20px !important;
            animation: bounceTop 3s infinite ease-in-out;
        }
        @keyframes bounceTop {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(20px); }
        }

        /* MATRIX EFFECT IN CMD */
        .matrix-text {
            color: #0f0;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            white-space: pre-wrap;
            line-height: 1;
        }

        /* WHITE SCREEN OF DEATH */
        #white-screen-overlay {
            position: fixed; inset: 0; background: white; z-index: 9999;
            display: none; align-items: center; justify-content: center;
            font-family: 'Segoe UI', sans-serif; color: #000;
        }

        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #1e1e1e; }
        ::-webkit-scrollbar-thumb { background: #444; border-radius: 4px; }
        
        @keyframes pulse { 0%,100% {opacity: 0.5} 50% {opacity: 1} }
        @keyframes blink { 50% {opacity: 0} }

        /* =========================================
           MOBILE RESPONSIVENESS (Advanced)
           ========================================= */
        @media (max-width: 768px) {
            body { 
                overflow: hidden; 
                position: fixed; 
                height: 100%; 
                width: 100%; 
            }
            
            .desktop-icon { width: 80px; }
            .icon-img { font-size: 1.8rem; }
            .custom-icon-img { width: 32px; height: 32px; }
            .icon-label { font-size: 0.7rem; }
            .desktop-grid { flex-direction: row; align-content: flex-start; gap: 10px; padding: 15px; }

            .mobile-disclaimer { display: block; }

            /* VS Code Mobile Layout */
            #scene-vscode {
                width: 100%;
                height: 100%;
                border: none;
                border-radius: 0;
                transform: none !important;
                top: 0; left: 0;
            }

            .vs-body {
                flex-direction: column;
            }

            /* Hide Sidebars on Mobile to maximize space */
            .vs-activitybar, .vs-sidebar {
                display: none;
            }

            .vs-editor-area {
                flex-direction: column;
                height: 100%;
                overflow: hidden; /* Prevents container expansion */
            }

            /* Code Panel on Top (50%) */
            .vs-code-panel {
                width: 100%;
                height: 50%; /* Strict height */
                flex-basis: 50%;
                border-right: none;
                border-bottom: 1px solid #333;
            }

            .vs-code-content {
                font-size: 10px; /* Smaller font for code */
                padding: 5px;
            }

            /* Preview Panel on Bottom (50%) */
            .vs-preview-panel {
                width: 100%;
                height: 50%; /* Strict height */
                flex-basis: 50%;
                opacity: 1; /* Visible immediately on mobile */
            }

            /* Adjust Preview Elements for small space */
            .brand-title {
                font-size: 1.8rem;
                margin-bottom: 5px;
            }
            .alura-gemini-text { font-size: 0.6rem; }
            .project-subtitle { font-size: 0.7rem; }
            
            .primary-action {
                margin-top: 15px;
                padding: 8px 20px;
                font-size: 0.7rem;
                transform: translateY(0); /* Reset transform logic for simple show */
            }

            .typing-hint {
                bottom: 5px; right: 5px;
                padding: 4px 8px; font-size: 10px;
            }
        }

    </style>
</head>
<body>

    <!-- AUDIO ELEMENTS -->
    <audio id="siren-sound" src="sirene.mp3" preload="auto"></audio>

    <!-- DARKNESS OVERLAY FOR "DESLIGAR O SOL" -->
    <div id="darkness-overlay"></div>

    <!-- WHITE SCREEN OF DEATH (FORMAT PRANK) -->
    <div id="white-screen-overlay">
        <div id="white-screen-msg" style="font-size: 12px; opacity: 0; transition: opacity 1s;">Era brincadeira, volta aqui.</div>
    </div>

    <!-- NOTIFICATION SYSTEM -->
    <div class="win-notification" id="win-notif">
        <div class="notif-icon"><i class="fa-brands fa-windows"></i></div>
        <div class="notif-content" id="notif-text">
            <h4>Sistema Pronto</h4>
            <p>Clique no ícone VS Code para iniciar.</p>
        </div>
    </div>

    <!-- PROGRAMMER ALERT MODAL -->
    <div id="programmer-alert-modal">
        <div class="modal-header">
            <div class="modal-title"><i class="fa-solid fa-user-secret"></i> Nova Missão</div>
        </div>
        <div class="modal-body" style="text-align: center;">
            <i class="fa-solid fa-code" style="font-size: 40px; color: #00ff9d; margin-bottom: 15px;"></i>
            <p style="font-size: 16px; font-weight: bold; margin-bottom: 10px; color: #fff;">ACESSO RESTRITO</p>
            <p>Você assumiu o papel de <strong>Dev FullStack</strong>.</p>
            <p style="margin-top: 10px; color: #aaa;">Para liberar o acesso ao portal da Cidade de Uberaba, você deve programar a entrada do site manualmente.</p>
        </div>
        <div class="modal-footer" style="justify-content: center;">
            <button class="modal-btn" id="btn-close-prog-alert">Aceitar Missão</button>
        </div>
    </div>

    <!-- DESKTOP WINDOWS ERROR DIALOG (Generic) -->
    <div id="win-error-box">
        <div class="win-err-header">
            <span class="win-err-title">Erro do Sistema</span>
            <div class="win-err-close" onclick="closeWinError()">✕</div>
        </div>
        <div class="win-err-body">
            <div class="win-err-icon">
                <i class="fa-solid fa-circle-xmark"></i>
            </div>
            <div class="win-err-msg" id="win-error-msg-text">
                O Windows não pode abrir este arquivo. Acesso restrito ao ambiente de desenvolvimento.
            </div>
        </div>
        <div class="win-err-footer">
            <button class="win-err-btn" onclick="closeWinError()">OK</button>
        </div>
    </div>

    <!-- FAKE FILE VIEWER MODAL -->
    <div id="fake-viewer-modal">
        <div class="viewer-header">
            <span id="viewer-title">notepad.exe</span>
            <div class="win-err-close" onclick="closeViewer()">✕</div>
        </div>
        <div class="viewer-content" id="viewer-body">
            <!-- Content inserted by JS -->
        </div>
    </div>

    <!-- FAKE CHROME BROWSER MODAL (RESUME) -->
    <div id="chrome-window" class="os-window" style="display: none;">
        <div class="os-header">
            <div class="os-titlebar" style="background: #3c3c3c; color: white;">
                <div class="os-title">Currículo - Google Chrome</div>
                <div class="os-controls">
                    <button class="os-btn" onclick="closeChrome()"><i class="fa-solid fa-xmark" style="color: white;"></i></button>
                </div>
            </div>
            <div class="os-address-bar" style="background: #202124; color: white; border: none; padding: 8px;">
                <i class="fa-solid fa-lock" style="color: #8ab4f8; font-size: 12px;"></i>
                <span style="margin-left: 10px; font-family: 'Segoe UI'; font-size: 13px;">https://curriculo-eta-blue.vercel.app/</span>
            </div>
        </div>
        <div class="os-body" style="padding: 0; overflow: hidden;">
            <iframe src="https://curriculo-eta-blue.vercel.app/" style="width: 100%; height: 100%; border: none;"></iframe>
        </div>
    </div>

    <!-- COACH QUANTICO WINDOW -->
    <div id="coach-window" class="os-window" style="width: 350px; height: 250px;">
        <div class="os-header">
            <div class="os-titlebar">
                <div class="os-title">Coach Quântico 3.0</div>
                <div class="os-controls"><button class="os-btn close" onclick="document.getElementById('coach-window').style.display='none'"><i class="fa-solid fa-xmark"></i></button></div>
            </div>
        </div>
        <div class="os-body" style="display: flex; flex-direction: column; justify-content: center; align-items: center; text-align: center; padding: 30px;">
            <p id="coach-text" style="font-style: italic; margin-bottom: 20px; font-size: 14px;">"O universo aguarda seu comando."</p>
            <button class="win-err-btn" onclick="generateWisdom()">Gerar Nova Sabedoria</button>
        </div>
    </div>

    <!-- MONEY GENERATOR WINDOW (CMD) -->
    <div id="money-window" class="os-window" style="width: 500px; height: 300px; background: black; border-color: #444;">
        <div class="os-header">
            <div class="os-titlebar" style="background: white; color: black;">
                <div class="os-title">C:\Windows\system32\cmd.exe - Gerar Dinheiro</div>
                <div class="os-controls"><button class="os-btn close" onclick="closeMoney()"><i class="fa-solid fa-xmark"></i></button></div>
            </div>
        </div>
        <div class="os-body" id="money-content" style="background: black; color: #0f0; font-family: 'Courier New', monospace; padding: 10px; overflow: hidden;">
            <!-- Matrix text injected here -->
        </div>
    </div>

    <!-- DOMINATION PLAN PASSWORD -->
    <div id="domination-window" class="os-window" style="width: 300px; height: 180px; top: 40%; left: 40%;">
        <div class="os-header">
            <div class="os-titlebar">
                <div class="os-title">Segurança Máxima</div>
                <div class="os-controls"><button class="os-btn close" onclick="document.getElementById('domination-window').style.display='none'"><i class="fa-solid fa-xmark"></i></button></div>
            </div>
        </div>
        <div class="os-body" style="display: flex; flex-direction: column; align-items: center; justify-content: center; gap: 10px;">
            <p>Digite a senha mestre:</p>
            <input type="password" id="domination-pass" class="pass-input" style="pointer-events: auto; border: 1px solid #999; padding: 5px;">
            <button class="win-err-btn" onclick="checkDominationPass()">Confirmar</button>
        </div>
    </div>

    <!-- UNINSTALL WINDOW -->
    <div id="uninstall-window" class="os-window" style="width: 400px; height: 150px; top: 45%; left: 40%;">
        <div class="os-header">
            <div class="os-titlebar">
                <div class="os-title">Desinstalador do Windows</div>
            </div>
        </div>
        <div class="os-body download-window-content">
            <p>Formatando C: ...</p>
            <div class="download-bar-container">
                <div class="download-bar" id="uninstall-bar" style="background: red;"></div>
            </div>
        </div>
    </div>

    <!-- SALARY CALCULATOR -->
    <div id="salary-window" class="os-window" style="width: 350px; height: 300px;">
        <div class="os-header">
            <div class="os-titlebar">
                <div class="os-title">Calculadora de Salário Real</div>
                <div class="os-controls"><button class="os-btn close" onclick="document.getElementById('salary-window').style.display='none'"><i class="fa-solid fa-xmark"></i></button></div>
            </div>
        </div>
        <div class="os-body" style="display: flex; flex-direction: column; gap: 10px; padding: 20px;">
            <label>Salário Bruto (R$):</label>
            <input type="number" class="pass-input" style="pointer-events: auto; border: 1px solid #999; padding: 5px;">
            <button class="win-err-btn" onclick="calcSalary()">Calcular</button>
            <div id="salary-result" style="margin-top: 10px; font-size: 13px; color: #333; display:none;">
                <p>- Imposto pra políticos:</p>
                <p>- Taxa do Café:</p>
                <p>- Taxa por ser feio:</p>
                <p>- Juros Cheque Especial:</p>
                <p style="margin-top:10px; font-weight:bold; color:red;">LÍQUIDO: R$ 12,50 e um Vale-Transporte.</p>
            </div>
        </div>
    </div>

    <!-- EXCUSE GENERATOR -->
    <div id="excuse-window" class="os-window" style="width: 400px; height: 200px;">
        <div class="os-header">
            <div class="os-titlebar">
                <div class="os-title">Gerador de Desculpas 2000</div>
                <div class="os-controls"><button class="os-btn close" onclick="document.getElementById('excuse-window').style.display='none'"><i class="fa-solid fa-xmark"></i></button></div>
            </div>
        </div>
        <div class="os-body" style="text-align: center; display: flex; flex-direction: column; justify-content: center; align-items: center;">
            <p id="excuse-text" style="font-size: 14px; margin-bottom: 20px; font-weight: bold;">"Clique para gerar uma desculpa infalível."</p>
            <button class="win-err-btn" onclick="generateExcuse()">Gerar Desculpa</button>
        </div>
    </div>

    <!-- RETIREMENT PLANNER -->
    <div id="retirement-window" class="os-window" style="width: 350px; height: 180px;">
        <div class="os-header">
            <div class="os-titlebar">
                <div class="os-title">Planejamento INSS</div>
                <div class="os-controls"><button class="os-btn close" onclick="document.getElementById('retirement-window').style.display='none'"><i class="fa-solid fa-xmark"></i></button></div>
            </div>
        </div>
        <div class="os-body download-window-content">
            <p id="retire-status">Analisando tempo de contribuição...</p>
            <div class="download-bar-container">
                <div class="download-bar" id="retire-bar" style="background: blue;"></div>
            </div>
        </div>
    </div>

    <!-- WEATHER 2050 -->
    <div id="weather-window" class="os-window" style="width: 400px; height: 400px;">
        <div class="os-header">
            <div class="os-titlebar">
                <div class="os-title">Previsão do Tempo - 15/08/2050</div>
                <div class="os-controls"><button class="os-btn close" onclick="document.getElementById('weather-window').style.display='none'"><i class="fa-solid fa-xmark"></i></button></div>
            </div>
        </div>
        <div class="os-body" style="text-align: center;">
            <!-- PLACEHOLDER PARA GIF -->
            <div style="width: 100%; height: 150px; background: #000; display: flex; align-items: center; justify-content: center; margin-bottom: 20px;">
                <!-- INSIRA GIF AQUI -->
                <img src="Terrapegandofogo.gif" style="width:100%; height:100%; object-fit:cover;">
            </div>
            <h2 style="color: red; font-size: 30px;">400ºC</h2>
            <p style="font-size: 14px; margin-bottom: 20px;">Sensação Térmica: Inferno</p>
            <p style="background: #ffffcc; padding: 10px; border: 1px solid #eebb00; font-size: 12px;">
                <strong>Dica do Dia:</strong> Use protetor solar fator 5000 e evite respirar fundo para não queimar os pulmões.
            </p>
        </div>
    </div>

    <!-- GTA DOWNLOAD MODAL -->
    <div id="gta-window" class="os-window" style="width: 400px; height: 250px; top: 40%; left: 40%;">
        <div class="os-header">
            <div class="os-titlebar">
                <div class="os-title">GTA VI Launcher Beta</div>
            </div>
        </div>
        <div class="os-body download-window-content">
            <!-- GTA CUSTOM IMAGE PLACEHOLDER -->
            <img src="gta6.png" style="width: 50px; margin-bottom: 10px;">
            <p class="download-text">Baixando Grand Theft Auto VI...</p>
            <div class="download-bar-container">
                <div class="download-bar" id="gta-progress"></div>
            </div>
            <p id="gta-status" style="font-size: 11px; color: #666;">Calculando tempo restante...</p>
            <button class="win-err-btn" onclick="closeGta()" style="margin-top: 10px;">Cancelar</button>
        </div>
    </div>

    <!-- INTERNET DOWNLOAD MODAL -->
    <div id="internet-window" class="os-window" style="width: 400px; height: 250px; top: 45%; left: 45%;">
        <div class="os-header">
            <div class="os-titlebar">
                <div class="os-title">Baixando Internet Inteira (Zip)</div>
                <div class="os-controls"><button class="os-btn close" onclick="document.getElementById('internet-window').style.display='none'"><i class="fa-solid fa-xmark"></i></button></div>
            </div>
        </div>
        <div class="os-body download-window-content">
            <i class="fa-solid fa-globe" style="font-size: 40px; color: #0078d7; margin-bottom: 10px;"></i>
            <div class="download-bar-container">
                <div class="download-bar" id="internet-progress" style="width: 0%; background: #0078d7; transition: width 5s linear;"></div>
            </div>
            <p style="font-size: 11px; color: #666; margin-top: 10px;">Tamanho estimado: 9999999 TB</p>
            <p style="font-size: 11px; color: #666;">Tempo restante: 400 encarnações</p>
        </div>
    </div>

    <!-- RESOLVE LIFE MODAL -->
    <div id="life-window" class="os-window" style="width: 400px; height: 200px; top: 35%; left: 40%;">
        <div class="os-header">
            <div class="os-titlebar">
                <div class="os-title">Resolver sua Vida.exe</div>
                <div class="os-controls"><button class="os-btn close" onclick="document.getElementById('life-window').style.display='none'"><i class="fa-solid fa-xmark"></i></button></div>
            </div>
        </div>
        <div class="os-body download-window-content">
            <p id="life-status">Resolvendo problemas...</p>
            <div class="download-bar-container">
                <div class="download-bar" id="life-progress" style="background: #00ff00;"></div>
            </div>
        </div>
    </div>

    <!-- QUIZ MODAL -->
    <div id="quiz-window" class="os-window" style="width: 450px; height: 350px;">
        <div class="os-header">
            <div class="os-titlebar">
                <div class="os-title">Teste de QI Oficial</div>
                <div class="os-controls">
                    <button class="os-btn close" onclick="closeQuiz()"><i class="fa-solid fa-xmark"></i></button>
                </div>
            </div>
        </div>
        <div class="os-body" id="quiz-body" style="text-align: center; display: flex; flex-direction: column; justify-content: center; align-items: center;">
            <!-- Content via JS -->
        </div>
    </div>

    <!-- LOADING MODAL (LOVE LIST) -->
    <div id="love-window" class="os-window" style="width: 200px; height: 150px; top: 45%; left: 45%;">
        <div class="os-header">
            <div class="os-titlebar">
                <div class="os-title">Lista</div>
                <div class="os-controls">
                    <button class="os-btn close" onclick="document.getElementById('love-window').style.display='none'"><i class="fa-solid fa-xmark"></i></button>
                </div>
            </div>
        </div>
        <div class="os-body" style="display: flex; flex-direction: column; align-items: center; justify-content: center;">
            <i class="fa-solid fa-spinner fa-spin" style="font-size: 30px; margin-bottom: 10px;"></i>
            <p>Carregando...</p>
        </div>
    </div>

    <!-- PATIENCE TEST WINDOW -->
    <div id="patience-window" class="os-window">
        <div class="os-header">
            <div class="os-titlebar">
                <div class="os-title">Teste de Paciência</div>
                <div class="os-controls">
                    <button class="os-btn close" onclick="document.getElementById('patience-window').style.display='none'"><i class="fa-solid fa-xmark"></i></button>
                </div>
            </div>
        </div>
        <div class="os-body" style="position: relative;">
            <p style="text-align: center; margin-bottom: 20px;">Clique no botão para ganhar R$ 1.000,00</p>
            <button id="run-btn" class="win-err-btn running-btn" style="position: absolute; left: 45%; top: 40%;">CLIQUE AQUI</button>
        </div>
    </div>

    <!-- GENERIC FOLDER WINDOW -->
    <div id="generic-folder-window" class="os-window">
        <div class="os-header">
            <div class="os-titlebar">
                <div class="os-title" id="generic-folder-title"><i class="fa-solid fa-folder"></i> Pasta</div>
                <div class="os-controls">
                    <button class="os-btn"><i class="fa-solid fa-minus"></i></button>
                    <button class="os-btn"><i class="fa-regular fa-square"></i></button>
                    <button class="os-btn close" onclick="document.getElementById('generic-folder-window').style.display='none'"><i class="fa-solid fa-xmark"></i></button>
                </div>
            </div>
            <div class="os-address-bar">
                <i class="fa-solid fa-folder" style="color: #ffce44;"></i>
                <span id="generic-folder-path">C:\Desktop\Pasta</span>
            </div>
        </div>
        <div class="os-body">
            <div class="bg-message-overlay" id="generic-bg-msg"></div>
            <div class="photo-grid" id="generic-folder-content">
                <!-- Content Injected by JS -->
            </div>
        </div>
    </div>

    <!-- OFFICIAL DOCUMENT TERM MODAL -->
    <div id="prank-term-modal">
        <div class="document-paper">
            <div class="doc-seal">
                <i class="fa-solid fa-scale-balanced"></i>
            </div>
            <div class="doc-title">TERMO DE RESPONSABILIDADE</div>
            
            <div class="doc-text">
                Declaro para os devidos fins que fui devidamente alertado sobre a natureza instável e potencialmente perigosa dos diretórios criptografados contidos neste sistema.
                <br><br>
                Reconheço que o acesso não autorizado pode resultar em instabilidade cognitiva, loops temporais, e exposição a verdades inconvenientes. Ao prosseguir, isento o sistema de qualquer dano irreversível à minha sanidade.
            </div>
            
            <div class="doc-input-group">
                <label class="doc-label">Assine seu nome para concordar:</label>
                <input type="text" id="term-name" class="doc-input" placeholder="DIGITE SEU NOME" autocomplete="off">
            </div>
            
            <div class="doc-actions">
                <button class="doc-btn deny" onclick="closeTerm()">Voltar</button>
                <button class="doc-btn accept" id="btn-accept-term" onclick="acceptTerm()">ACEITAR DESTINO</button>
            </div>
        </div>
    </div>

    <!-- PALMEIRAS PUNCHLINE OVERLAY -->
    <div id="palmeiras-overlay">
        <img src="semmundial.png" alt="Palmeiras Não Tem Mundial" class="palm-img">
        <div class="palm-text">NÃO TEM MUNDIAL!</div>
    </div>

    <!-- ALERT MODAL (CRITICAL ERROR IN VSCODE) -->
    <div id="error-modal">
        <div class="modal-header">
            <div class="modal-title">
                <i class="fa-solid fa-triangle-exclamation" style="color: #ff3333"></i> Runtime Error
            </div>
            <div class="modal-close" id="btn-close-modal"><i class="fa-solid fa-xmark"></i></div>
        </div>
        <div class="modal-body">
            <i class="fa-solid fa-bug error-icon"></i>
            <p><strong>CRITICAL FAILURE DETECTED</strong></p>
            <p style="margin-top: 10px; color: #aaa;">O código contém erros de sintaxe que impossibilitam a compilação do projeto.</p>
            <p style="margin-top: 10px; color: #fff;">Sugerido: Utilize a extensão <strong>Google Gemini AI</strong> na barra lateral para reescrever e corrigir o código.</p>
        </div>
        <div class="modal-footer">
            <button class="modal-btn" id="btn-ack-error">Entendido</button>
        </div>
    </div>

    <!-- SUCCESS MODAL (GEMINI PROMO) -->
    <div id="gemini-success-modal">
        <div class="gemini-header">
            <div class="gemini-title">
                <i class="fa-solid fa-wand-magic-sparkles"></i> Google Gemini AI
            </div>
            <div class="gemini-close" id="btn-close-success">
                <i class="fa-solid fa-xmark"></i>
            </div>
        </div>
        <div class="gemini-body">
            <h2>Código Otimizado com Sucesso!</h2>
            <p>
                Através da parceria <strong>Alura + Google Gemini</strong>, utilizamos o poder da inteligência artificial para acelerar o desenvolvimento e corrigir bugs complexos em segundos.
            </p>
            <p style="color: #888; font-size: 12px;">Imersão Dev • Projeto Uberaba City • 2025</p>
        </div>
    </div>

    <!-- 1. POWER SCENE -->
    <div id="scene-power">
        <div class="power-btn" id="btn-power">
            <i class="fa-solid fa-power-off"></i>
        </div>
        <div class="power-msg">LIGAR COMPUTADOR </div>
        <!-- Mobile Disclaimer -->
        <div class="mobile-disclaimer">
            A imersão completa de programar a entrada do site é somente quando acessado pelo computador. Pelo celular o processo é automático.
        </div>
    </div>

    <!-- 2. BIOS SCENE -->
    <div id="scene-bios">
        <div id="bios-text"></div>
    </div>

    <!-- 3. LOGIN SCENE -->
    <div id="scene-login">
        <div id="lock-screen-content">
            <div class="lock-time" id="clock-time">10:00</div>
            <div class="lock-date" id="clock-date">Terça-feira, 20 de Maio</div>
        </div>

        <div id="login-form">
            <div class="user-avatar">
                <i class="fa-solid fa-user" style="opacity: 0.5;"></i>
            </div>
            <div class="user-name">Pedro Henrique</div>
            <input type="password" class="pass-input" id="pass-input" placeholder="Senha">
            <button class="login-btn">Entrar</button>
        </div>
    </div>

    <!-- 4. DESKTOP SCENE -->
    <div id="scene-desktop">
        <div class="desktop-grid">
            <div class="desktop-icon" onclick="openTrash()">
                <i class="fa-solid fa-trash-can icon-img" style="color: #ddd"></i>
                <div class="icon-label">Lixeira</div>
            </div>
            
            <!-- PRANK FOLDER ICON - Modified Color -->
            <div class="desktop-icon" onclick="openPrankFolder()">
                <i class="fa-solid fa-folder icon-img" style="color: #ffce44;"></i>
                <div class="icon-label">NÃO ABRA</div>
            </div>

            <div class="desktop-icon" onclick="wrongMyComputer()">
                <i class="fa-solid fa-desktop icon-img" style="color: #fff"></i>
                <div class="icon-label">Meu Computador</div>
            </div>
            
            <!-- VS CODE ICON -->
            <div class="desktop-icon" id="icon-vscode">
                <i class="fa-solid fa-code icon-img" style="color: #0078d7"></i>
                <div class="icon-label">Visual Studio Code</div>
            </div>

            <!-- NEW ICONS -->
            <div class="desktop-icon" onclick="openMusicFolder()">
                <i class="fa-solid fa-music icon-img" style="color: #e91e63;"></i>
                <div class="icon-label">Músicas</div>
            </div>
            <div class="desktop-icon" onclick="openImagesFolder()">
                <i class="fa-solid fa-images icon-img" style="color: #00bcd4;"></i>
                <div class="icon-label">Imagens</div>
            </div>
            <div class="desktop-icon" onclick="openBestTeam()">
                <i class="fa-solid fa-trophy icon-img" style="color: #ffd700;"></i>
                <div class="icon-label">Melhor time do mundo</div>
            </div>
            <!-- MODIFIED: RESUME IS NOW A FOLDER ICON -->
            <div class="desktop-icon" onclick="openResume()">
                <i class="fa-solid fa-folder icon-img" style="color: #ffce44;"></i>
                <div class="icon-label">Currículo do chefe</div>
            </div>
            <div class="desktop-icon" onclick="openCancerCure()">
                <i class="fa-solid fa-heart-pulse icon-img" style="color: #f44336;"></i>
                <div class="icon-label">Cura do câncer</div>
            </div>
            <div class="desktop-icon" onclick="openPrankFolderGeneric('Outros')">
                <i class="fa-solid fa-folder icon-img" style="color: #ffce44;"></i>
                <div class="icon-label">Outros</div>
            </div>
            <div class="desktop-icon" onclick="openArea51()">
                <i class="fa-brands fa-reddit-alien icon-img" style="color: #76ff03;"></i>
                <div class="icon-label">Área 51</div>
            </div>
            <!-- MODIFIED: UGLY PERSON IS NOW A FOLDER ICON -->
            <div class="desktop-icon" onclick="openUglyPerson()">
                <i class="fa-solid fa-folder icon-img" style="color: #ffce44;"></i>
                <div class="icon-label">Pessoa mais feia do mundo</div>
            </div>
            <!-- Removed Pretty Person as requested -->
            <div class="desktop-icon" onclick="openBrowserHistory()">
                <i class="fa-solid fa-clock-rotate-left icon-img" style="color: #ff9800;"></i>
                <div class="icon-label">Histórico do navegador</div>
            </div>
            <div class="desktop-icon" onclick="openVirus()">
                <i class="fa-solid fa-bug icon-img" style="color: #d50000;"></i>
                <div class="icon-label">Vírus Perigoso.exe</div>
            </div>
            <div class="desktop-icon" onclick="openIQTest()">
                <i class="fa-solid fa-brain icon-img" style="color: #2979ff;"></i>
                <div class="icon-label">Teste de QI</div>
            </div>
            <!-- MODIFIED: GTA CUSTOM ICON -->
            <div class="desktop-icon" onclick="openGTA()">
                <img src="gta6.png" class="custom-icon-img" alt="GTA">
                <div class="icon-label">Baixar GTA 6 (Beta)</div>
            </div>
            <!-- MODIFIED: NASA IS NOW A FOLDER ICON -->
            <div class="desktop-icon" onclick="openNASA()">
                <i class="fa-solid fa-folder icon-img" style="color: #ffce44;"></i>
                <div class="icon-label">Senhas da NASA</div>
            </div>
            <div class="desktop-icon" onclick="openLoveList()">
                <i class="fa-solid fa-heart icon-img" style="color: #ff4081;"></i>
                <div class="icon-label">Lista de pessoas que te amam</div>
            </div>
            <div class="desktop-icon" onclick="openPatienceTest()">
                <i class="fa-solid fa-stopwatch icon-img" style="color: #607d8b;"></i>
                <div class="icon-label">Teste de Paciência</div>
            </div>
            <!-- NEW: GRAVITY CRASH FOLDER (RENAMED FUNCTION TO PREVENT CONFLICT) -->
            <div class="desktop-icon" onclick="triggerGravityCrash()">
                <i class="fa-solid fa-folder icon-img" style="color: #ffce44;"></i>
                <div class="icon-label">Não clique aqui</div>
            </div>
            <!-- NEW: DOWNLOAD INTERNET -->
            <div class="desktop-icon" onclick="downloadInternet()">
                <i class="fa-solid fa-globe icon-img" style="color: #0078d7;"></i>
                <div class="icon-label">Baixar Internet Inteira.zip</div>
            </div>
            <!-- NEW: SUN TOGGLE -->
            <div class="desktop-icon" id="sun-icon" onclick="toggleSun()">
                <i class="fa-solid fa-folder icon-img" style="color: #ffce44;"></i>
                <div class="icon-label" id="sun-label">Desligar o sol</div>
            </div>
            <!-- NEW: RESOLVE LIFE -->
            <div class="desktop-icon" onclick="resolveLife()">
                <i class="fa-solid fa-wand-magic-sparkles icon-img" style="color: #9c27b0;"></i>
                <div class="icon-label">Resolver sua Vida.exe</div>
            </div>

            <!-- NEW REQUESTED ICONS -->
            <div class="desktop-icon" onclick="openCoach()">
                <i class="fa-solid fa-lightbulb icon-img" style="color: #ffeb3b;"></i>
                <div class="icon-label">Coach Quântico</div>
            </div>
            <div class="desktop-icon" onclick="openMoneyGen()">
                <i class="fa-solid fa-money-bill-wave icon-img" style="color: #00e676;"></i>
                <div class="icon-label">Gerar Dinheiro Infinito.bat</div>
            </div>
            <div class="desktop-icon" id="icon-domination" onclick="openDomination()">
                <i class="fa-solid fa-folder icon-img" style="color: #ffce44;"></i>
                <div class="icon-label">Planos de Dominação Mundial</div>
            </div>
            <div class="desktop-icon" onclick="openUninstall()">
                <i class="fa-solid fa-compact-disc icon-img" style="color: #ff1744;"></i>
                <div class="icon-label">Desinstalar o Windows</div>
            </div>
            <div class="desktop-icon" onclick="toggleAntiGravity()">
                <i class="fa-solid fa-feather icon-img" style="color: #80d8ff;"></i>
                <div class="icon-label">Anti-Gravidade.exe</div>
            </div>
            <div class="desktop-icon" onclick="openSalary()">
                <i class="fa-solid fa-calculator icon-img" style="color: #795548;"></i>
                <div class="icon-label">Calculadora de Salário Líquido</div>
            </div>
            <div class="desktop-icon" onclick="openExcuse()">
                <i class="fa-solid fa-face-rolling-eyes icon-img" style="color: #9c27b0;"></i>
                <div class="icon-label">Gerador de Desculpa para Atraso</div>
            </div>
            <div class="desktop-icon" onclick="openRetirement()">
                <i class="fa-solid fa-person-cane icon-img" style="color: #607d8b;"></i>
                <div class="icon-label">Planejamento de Aposentadoria.exe</div>
            </div>
            <div class="desktop-icon" onclick="openWeather()">
                <i class="fa-solid fa-fire icon-img" style="color: #ff5722;"></i>
                <div class="icon-label">Previsão do Tempo 2050</div>
            </div>
        </div>

        <!-- PHOTOS FOLDER WINDOW -->
        <div id="window-photos" class="os-window">
            <div class="os-header">
                <div class="os-titlebar">
                    <div class="os-title"><i class="fa-solid fa-folder-open" style="color:#ffce44;"></i> Fotos - Uberaba Site</div>
                    <div class="os-controls">
                        <button class="os-btn"><i class="fa-solid fa-minus"></i></button>
                        <button class="os-btn"><i class="fa-regular fa-square"></i></button>
                        <button class="os-btn close" onclick="closePhotos()"><i class="fa-solid fa-xmark"></i></button>
                    </div>
                </div>
            </div>
            <div class="os-body">
                <div class="photo-grid">
                    <div class="photo-item">
                        <div class="photo-frame"><img src="Museu.png" alt="Print 1"></div>
                        <div class="photo-name">PrintSiteMuseu</div>
                    </div>
                    <!-- Add more if needed -->
                </div>
            </div>
        </div>

        <!-- WINDOW TRASH -->
        <div id="window-trash" class="os-window">
            <div class="os-header">
                <div class="os-titlebar">
                    <div class="os-title"><i class="fa-solid fa-trash-can" style="color:#888;"></i> Lixeira</div>
                    <div class="os-controls">
                        <button class="os-btn"><i class="fa-solid fa-minus"></i></button>
                        <button class="os-btn"><i class="fa-regular fa-square"></i></button>
                        <button class="os-btn close" onclick="closeTrash()"><i class="fa-solid fa-xmark"></i></button>
                    </div>
                </div>
            </div>
            <div class="os-body">
                <div class="photo-grid" id="trash-content">
                    <!-- JS Injected -->
                </div>
            </div>
        </div>

        <!-- PRANK WINDOW (Recursion) -->
        <div id="window-prank" class="os-window">
            <div class="os-header">
                <div class="os-titlebar">
                    <div class="os-title"><i class="fa-solid fa-folder-closed" style="color:#ff3333;"></i> NÃO ABRA</div>
                    <div class="os-controls">
                        <button class="os-btn"><i class="fa-solid fa-minus"></i></button>
                        <button class="os-btn"><i class="fa-regular fa-square"></i></button>
                        <button class="os-btn close" onclick="closePrank()"><i class="fa-solid fa-xmark"></i></button>
                    </div>
                </div>
                <div class="os-address-bar">
                    <i class="fa-solid fa-folder" style="color: #ffce44;"></i>
                    <span id="prank-path-text">C:\Desktop\NÃO ABRA</span>
                </div>
            </div>
            <div class="os-body">
                <div class="bg-message-overlay" id="prank-bg-msg"></div>
                <div class="photo-grid" id="prank-content">
                    <!-- Content Injected by JS -->
                </div>
            </div>
        </div>

    </div>

    <!-- 5. VS CODE SCENE -->
    <div id="scene-vscode">
        <div class="vs-titlebar">
            <span id="vs-window-title">index.html - Visual Studio Code</span>
            <div class="vs-controls">
                <div class="vs-control"><i class="fa-solid fa-minus"></i></div>
                <div class="vs-control"><i class="fa-regular fa-square"></i></div>
                <div class="vs-control close"><i class="fa-solid fa-xmark"></i></div>
            </div>
        </div>

        <div class="vs-body">
            <!-- Sidebar -->
            <div class="vs-activitybar">
                <i class="fa-regular fa-file"></i>
                <i class="fa-solid fa-magnifying-glass"></i>
                <i class="fa-solid fa-code-branch"></i>
            </div>

            <div class="vs-sidebar">
                <div>EXPLORER</div>
                <div class="vs-file-tree">
                    <div style="font-weight: bold; margin-bottom: 5px;"><i class="fa-solid fa-angle-down"></i> PROJETO-UBERABA</div>
                    <div id="file-html" class="vs-file active"><i class="fa-brands fa-html5" style="color: #e65100"></i> index.html</div>
                    <div id="file-css" class="vs-file"><i class="fa-brands fa-css3" style="color: #42a5f5"></i> styles.css</div>
                    <div id="file-js" class="vs-file"><i class="fa-brands fa-js" style="color: #fdd835"></i> main.js</div>
                    <div class="vs-file"><i class="fa-solid fa-gear" style="color: #aaa"></i> config.json</div>
                    
                    <!-- Gemini File -->
                    <div class="gemini-file" id="gemini-tool">
                        <i class="fa-solid fa-wand-magic-sparkles gemini-icon-glow"></i> 
                        <span style="margin-left: 8px; font-weight: bold; font-size: 11px;">USAR GEMINI</span>
                    </div>
                </div>
            </div>

            <!-- Editor -->
            <div class="vs-editor-area">
                <div class="vs-code-panel">
                    <div class="vs-tabs">
                        <div class="vs-tab" id="active-tab">
                            <i class="fa-brands fa-html5" style="color: #e65100"></i> index.html 
                        </div>
                    </div>
                    <div class="vs-code-content" id="code-container">
                        <span class="typing-cursor"></span>
                    </div>
                    <div class="typing-hint" id="typing-hint"><i class="fa-regular fa-keyboard"></i> DIGITE QUALQUER TECLA PARA CODAR</div>
                </div>

                <!-- Preview -->
                <div class="vs-preview-panel" id="preview-container">
                    <!-- 3D Canvas Layer -->
                    <div id="scene-container">
                        <canvas id="canvas-preview"></canvas>
                    </div>

                    <!-- UI Overlay Layer -->
                    <main class="interface-layer">
                        <div class="brand-container">
                            <!-- Título com efeito de digitação -->
                            <h1 class="brand-title">
                                <span id="typewriter-text"></span><span class="cursor"></span>
                            </h1>
                            
                            <!-- Subtítulos -->
                            <div class="brand-meta">
                                <p id="sub-brand" class="alura-gemini-text">DA ALURA + GEMINI</p>
                                <p id="sub-proj" class="project-subtitle">PROJETO UBERABA</p>
                            </div>

                            <!-- Botão de Ação -->
                            <button id="cta-btn" class="primary-action">
                                ACESSAR SITE
                            </button>
                        </div>
                    </main>
                </div>
            </div>
        </div>
        <div style="height: 22px; background: #007acc; display: flex; align-items: center; padding: 0 10px; font-size: 12px; color: white; flex-shrink: 0;">
             <span id="status-bar-text">READY</span>
        </div>
    </div>

    <script>
        // ==========================================
        // TIME & UTILS
        // ==========================================
        function updateClock() {
            const now = new Date();
            const timeStr = now.toLocaleTimeString('pt-BR', {hour: '2-digit', minute:'2-digit'});
            const dateStr = now.toLocaleDateString('pt-BR', { weekday: 'long', day: 'numeric', month: 'long' });
            if(document.getElementById('clock-time')) {
                document.getElementById('clock-time').innerText = timeStr;
                document.getElementById('clock-date').innerText = dateStr;
            }
        }
        setInterval(updateClock, 1000);
        updateClock();

        // ==========================================
        // BOOT SEQUENCE
        // ==========================================
        const btnPower = document.getElementById('btn-power');
        
        btnPower.addEventListener('click', () => {
            btnPower.style.color = '#00ff00';
            btnPower.style.boxShadow = '0 0 30px #00ff00';
            document.querySelector('.power-msg').innerText = "INICIANDO SISTEMA...";
            
            setTimeout(() => {
                document.getElementById('scene-power').style.display = 'none';
                runBios();
            }, 1500);
        });

        function runBios() {
            const bios = document.getElementById('scene-bios');
            const text = document.getElementById('bios-text');
            bios.style.display = 'block';

            const lines = [
                "AMIBIOS(C)2025 American Megatrends, Inc.",
                "ASUS PRIME Z790-A ACPI BIOS Revision 1203",
                "CPU: Intel(R) Core(TM) i9-14900K CPU @ 6.00GHz",
                "Checking NVRAM..",
                "Initializing USB Controllers.. Done.",
                "Detecting Memory... <span class='bios-highlight'>64GB OK</span>",
                "Detecting Storage... <span class='bios-highlight'>NVMe M.2 2TB OK</span>",
                "Loading Windows Kernel...",
                "Booting..."
            ];

            let delay = 0;
            lines.forEach((line) => {
                setTimeout(() => {
                    text.innerHTML += `<div class="bios-line">${line}</div>`;
                    window.scrollTo(0, document.body.scrollHeight);
                }, delay);
                delay += 400; 
            });

            setTimeout(() => {
                bios.style.display = 'none';
                showLockScreen();
            }, 5000);
        }

        function showLockScreen() {
            const loginScene = document.getElementById('scene-login');
            const lockContent = document.getElementById('lock-screen-content');
            const loginForm = document.getElementById('login-form');
            
            loginScene.style.display = 'flex';
            
            setTimeout(() => {
                // Move clock out
                gsap.to(lockContent, { y: -200, opacity: 0, duration: 0.8 });
                
                // Show Login Form (Centered)
                loginForm.style.display = 'flex';
                
                // Animate using Scale/Opacity to preserve CSS Transform centering
                gsap.fromTo(loginForm, 
                    { opacity: 0, scale: 0.9 },
                    { opacity: 1, scale: 1, duration: 0.8, ease: "back.out(1.7)" }
                );
                
                const avatarDiv = document.querySelector('.user-avatar');
                const style = getComputedStyle(document.body);
                const bgImg = style.getPropertyValue('--user-avatar');
                if(bgImg && bgImg.includes('url') && bgImg.length > 10) {
                    avatarDiv.innerHTML = ''; 
                }

                setTimeout(() => {
                    const passInput = document.getElementById('pass-input');
                    const pass = "********";
                    let i = 0;
                    const typePass = setInterval(() => {
                        passInput.value += pass[i];
                        i++;
                        if(i >= pass.length) {
                            clearInterval(typePass);
                            setTimeout(() => {
                                const btn = document.querySelector('.login-btn');
                                btn.style.opacity = 1;
                                btn.style.transform = "scale(0.95)";
                                setTimeout(loadDesktop, 1500);
                            }, 500);
                        }
                    }, 300); 
                }, 1500);

            }, 2500);
        }

        function loadDesktop() {
            document.getElementById('scene-login').style.display = 'none';
            document.getElementById('scene-desktop').style.display = 'block';

            // SHOW PROGRAMMER ALERT MODAL FIRST
            setTimeout(() => {
                const progModal = document.getElementById('programmer-alert-modal');
                progModal.style.display = 'flex';
                gsap.to(progModal, { opacity: 1, scale: 1, duration: 0.5, ease: "back.out" });
            }, 1000);
        }

        // EVENT LISTENER TO CLOSE ALERT AND SHOW SYSTEM NOTIFICATION
        document.getElementById('btn-close-prog-alert').addEventListener('click', () => {
            const progModal = document.getElementById('programmer-alert-modal');
            
            // Hide Modal
            gsap.to(progModal, { opacity: 0, scale: 0.9, duration: 0.3, onComplete: () => {
                progModal.style.display = 'none';
                
                // NOW show the "System Ready" notification
                const notif = document.getElementById('win-notif');
                notif.style.right = '20px';
                setTimeout(() => {
                    notif.style.right = '-400px';
                }, 5000);
            }});
        });
        
        // ==========================================
        // ICON HANDLERS
        // ==========================================
        function showGenericError(msg) {
            const box = document.getElementById('win-error-box');
            const txt = document.getElementById('win-error-msg-text');
            txt.innerText = msg;
            box.style.display = 'flex';
        }

        function closeWinError() { document.getElementById('win-error-box').style.display = 'none'; }

        function openMusicFolder() { showGenericError("As músicas desta pasta ainda não foram lançadas."); }
        function openImagesFolder() { showGenericError("A NASA não liberou mostrar estas imagens ainda."); }
        function openCancerCure() { showGenericError("Em breve..."); }
        function wrongMyComputer() { showGenericError("É o MEU computador e não o SEU computador."); }
        
        function openBestTeam() {
            // Placeholder for Corinthians Image
            const imgUrl = "https://upload.wikimedia.org/wikipedia/pt/b/b4/Corinthians_simbolo.png";
            openFakeViewer("Melhor time do mundo.jpg", null, imgUrl);
        }

        function openResume() {
            const win = document.getElementById('chrome-window');
            win.style.display = 'flex';
            gsap.fromTo(win, {scale: 0.9, opacity: 0}, {scale: 1, opacity: 1, duration: 0.2});
        }
        function closeChrome() {
            document.getElementById('chrome-window').style.display = 'none';
        }

        function openArea51() {
            // Fake secret content
            const text = "RELATÓRIO CONFIDENCIAL:\nAliens existem e gostam de pão de queijo.\nO Chupacabra é real.\nElvis não morreu.";
            openFakeViewer("Segredos.txt", text, null);
        }

        function openBrowserHistory() {
            const history = `HISTÓRICO DE NAVEGAÇÃO (HOJE):\n\n- como saber se sou adotado sem perguntar pros pais\n- cirurgia plástica transplante de rosto preço\n- por que ninguém curte minhas fotos no instagram\n- tutorial de como deixar de ser trouxa 2025\n- teste de QI online (resultado: negativo)\n- meus pais preferem o cachorro a mim o que fazer\n- loja de perucas realistas baratas\n- como disfarçar calvície aos 20 anos`;
            openFakeViewer("History.log", history, null);
        }

        function openNASA() {
            // Opens a folder with a txt file - FIXED BACKGROUND
            const win = document.getElementById('generic-folder-window');
            const content = document.getElementById('generic-folder-content');
            const path = document.getElementById('generic-folder-path');
            const bgMsg = document.getElementById('generic-bg-msg');
            
            win.style.display = 'flex';
            path.innerText = "C:\\Desktop\\Senhas da NASA";
            bgMsg.innerText = ""; // Clear generic background
            content.innerHTML = `
                <div class="photo-item" onclick="openFakeViewer('senhas.txt', '123456\\nadmin\\nsenha123', null)">
                    <div class="photo-frame"><i class="fa-solid fa-file-lines" style="color: #aaa;"></i></div>
                    <div class="photo-name">senhas.txt</div>
                </div>
            `;
        }

        function openVirus() {
            // Visual Shake
            document.body.style.animation = "shake 0.5s infinite";
            // Simulate Alert
            setTimeout(() => {
                document.body.style.animation = "none";
                alert("Brincadeira. O verdadeiro vírus é você.");
            }, 2000);
        }

        // --- GTA 6 LOGIC ---
        function openGTA() {
            const win = document.getElementById('gta-window');
            const bar = document.getElementById('gta-progress');
            const status = document.getElementById('gta-status');
            win.style.display = 'flex';
            let progress = 0;
            
            const interval = setInterval(() => {
                progress += 0.5; // Slow
                bar.style.width = progress + '%';
                if(progress > 99) {
                    clearInterval(interval);
                    status.innerText = "Erro fatal.";
                    alert("Erro: Seu PC é muito fraco para tanta potência e você não está aqui para jogar.");
                    win.style.display = 'none';
                }
            }, 100);
            
            // Store interval ID to clear on close
            win.dataset.intervalId = interval;
        }
        function closeGta() {
            const win = document.getElementById('gta-window');
            clearInterval(win.dataset.intervalId);
            win.style.display = 'none';
        }

        // --- IQ TEST LOGIC ---
        let quizStep = 0;
        let score = 0;
        const quizQuestions = [
            { q: "Quanto é 1 + 1?", opts: ["11", "2", "3", "Janela"], a: "2" },
            { q: "Como chama o criador desse site?", opts: ["Elon Musk", "Bill Gates", "Pedro Henrique", "Ninguém sabe"], a: "Pedro Henrique" },
            { q: "Qual o melhor time do mundo?", opts: ["Real Madrid", "Barcelona", "Corinthians", "Flamengo"], a: "Corinthians" }
        ];

        function openIQTest() {
            const win = document.getElementById('quiz-window');
            win.style.display = 'flex';
            quizStep = 0;
            score = 0;
            renderQuizStart();
        }
        function closeQuiz() { document.getElementById('quiz-window').style.display = 'none'; }

        function renderQuizStart() {
            const body = document.getElementById('quiz-body');
            body.innerHTML = `
                <h3>Teste de QI Oficial</h3>
                <p style="margin: 15px 0;">Responda 3 perguntas para saber sua inteligência.</p>
                <p style="font-size: 11px; color: #666; margin-bottom: 20px;">
                    1 acerto: QI 10<br>2 acertos: QI 50<br>3 acertos: QI 180
                </p>
                <button class="win-err-btn" onclick="renderQuizQuestion()">COMEÇAR</button>
            `;
        }

        function renderQuizQuestion() {
            if(quizStep >= quizQuestions.length) {
                finishQuiz();
                return;
            }
            const q = quizQuestions[quizStep];
            const body = document.getElementById('quiz-body');
            let optsHTML = '';
            q.opts.forEach(opt => {
                optsHTML += `<button class="quiz-option" onclick="answerQuiz('${opt}')">${opt}</button>`;
            });
            body.innerHTML = `
                <h4>Pergunta ${quizStep + 1}</h4>
                <p style="margin: 10px 0;">${q.q}</p>
                <div style="width: 80%;">
                    ${optsHTML}
                </div>
            `;
        }

        function answerQuiz(ans) {
            if(ans === quizQuestions[quizStep].a) score++;
            quizStep++;
            renderQuizQuestion();
        }

        function finishQuiz() {
            let qi = 0;
            if(score === 1) qi = 10;
            if(score === 2) qi = 50;
            if(score === 3) qi = 180;
            
            const body = document.getElementById('quiz-body');
            body.innerHTML = `
                <h3>Resultado</h3>
                <p style="font-size: 40px; color: blue; margin: 20px 0;">QI: ${qi}</p>
                <p>Você acertou ${score} de 3.</p>
                <button class="win-err-btn" onclick="closeQuiz()">Fechar</button>
            `;
        }

        // --- PRANK FOLDER LOGIC (Ugly/Outros) ---
        function openUglyPerson() {
            openPrankFolderGeneric("Você");
            document.getElementById('generic-bg-msg').innerText = "VOCÊ";
        }
        function openPrankFolderGeneric(title) {
            const win = document.getElementById('generic-folder-window');
            const content = document.getElementById('generic-folder-content');
            const path = document.getElementById('generic-folder-path');
            const bgMsg = document.getElementById('generic-bg-msg');
            const titleBar = document.getElementById('generic-folder-title');
            
            win.style.display = 'flex';
            path.innerText = `C:\\Desktop\\${title}`;
            titleBar.innerHTML = `<i class="fa-solid fa-folder"></i> ${title}`;
            content.innerHTML = ''; // Empty folder by default
            bgMsg.innerText = "";
            
            if(title === "Outros") {
                generateGenericFiles(content);
            } else if (title === "Você") {
                bgMsg.innerText = "VOCÊ";
            }
        }

        function generateGenericFiles(container) {
            const numFiles = 5;
            const items = [
                'projeto_secreto.doc', 'plano_dominação.pdf', 'foto_comprometedora.jpg', 
                'ideia_milionaria.txt', 'backup_sistema.iso'
            ];
            
            items.forEach(item => {
                const div = document.createElement('div');
                div.className = 'photo-item';
                div.innerHTML = `<div class="photo-frame"><i class="fa-solid fa-file" style="color: #aaa;"></i></div><div class="photo-name">${item}</div>`;
                div.onclick = () => alert("Arquivo corrompido ou inexistente.");
                container.appendChild(div);
            });
        }

        // --- RECYCLE BIN ---
        function openTrash() {
            const win = document.getElementById('window-trash');
            const content = document.getElementById('trash-content');
            win.style.display = 'flex';
            content.innerHTML = '';
            
            const items = [
                'humanidade_backup.exe', 'alma_do_usuario.zip', 'minha_paciencia.txt',
                'vontade_de_viver.exe', 'amigos_de_verdade.list', 'plano_para_ficar_rico_v99.pdf',
                'minha_dieta_segunda_feira.lnk', 'dignidade.rar', 'Lixo1.webp', 'Lixo2.png'
            ];
            
            items.forEach(item => {
                const div = document.createElement('div');
                div.className = 'photo-item';
                // Check if image extension for icon logic, else generic file
                let icon = 'fa-file';
                let color = '#aaa';
                if(item.endsWith('.exe')) { icon = 'fa-gears'; color = '#0078d7'; }
                if(item.endsWith('.zip') || item.endsWith('.rar')) { icon = 'fa-file-zipper'; color = '#e65100'; }
                
                div.innerHTML = `<div class="photo-frame"><i class="fa-solid ${icon}" style="color:${color};"></i></div><div class="photo-name">${item}</div>`;
                content.appendChild(div);
            });
        }
        function closeTrash() { document.getElementById('window-trash').style.display = 'none'; }

        // --- LOVE LIST ---
        function openLoveList() {
            const win = document.getElementById('love-window');
            win.style.display = 'flex';
        }

        // --- PATIENCE TEST ---
        function openPatienceTest() {
            const win = document.getElementById('patience-window');
            win.style.display = 'flex';
            
            const btn = document.getElementById('run-btn');
            btn.addEventListener('mouseover', () => {
                const x = Math.random() * 80;
                const y = Math.random() * 80;
                btn.style.top = y + '%';
                btn.style.left = x + '%';
            });
        }

        // --- GRAVITY CRASH (FALLING) ---
        function triggerGravityCrash() {
            const icons = document.querySelectorAll('.desktop-icon');
            icons.forEach(icon => {
                const rect = icon.getBoundingClientRect();
                const dist = window.innerHeight - rect.bottom;
                
                icon.classList.add('falling');
                // Random rotation and falling to bottom
                const rotate = Math.random() * 60 - 30;
                icon.style.transform = `translateY(${dist}px) rotate(${rotate}deg)`;
            });
        }

        // --- INTERNET DOWNLOAD ---
        function downloadInternet() {
            document.getElementById('internet-window').style.display = 'flex';
            // Progress bar barely moves
            const bar = document.getElementById('internet-progress');
            setTimeout(() => { bar.style.width = "1%"; }, 100);
        }

        // --- TOGGLE SUN (FLASHLIGHT) ---
        let sunOn = true;
        function toggleSun() {
            const overlay = document.getElementById('darkness-overlay');
            const label = document.getElementById('sun-label');
            
            sunOn = !sunOn;
            
            if(!sunOn) {
                // Turn OFF (Dark)
                overlay.style.opacity = 1;
                overlay.classList.add('active');
                label.innerText = "Ligar o sol";
                document.addEventListener('mousemove', updateFlashlight);
            } else {
                // Turn ON (Normal)
                overlay.style.opacity = 0;
                overlay.classList.remove('active');
                label.innerText = "Desligar o sol";
                document.removeEventListener('mousemove', updateFlashlight);
            }
        }

        function updateFlashlight(e) {
            const overlay = document.getElementById('darkness-overlay');
            if(overlay.classList.contains('active')) {
                overlay.style.setProperty('--x', e.clientX + 'px');
                overlay.style.setProperty('--y', e.clientY + 'px');
            }
        }

        // --- RESOLVE LIFE ---
        function resolveLife() {
            document.getElementById('life-window').style.display = 'flex';
            const bar = document.getElementById('life-progress');
            const status = document.getElementById('life-status');
            
            bar.style.transition = "width 2s ease-out";
            
            // Reset
            bar.style.width = "0%";
            status.innerText = "Resolvendo problemas...";
            
            setTimeout(() => {
                bar.style.width = "99%";
                setTimeout(() => {
                    status.innerText = "Aguardando milagre...";
                }, 2000);
            }, 100);
        }

        // --- COACH QUANTICO ---
        const coachPhrases = [
            "Para subir a escada do sucesso, você precisa descer a rampa da gratidão.",
            "O universo não conspira contra você, ele apenas ignora sua existência.",
            "Seja o CEO da sua própria confusão mental.",
            "Vibre na frequência do boleto pago.",
            "O mindset de crescimento começa quando você para de reclamar do Wi-Fi.",
            "Ressignifique o seu fracasso como um 'sucesso não linear'.",
            "A abundância vem quando você aceita que o pouco é muito.",
            "Destrave seu potencial quântico bebendo água com limão.",
            "O óbvio só é óbvio para o olho que vê o invisível.",
            "Sua aura está desalinhada com o algoritmo da vida.",
            "A meritocracia do universo é baseada em hashtags.",
            "Não busque a luz no fim do túnel, seja o próprio trem.",
            "Gratidão gera dívida emocional positiva.",
            "Se você não sabe para onde ir, qualquer caminho é um erro.",
            "Abraça a sua sombra, mas não esqueça o protetor solar."
        ];
        function openCoach() {
            document.getElementById('coach-window').style.display = 'flex';
        }
        function generateWisdom() {
            const phrase = coachPhrases[Math.floor(Math.random() * coachPhrases.length)];
            document.getElementById('coach-text').innerText = `"${phrase}"`;
        }

        // --- MONEY GENERATOR ---
        function openMoneyGen() {
            const win = document.getElementById('money-window');
            const content = document.getElementById('money-content');
            win.style.display = 'flex';
            content.innerHTML = "";
            
            // Start Matrix Effect
            const interval = setInterval(() => {
                const hex = Math.random().toString(16).substr(2, 8).toUpperCase();
                content.innerHTML += `<span class="matrix-text">${hex} ${hex} ${hex} ${hex}</span><br>`;
                content.scrollTop = content.scrollHeight;
            }, 50);

            win.dataset.matrixId = interval;

            // Trigger Police after 3 seconds
            setTimeout(() => {
                clearInterval(interval);
                content.innerHTML += "<br><span style='color:red; font-weight:bold;'>ALERTA: POLÍCIA FEDERAL RASTREANDO SEU IP...</span><br>";
                content.innerHTML += "<span style='color:red; font-weight:bold;'>VIATURAS A CAMINHO.</span>";
                // Play Sound
                const audio = document.getElementById('siren-sound');
                if(audio) audio.play();
            }, 3000);
        }
        function closeMoney() {
            const win = document.getElementById('money-window');
            clearInterval(win.dataset.matrixId);
            win.style.display = 'none';
            const audio = document.getElementById('siren-sound');
            if(audio) { audio.pause(); audio.currentTime = 0; }
        }

        // --- DOMINATION PLAN ---
        let dominationAttempts = 0;
        function openDomination() {
            const icon = document.getElementById('icon-domination');
            if(icon.style.display === 'none') return; // Already exploded
            document.getElementById('domination-window').style.display = 'flex';
            document.getElementById('domination-pass').value = '';
        }
        function checkDominationPass() {
            dominationAttempts++;
            const input = document.getElementById('domination-pass');
            
            if(dominationAttempts === 1) {
                alert("ACESSO NEGADO!");
                input.value = '';
            } else {
                // EXPLODE
                document.getElementById('domination-window').style.display = 'none';
                const icon = document.getElementById('icon-domination');
                icon.innerHTML = '<img src="https://media.giphy.com/media/OE6C7m78p9M64/giphy.gif" style="width:100px;">'; // Placeholder explosion
                setTimeout(() => {
                    icon.style.display = 'none';
                }, 1500);
            }
        }

        // --- UNINSTALL WINDOW ---
        function openUninstall() {
            document.getElementById('uninstall-window').style.display = 'flex';
            const bar = document.getElementById('uninstall-bar');
            let width = 0;
            const interval = setInterval(() => {
                width += 2;
                bar.style.width = width + '%';
                if(width >= 100) {
                    clearInterval(interval);
                    // White Screen
                    const overlay = document.getElementById('white-screen-overlay');
                    const msg = document.getElementById('white-screen-msg');
                    overlay.style.display = 'flex';
                    setTimeout(() => {
                        msg.style.opacity = 1;
                        setTimeout(() => {
                            overlay.style.display = 'none';
                            document.getElementById('uninstall-window').style.display = 'none';
                            msg.style.opacity = 0;
                        }, 2000);
                    }, 3000);
                }
            }, 50);
        }

        // --- ANTI GRAVITY ---
        let antiGravityOn = false;
        function toggleAntiGravity() {
            antiGravityOn = !antiGravityOn;
            const icons = document.querySelectorAll('.desktop-icon');
            icons.forEach(icon => {
                if(antiGravityOn) {
                    icon.classList.add('anti-gravity-active');
                } else {
                    icon.classList.remove('anti-gravity-active');
                }
            });
        }

        // --- SALARY CALCULATOR ---
        function openSalary() {
            document.getElementById('salary-window').style.display = 'flex';
            document.getElementById('salary-result').style.display = 'none';
        }
        function calcSalary() {
            document.getElementById('salary-result').style.display = 'block';
        }

        // --- EXCUSE GENERATOR ---
        const excuses = [
            "Meu cachorro comeu a chave do carro.",
            "Fui abduzido, mas me devolveram porque sou chato.",
            "O pneu do trem furou.",
            "Esqueci como se anda.",
            "Meu horóscopo disse para eu não sair de casa hoje.",
            "Fiquei preso no looping temporal de 2020.",
            "A gravidade estava muito forte na minha cama hoje.",
            "Confundi AM com PM.",
            "Meu peixe dourado estava se afogando.",
            "Estava esperando o download do meu ânimo terminar."
        ];
        function openExcuse() {
            document.getElementById('excuse-window').style.display = 'flex';
        }
        function generateExcuse() {
            const ex = excuses[Math.floor(Math.random() * excuses.length)];
            document.getElementById('excuse-text').innerText = `"${ex}"`;
        }

        // --- RETIREMENT ---
        function openRetirement() {
            document.getElementById('retirement-window').style.display = 'flex';
            const bar = document.getElementById('retire-bar');
            const status = document.getElementById('retire-status');
            bar.style.width = '0%';
            status.innerText = "Calculando...";
            
            setTimeout(() => {
                bar.style.width = '100%';
                setTimeout(() => {
                    alert("Erro: Aposentadoria não disponível na sua geração. Trabalhe até morrer.");
                    document.getElementById('retirement-window').style.display = 'none';
                }, 500);
            }, 1500);
        }

        // --- WEATHER 2050 ---
        function openWeather() {
            document.getElementById('weather-window').style.display = 'flex';
        }

        // ==========================================
        // PRANK LOGIC ("NÃO ABRA") - MODIFIED
        // ==========================================
        let prankLevel = 0;
        const prankWindow = document.getElementById('window-prank');
        const prankContent = document.getElementById('prank-content');
        const prankPath = document.getElementById('prank-path-text');
        const termModal = document.getElementById('prank-term-modal');
        const palmeirasOverlay = document.getElementById('palmeiras-overlay');
        const fakeViewer = document.getElementById('fake-viewer-modal');

        // Level Names Array
        const prankFolderNames = [
            "NÃO ABRA", "Eu te avisei", "Não insista", "Pare agora", "Volte enquanto pode", 
            "Sistema Instável", "Arquivos Corrompidos", "PERIGO REAL", "Vírus Detectado", 
            "Segredos de Estado", "Área 51", "Dados Proibidos", "A Curiosidade Mata", 
            "Sem Volta", "O Abismo", "Não olhe para trás", "Risco Biológico", 
            "Erro Crítico", "Falha na Matrix", "A Verdade", "Última Chance", "O Fim"
        ];

        function openPrankFolder() {
            prankLevel = 0;
            document.getElementById('prank-bg-msg').innerText = ""; // Clear any BG msg
            prankWindow.style.display = 'flex';
            gsap.fromTo(prankWindow, {scale: 0.9, opacity: 0}, {scale: 1, opacity: 1, duration: 0.2, ease: "power2.out"});
            renderPrankLevel(0);
        }

        function closePrank() {
            gsap.to(prankWindow, {scale: 0.9, opacity: 0, duration: 0.15, onComplete: () => {
                prankWindow.style.display = 'none';
                prankLevel = 0;
            }});
        }

        // Document Term Logic
        const termNameInput = document.getElementById('term-name');
        const acceptBtn = document.getElementById('btn-accept-term');

        termNameInput.addEventListener('input', () => {
            if (termNameInput.value.length > 2) {
                acceptBtn.classList.add('active');
            } else {
                acceptBtn.classList.remove('active');
            }
        });

        function closeTerm() {
            termModal.style.display = 'none';
            termNameInput.value = '';
            acceptBtn.classList.remove('active');
            closePrank(); // Go back closes folder
        }

        function acceptTerm() {
            termModal.style.display = 'none';
            prankLevel++; // Advance past warning
            renderPrankLevel(prankLevel);
        }

        function renderPrankLevel(level) {
            prankContent.innerHTML = '';
            
            // Path Logic
            let pathString = 'C:\\Desktop';
            for(let i=0; i<=level; i++) {
                if (i < prankFolderNames.length) pathString += `\\${prankFolderNames[i]}`;
            }
            if(pathString.length > 60) pathString = '...' + pathString.slice(-50);
            prankPath.innerText = pathString;

            // --- LEVEL SPECIFIC LOGIC ---

            // Level 0: Initial Open -> Trigger Term
            if (level === 0) {
                termModal.style.display = 'flex';
                return;
            }

            // Level 21: The End (Palmeiras) - The ONLY place with an image
            if (level >= 21) {
                const file = document.createElement('div');
                file.className = 'photo-item';
                file.innerHTML = `<div class="photo-frame"><i class="fa-solid fa-file-image" style="color: #00ff00;"></i></div><div class="photo-name">A_VERDADE.jpg</div>`;
                file.onclick = triggerFinalPrank;
                prankContent.appendChild(file);
                return;
            }

            // --- CONTENT GENERATION FOR LEVELS 1-20 (NO IMAGES) ---
            
            // 1. The Next Folder
            const nextFolderName = prankFolderNames[level + 1] || "FIM";
            const folder = document.createElement('div');
            folder.className = 'photo-item';
            // Make folder look redder as levels go up
            const folderColor = level > 10 ? '#ff0000' : '#ffce44';
            folder.innerHTML = `<div class="photo-frame"><i class="fa-solid fa-folder" style="color: ${folderColor};"></i></div><div class="photo-name">${nextFolderName}</div>`;
            folder.onclick = () => {
                prankLevel++;
                renderPrankLevel(prankLevel);
            };
            prankContent.appendChild(folder);

            // 2. Generate Random "Easter Egg" Files (Filtered to NO IMAGES)
            generateLevelContent(level);
        }

        function generateLevelContent(level) {
            // Number of random files increases with level
            const numFiles = Math.min(Math.floor(Math.random() * 3) + 2 + Math.floor(level/3), 8);
            
            // Removed Image Type
            const fileTypes = [
                { icon: 'fa-file-lines', color: '#aaa', ext: '.txt', type: 'text' },
                { icon: 'fa-gear', color: '#888', ext: '.sys', type: 'sys' },
                { icon: 'fa-triangle-exclamation', color: '#ff3333', ext: '.log', type: 'error' }
            ];

            const weirdNames = ['não_leia', 'segredo', 'corrompido', 'quem_é_vc', 'olhe_trás', 'ajuda', 'senha_banco', 'projeto_x', 'evidencia', 'void'];

            for(let i=0; i<numFiles; i++) {
                const fType = fileTypes[Math.floor(Math.random() * fileTypes.length)];
                const fName = weirdNames[Math.floor(Math.random() * weirdNames.length)] + `_${Math.floor(Math.random()*99)}` + fType.ext;
                
                const fileItem = document.createElement('div');
                fileItem.className = 'photo-item';
                fileItem.innerHTML = `<div class="photo-frame"><i class="fa-solid ${fType.icon}" style="color: ${fType.color};"></i></div><div class="photo-name">${fName}</div>`;
                
                fileItem.onclick = () => handlePrankFileClick(fType.type, fName);
                prankContent.appendChild(fileItem);
            }
        }

        function handlePrankFileClick(type, name) {
            if (type === 'text') {
                const texts = [
                    "POR QUE VOCÊ CONTINUA ABRINDO?",
                    "Eles estão observando...",
                    "Não existe saída.",
                    "Você assinou o termo. Não há volta.",
                    "01001000 01000101 01001100 01010000",
                    "Olhe para trás."
                ];
                openFakeViewer("Bloco de Notas", texts[Math.floor(Math.random() * texts.length)], null);
            } 
            else if (type === 'sys' || type === 'error') {
                // Fake error popup
                const box = document.getElementById('win-error-box');
                const msg = document.getElementById('win-error-msg-text');
                const msgs = [
                    "Erro Fatal: Curiosidade excessiva detectada.",
                    "System32 corrompido. Iniciando autodestruição em 3...",
                    "Acesso negado pela Agência Nacional de Segurança.",
                    "Vírus 'TROJAN_HORSE' instalado com sucesso.",
                    "Sua webcam foi ativada remotamente."
                ];
                msg.innerText = msgs[Math.floor(Math.random() * msgs.length)];
                box.style.display = 'flex';
                
                // Shake screen effect
                document.body.style.animation = "shake 0.5s";
                setTimeout(() => document.body.style.animation = "none", 500);
            }
        }

        function openFakeViewer(title, text, img) {
            fakeViewer.style.display = 'flex';
            document.getElementById('viewer-title').innerText = title;
            const body = document.getElementById('viewer-body');
            body.innerHTML = '';
            
            if (text) {
                body.innerText = text;
                body.style.background = "#fff";
                body.style.color = "#000";
                body.style.display = "block";
            }
            if (img) {
                body.style.background = "#000";
                body.style.display = "flex";
                body.style.justifyContent = "center";
                body.innerHTML = `<img src="${img}" class="viewer-image">`;
            }
        }

        function closeViewer() {
            fakeViewer.style.display = 'none';
        }

        function closePhotos() {
            document.getElementById('window-photos').style.display = 'none';
        }

        function triggerFinalPrank() {
            palmeirasOverlay.style.display = 'flex';
            palmeirasOverlay.style.animation = "shake 0.5s infinite";
            
            setTimeout(() => {
                palmeirasOverlay.style.animation = "none";
                palmeirasOverlay.onclick = () => {
                    palmeirasOverlay.style.display = 'none';
                    closePrank();
                }
            }, 5000);
        }


        // ==========================================
        // VS CODE LAUNCH
        // ==========================================
        document.getElementById('icon-vscode').addEventListener('dblclick', openVSCode);
        document.getElementById('icon-vscode').addEventListener('click', openVSCode);

        function openVSCode() {
            const vs = document.getElementById('scene-vscode');
            vs.style.display = 'flex';

            const isMobile = window.innerWidth < 768;

            gsap.to(vs, { 
                scale: isMobile ? 1 : 1, // Ensure full scale on mobile too
                opacity: 1, 
                duration: 1.5, 
                ease: "expo.out",
                onComplete: () => {
                    state.isCoding = true;
                    initGeminiPreview(); 
                    if (isMobile) {
                        // Auto run code on mobile
                        startMobileAutoTyping();
                    }
                }
            });
        }

        // ==========================================
        // HACKER TYPER LOGIC
        // ==========================================
        const state = { isCoding: false, index: 0, errorStage: false, fixed: false, accessGranted: false, previewVisible: false };
        const container = document.getElementById('code-container');

        // UPDATED CODE SNIPPETS (ESCAPED FOR JS STRINGS)
        const htmlCode = `
<span class="k-tag">&lt;!DOCTYPE html&gt;</span>
<span class="k-tag">&lt;html</span> <span class="k-attr">lang</span>=<span class="k-str">"pt-br"</span><span class="k-tag">&gt;</span>
<span class="k-tag">&lt;head&gt;</span>
    <span class="k-tag">&lt;meta</span> <span class="k-attr">charset</span>=<span class="k-str">"UTF-8"</span><span class="k-tag">&gt;</span>
    <span class="k-tag">&lt;meta</span> <span class="k-attr">name</span>=<span class="k-str">"viewport"</span> <span class="k-attr">content</span>=<span class="k-str">"width=device-width, initial-scale=1.0"</span><span class="k-tag">&gt;</span>
    <span class="k-tag">&lt;title&gt;</span>Uberaba Experience | Immersive Core<span class="k-tag">&lt;/title&gt;</span>
    
    <span class="k-comment">&lt;!-- Fonts --&gt;</span>
    <span class="k-tag">&lt;link</span> <span class="k-attr">rel</span>=<span class="k-str">"preconnect"</span> <span class="k-attr">href</span>=<span class="k-str">"https://fonts.googleapis.com"</span><span class="k-tag">&gt;</span>
    <span class="k-tag">&lt;link</span> <span class="k-attr">rel</span>=<span class="k-str">"preconnect"</span> <span class="k-attr">href</span>=<span class="k-str">"https://fonts.gstatic.com"</span> <span class="k-attr">crossorigin</span><span class="k-tag">&gt;</span>
    <span class="k-tag">&lt;link</span> <span class="k-attr">href</span>=<span class="k-str">"https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;800&display=swap"</span> <span class="k-attr">rel</span>=<span class="k-str">"stylesheet"</span><span class="k-tag">&gt;</span>
    
    <span class="k-comment">&lt;!-- Styles --&gt;</span>
    <span class="k-tag">&lt;link</span> <span class="k-attr">rel</span>=<span class="k-str">"stylesheet"</span> <span class="k-attr">href</span>=<span class="k-str">"style.css"</span><span class="k-tag">&gt;</span>

    <span class="k-comment">&lt;!-- Libraries --&gt;</span>
    <span class="k-tag">&lt;script</span> <span class="k-attr">src</span>=<span class="k-str">"https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"</span><span class="k-tag">&gt;</span><span class="k-tag">&lt;/script&gt;</span>
    <span class="k-tag">&lt;script</span> <span class="k-attr">src</span>=<span class="k-str">"https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"</span><span class="k-tag">&gt;</span><span class="k-tag">&lt;/script&gt;</span>
<span class="k-tag">&lt;/head&gt;</span>
<span class="k-tag">&lt;body&gt;</span>

    <span class="k-comment">&lt;!-- 3D Canvas Layer --&gt;</span>
    <span class="k-tag">&lt;div</span> <span class="k-attr">id</span>=<span class="k-str">"scene-container"</span><span class="k-tag">&gt;</span>
        <span class="k-tag">&lt;canvas</span> <span class="k-attr">id</span>=<span class="k-str">"canvas-preview"</span><span class="k-tag">&gt;</span><span class="k-tag">&lt;/canvas&gt;</span>
    <span class="k-tag">&lt;/div&gt;</span>

    <span class="k-comment">&lt;!-- UI Overlay Layer --&gt;</span>
    <span class="k-tag">&lt;main</span> <span class="k-attr">class</span>=<span class="k-str">"interface-layer"</span><span class="k-tag">&gt;</span>
        <span class="k-tag">&lt;div</span> <span class="k-attr">class</span>=<span class="k-str">"brand-container"</span><span class="k-tag">&gt;</span>
            <span class="k-comment">&lt;!-- Título com efeito de digitação --&gt;</span>
            <span class="k-tag">&lt;h1</span> <span class="k-attr">class</span>=<span class="k-str">"brand-title"</span><span class="k-tag">&gt;</span>
                <span class="k-tag">&lt;span</span> <span class="k-attr">id</span>=<span class="k-str">"typewriter-text"</span><span class="k-tag">&gt;</span><span class="k-tag">&lt;/span&gt;</span><span class="k-tag">&lt;span</span> <span class="k-attr">class</span>=<span class="k-str">"cursor"</span><span class="k-tag">&gt;</span><span class="k-tag">&lt;/span&gt;</span>
            <span class="k-tag">&lt;/h1&gt;</span>
            
            <span class="k-comment">&lt;!-- Subtítulos --&gt;</span>
            <span class="k-tag">&lt;div</span> <span class="k-attr">class</span>=<span class="k-str">"brand-meta"</span><span class="k-tag">&gt;</span>
                <span class="k-tag">&lt;p</span> <span class="k-attr">id</span>=<span class="k-str">"sub-brand"</span> <span class="k-attr">class</span>=<span class="k-str">"alura-gemini-text"</span><span class="k-tag">&gt;</span>DA ALURA + GEMINI<span class="k-tag">&lt;/p&gt;</span>
                <span class="k-tag">&lt;p</span> <span class="k-attr">id</span>=<span class="k-str">"sub-proj"</span> <span class="k-attr">class</span>=<span class="k-str">"project-subtitle"</span><span class="k-tag">&gt;</span>PROJETO UBERABA<span class="k-tag">&lt;/p&gt;</span>
            <span class="k-tag">&lt;/div&gt;</span>

            <span class="k-comment">&lt;!-- Botão de Ação --&gt;</span>
            <span class="k-tag">&lt;button</span> <span class="k-attr">id</span>=<span class="k-str">"cta-btn"</span> <span class="k-attr">class</span>=<span class="k-str">"primary-action"</span><span class="k-tag">&gt;</span>
                ACESSAR SITE
            <span class="k-tag">&lt;/button&gt;</span>
        <span class="k-tag">&lt;/div&gt;</span>
    <span class="k-tag">&lt;/main&gt;</span>

    <span class="k-comment">&lt;!-- Logic --&gt;</span>
    <span class="k-tag">&lt;script</span> <span class="k-attr">src</span>=<span class="k-str">"script.js"</span><span class="k-tag">&gt;</span><span class="k-tag">&lt;/script&gt;</span>
<span class="k-tag">&lt;/body&gt;</span>
<span class="k-tag">&lt;/html&gt;</span>`;

        const cssCode = `
<span class="k-tag">:root</span> {
    <span class="k-var">--bg-space</span>: <span class="k-str">#050505</span>;
    <span class="k-var">--accent-gold</span>: <span class="k-str">#D4AF37</span>;
    <span class="k-var">--text-primary</span>: <span class="k-str">#ffffff</span>;
    <span class="k-var">--gemini-grad-start</span>: <span class="k-str">#4b90ff</span>;
    <span class="k-var">--gemini-grad-end</span>: <span class="k-str">#ff5546</span>;
    <span class="k-var">--font-display</span>: <span class="k-str">'Inter', sans-serif</span>;
}

<span class="k-tag">*</span> {
    <span class="k-attr">margin</span>: <span class="k-str">0</span>;
    <span class="k-attr">padding</span>: <span class="k-str">0</span>;
    <span class="k-attr">box-sizing</span>: <span class="k-str">border-box</span>;
}

<span class="k-tag">body</span> {
    <span class="k-attr">background-color</span>: <span class="k-var">var(--bg-space)</span>;
    <span class="k-attr">color</span>: <span class="k-var">var(--text-primary)</span>;
    <span class="k-attr">font-family</span>: <span class="k-var">var(--font-display)</span>;
    <span class="k-attr">overflow</span>: <span class="k-str">hidden</span>;
    <span class="k-attr">height</span>: <span class="k-str">100vh</span>;
    <span class="k-attr">width</span>: <span class="k-str">100vw</span>;
    <span class="k-attr">display</span>: <span class="k-str">flex</span>;
    <span class="k-attr">justify-content</span>: <span class="k-str">center</span>;
    <span class="k-attr">align-items</span>: <span class="k-str">center</span>;
}

<span class="k-comment">/* --- 3D Scene Container --- */</span>
<span class="k-tag">#scene-container</span> {
    <span class="k-attr">position</span>: <span class="k-str">absolute</span>;
    <span class="k-attr">inset</span>: <span class="k-str">0</span>;
    <span class="k-attr">z-index</span>: <span class="k-str">1</span>;
    <span class="k-attr">background</span>: <span class="k-func">radial-gradient</span>(<span class="k-str">circle at center</span>, <span class="k-str">#111 0%</span>, <span class="k-str">#000 100%</span>);
}

<span class="k-tag">canvas</span> {
    <span class="k-attr">display</span>: <span class="k-str">block</span>;
    <span class="k-attr">width</span>: <span class="k-str">100%</span>;
    <span class="k-attr">height</span>: <span class="k-str">100%</span>;
    <span class="k-attr">outline</span>: <span class="k-str">none</span>;
}

<span class="k-comment">/* --- Interface Overlay --- */</span>
<span class="k-tag">.interface-layer</span> {
    <span class="k-attr">position</span>: <span class="k-str">absolute</span>;
    <span class="k-attr">inset</span>: <span class="k-str">0</span>;
    <span class="k-attr">z-index</span>: <span class="k-str">10</span>;
    <span class="k-attr">display</span>: <span class="k-str">flex</span>;
    <span class="k-attr">flex-direction</span>: <span class="k-str">column</span>;
    <span class="k-attr">justify-content</span>: <span class="k-str">center</span>;
    <span class="k-attr">align-items</span>: <span class="k-str">center</span>;
    <span class="k-attr">pointer-events</span>: <span class="k-str">none</span>;
}

<span class="k-tag">.brand-container</span> {
    <span class="k-attr">text-align</span>: <span class="k-str">center</span>;
    <span class="k-attr">pointer-events</span>: <span class="k-str">auto</span>;
    <span class="k-attr">display</span>: <span class="k-str">flex</span>;
    <span class="k-attr">flex-direction</span>: <span class="k-str">column</span>;
    <span class="k-attr">align-items</span>: <span class="k-str">center</span>;
}

<span class="k-comment">/* --- Typography --- */</span>
<span class="k-tag">.brand-title</span> {
    <span class="k-attr">font-size</span>: <span class="k-str">3.5rem</span>;
    <span class="k-attr">font-weight</span>: <span class="k-str">800</span>;
    <span class="k-attr">color</span>: <span class="k-str">white</span>;
    <span class="k-attr">text-align</span>: <span class="k-str">center</span>;
    <span class="k-attr">text-shadow</span>: <span class="k-str">0 0 30px rgba(255, 255, 255, 0.3)</span>;
    <span class="k-attr">line-height</span>: <span class="k-str">1.1</span>;
    <span class="k-attr">margin-bottom</span>: <span class="k-str">10px</span>;
}

<span class="k-tag">.cursor</span> {
    <span class="k-attr">display</span>: <span class="k-str">inline-block</span>;
    <span class="k-attr">width</span>: <span class="k-str">4px</span>;
    <span class="k-attr">height</span>: <span class="k-str">1em</span>;
    <span class="k-attr">background-color</span>: <span class="k-str">#fff</span>;
    <span class="k-attr">vertical-align</span>: <span class="k-str">bottom</span>;
    <span class="k-attr">animation</span>: <span class="k-str">blink 1s step-end infinite</span>;
    <span class="k-attr">margin-left</span>: <span class="k-str">5px</span>;
}

<span class="k-tag">.brand-meta</span> {
    <span class="k-attr">margin-top</span>: <span class="k-str">15px</span>;
    <span class="k-attr">display</span>: <span class="k-str">flex</span>;
    <span class="k-attr">flex-direction</span>: <span class="k-str">column</span>;
    <span class="k-attr">align-items</span>: <span class="k-str">center</span>;
    <span class="k-attr">gap</span>: <span class="k-str">5px</span>;
}

<span class="k-tag">.alura-gemini-text</span> {
    <span class="k-attr">font-weight</span>: <span class="k-str">700</span>;
    <span class="k-attr">font-size</span>: <span class="k-str">0.9rem</span>;
    <span class="k-attr">letter-spacing</span>: <span class="k-str">2px</span>;
    <span class="k-attr">background</span>: <span class="k-func">linear-gradient</span>(<span class="k-str">to right</span>, <span class="k-str">#ffffff</span>, <span class="k-str">#4b90ff</span>);
    <span class="k-attr">-webkit-background-clip</span>: <span class="k-str">text</span>;
    <span class="k-attr">background-clip</span>: <span class="k-str">text</span>;
    <span class="k-attr">color</span>: <span class="k-str">transparent</span>;
    <span class="k-attr">opacity</span>: <span class="k-str">0</span>;
    <span class="k-attr">transform</span>: <span class="k-func">translateY</span>(<span class="k-str">20px</span>);
}

<span class="k-tag">.project-subtitle</span> {
    <span class="k-attr">font-size</span>: <span class="k-str">1rem</span>;
    <span class="k-attr">letter-spacing</span>: <span class="k-str">4px</span>;
    <span class="k-attr">color</span>: <span class="k-str">#888</span>;
    <span class="k-attr">text-transform</span>: <span class="k-str">uppercase</span>;
    <span class="k-attr">font-weight</span>: <span class="k-str">300</span>;
    <span class="k-attr">opacity</span>: <span class="k-str">0</span>;
    <span class="k-attr">transform</span>: <span class="k-func">translateY</span>(<span class="k-str">20px</span>);
}

<span class="k-comment">/* --- Button --- */</span>
<span class="k-tag">.primary-action</span> {
    <span class="k-attr">margin-top</span>: <span class="k-str">50px</span>;
    <span class="k-attr">padding</span>: <span class="k-str">15px 40px</span>;
    <span class="k-attr">background</span>: <span class="k-str">transparent</span>;
    <span class="k-attr">border</span>: <span class="k-str">1px solid rgba(255, 255, 255, 0.3)</span>;
    <span class="k-attr">color</span>: <span class="k-str">white</span>;
    <span class="k-attr">border-radius</span>: <span class="k-str">50px</span>;
    <span class="k-attr">font-size</span>: <span class="k-str">0.9rem</span>;
    <span class="k-attr">cursor</span>: <span class="k-str">pointer</span>;
    <span class="k-attr">transition</span>: <span class="k-str">all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1)</span>;
    <span class="k-attr">font-weight</span>: <span class="k-str">600</span>;
    <span class="k-attr">letter-spacing</span>: <span class="k-str">2px</span>;
    <span class="k-attr">opacity</span>: <span class="k-str">0</span>;
    <span class="k-attr">transform</span>: <span class="k-func">translateY</span>(<span class="k-str">20px</span>);
    <span class="k-attr">font-family</span>: <span class="k-var">var(--font-display)</span>;
}

<span class="k-tag">.primary-action:hover</span> {
    <span class="k-attr">background</span>: <span class="k-str">white</span>;
    <span class="k-attr">color</span>: <span class="k-str">black</span>;
    <span class="k-attr">box-shadow</span>: <span class="k-str">0 0 30px rgba(255, 255, 255, 0.5)</span>;
    <span class="k-attr">transform</span>: <span class="k-func">translateY</span>(<span class="k-str">20px</span>) <span class="k-func">scale</span>(<span class="k-str">1.05</span>);
}

<span class="k-tag">.primary-action:active</span> {
    <span class="k-attr">transform</span>: <span class="k-func">translateY</span>(<span class="k-str">20px</span>) <span class="k-func">scale</span>(<span class="k-str">0.95</span>);
}

<span class="k-comment">/* --- Animations --- */</span>
<span class="k-tag">@keyframes</span> <span class="k-def">blink</span> {
    <span class="k-str">0%, 100%</span> { <span class="k-attr">opacity</span>: <span class="k-str">1</span>; }
    <span class="k-str">50%</span> { <span class="k-attr">opacity</span>: <span class="k-str">0</span>; }
}

<span class="k-comment">/* Responsividade */</span>
<span class="k-tag">@media</span> (<span class="k-attr">max-width</span>: <span class="k-str">768px</span>) {
    <span class="k-tag">.brand-title</span> { <span class="k-attr">font-size</span>: <span class="k-str">2rem</span>; }
    <span class="k-tag">.alura-gemini-text</span> { <span class="k-attr">font-size</span>: <span class="k-str">0.7rem</span>; }
    <span class="k-tag">.project-subtitle</span> { <span class="k-attr">font-size</span>: <span class="k-str">0.8rem</span>; }
}`;

        const jsCode = `
<span class="k-comment">// ==========================================</span>
<span class="k-comment">// 1. THREE.JS SCENE SETUP</span>
<span class="k-comment">// ==========================================</span>
<span class="k-var">const</span> <span class="k-def">canvas</span> = <span class="k-obj">document</span>.<span class="k-func">getElementById</span>(<span class="k-str">'canvas-preview'</span>);
<span class="k-var">const</span> <span class="k-def">container</span> = <span class="k-obj">document</span>.<span class="k-func">getElementById</span>(<span class="k-str">'scene-container'</span>);

<span class="k-comment">// Cena</span>
<span class="k-var">const</span> <span class="k-def">scene</span> = <span class="k-import">new</span> <span class="k-obj">THREE</span>.<span class="k-obj">Scene</span>();

<span class="k-comment">// Câmera</span>
<span class="k-var">const</span> <span class="k-def">camera</span> = <span class="k-import">new</span> <span class="k-obj">THREE</span>.<span class="k-obj">PerspectiveCamera</span>(<span class="k-str">75</span>, <span class="k-obj">window</span>.<span class="k-obj">innerWidth</span> / <span class="k-obj">window</span>.<span class="k-obj">innerHeight</span>, <span class="k-str">0.1</span>, <span class="k-str">1000</span>);
<span class="k-def">camera</span>.<span class="k-obj">position</span>.<span class="k-obj">z</span> = <span class="k-str">3</span>;

<span class="k-comment">// Renderizador</span>
<span class="k-var">const</span> <span class="k-def">renderer</span> = <span class="k-import">new</span> <span class="k-obj">THREE</span>.<span class="k-obj">WebGLRenderer</span>({ 
    <span class="k-attr">canvas</span>: <span class="k-def">canvas</span>, 
    <span class="k-attr">alpha</span>: <span class="k-var">true</span>, 
    <span class="k-attr">antialias</span>: <span class="k-var">true</span> 
});
<span class="k-def">renderer</span>.<span class="k-func">setSize</span>(<span class="k-obj">window</span>.<span class="k-obj">innerWidth</span>, <span class="k-obj">window</span>.<span class="k-obj">innerHeight</span>);
<span class="k-def">renderer</span>.<span class="k-func">setPixelRatio</span>(<span class="k-obj">Math</span>.<span class="k-func">min</span>(<span class="k-obj">window</span>.<span class="k-obj">devicePixelRatio</span>, <span class="k-str">2</span>));

<span class="k-comment">// ==========================================</span>
<span class="k-comment">// 2. PARTICLE SYSTEM</span>
<span class="k-comment">// ==========================================</span>
<span class="k-var">const</span> <span class="k-def">geometry</span> = <span class="k-import">new</span> <span class="k-obj">THREE</span>.<span class="k-obj">BufferGeometry</span>();
<span class="k-var">const</span> <span class="k-def">particlesCount</span> = <span class="k-str">3000</span>;
<span class="k-var">const</span> <span class="k-def">posArray</span> = <span class="k-import">new</span> <span class="k-obj">Float32Array</span>(<span class="k-def">particlesCount</span> * <span class="k-str">3</span>);

<span class="k-comment">// Distribuição aleatória de partículas</span>
<span class="k-import">for</span>(<span class="k-var">let</span> <span class="k-def">i</span> = <span class="k-str">0</span>; <span class="k-def">i</span> < <span class="k-def">particlesCount</span> * <span class="k-str">3</span>; <span class="k-def">i</span>++) {
    <span class="k-def">posArray</span>[<span class="k-def">i</span>] = (<span class="k-obj">Math</span>.<span class="k-func">random</span>() - <span class="k-str">0.5</span>) * <span class="k-str">15</span>; 
}

<span class="k-def">geometry</span>.<span class="k-func">setAttribute</span>(<span class="k-str">'position'</span>, <span class="k-import">new</span> <span class="k-obj">THREE</span>.<span class="k-obj">BufferAttribute</span>(<span class="k-def">posArray</span>, <span class="k-str">3</span>));

<span class="k-comment">// Material das partículas</span>
<span class="k-var">const</span> <span class="k-def">material</span> = <span class="k-import">new</span> <span class="k-obj">THREE</span>.<span class="k-obj">PointsMaterial</span>({
    <span class="k-attr">size</span>: <span class="k-str">0.02</span>,
    <span class="k-attr">color</span>: <span class="k-str">0x0078d7</span>, <span class="k-comment">// Azul Azure</span>
    <span class="k-attr">transparent</span>: <span class="k-var">true</span>,
    <span class="k-attr">opacity</span>: <span class="k-str">0.8</span>,
    <span class="k-attr">blending</span>: <span class="k-obj">THREE</span>.<span class="k-obj">AdditiveBlending</span>,
    <span class="k-attr">sizeAttenuation</span>: <span class="k-var">true</span>
});

<span class="k-comment">// Mesh</span>
<span class="k-var">const</span> <span class="k-def">particlesMesh</span> = <span class="k-import">new</span> <span class="k-obj">THREE</span>.<span class="k-obj">Points</span>(<span class="k-def">geometry</span>, <span class="k-def">material</span>);
<span class="k-def">scene</span>.<span class="k-func">add</span>(<span class="k-def">particlesMesh</span>);

<span class="k-comment">// ==========================================</span>
<span class="k-comment">// 3. INTERACTION & ANIMATION</span>
<span class="k-comment">// ==========================================</span>

<span class="k-comment">// Mouse Interaction (Parallax Suave)</span>
<span class="k-var">let</span> <span class="k-def">mouseX</span> = <span class="k-str">0</span>;
<span class="k-var">let</span> <span class="k-def">mouseY</span> = <span class="k-str">0</span>;
<span class="k-var">let</span> <span class="k-def">targetX</span> = <span class="k-str">0</span>;
<span class="k-var">let</span> <span class="k-def">targetY</span> = <span class="k-str">0</span>;

<span class="k-var">const</span> <span class="k-def">windowHalfX</span> = <span class="k-obj">window</span>.<span class="k-obj">innerWidth</span> / <span class="k-str">2</span>;
<span class="k-var">const</span> <span class="k-def">windowHalfY</span> = <span class="k-obj">window</span>.<span class="k-obj">innerHeight</span> / <span class="k-str">2</span>;

<span class="k-obj">document</span>.<span class="k-func">addEventListener</span>(<span class="k-str">'mousemove'</span>, (<span class="k-def">event</span>) => {
    <span class="k-def">mouseX</span> = (<span class="k-def">event</span>.<span class="k-def">clientX</span> - <span class="k-def">windowHalfX</span>);
    <span class="k-def">mouseY</span> = (<span class="k-def">event</span>.<span class="k-def">clientY</span> - <span class="k-def">windowHalfY</span>);
});

<span class="k-var">const</span> <span class="k-def">clock</span> = <span class="k-import">new</span> <span class="k-obj">THREE</span>.<span class="k-obj">Clock</span>();

<span class="k-func">function</span> <span class="k-func">animate</span>() {
    <span class="k-var">const</span> <span class="k-def">elapsedTime</span> = <span class="k-def">clock</span>.<span class="k-func">getElapsedTime</span>();

    <span class="k-comment">// Rotação automática constante</span>
    <span class="k-def">particlesMesh</span>.<span class="k-obj">rotation</span>.<span class="k-obj">y</span> = <span class="k-def">elapsedTime</span> * <span class="k-str">0.05</span>;
    <span class="k-def">particlesMesh</span>.<span class="k-obj">rotation</span>.<span class="k-obj">x</span> = <span class="k-def">elapsedTime</span> * <span class="k-str">0.02</span>;

    <span class="k-comment">// Efeito Parallax com Mouse (Suavizado)</span>
    <span class="k-def">targetX</span> = <span class="k-def">mouseX</span> * <span class="k-str">0.001</span>;
    <span class="k-def">targetY</span> = <span class="k-def">mouseY</span> * <span class="k-str">0.001</span>;

    <span class="k-def">particlesMesh</span>.<span class="k-obj">rotation</span>.<span class="k-obj">y</span> += <span class="k-str">0.05</span> * (<span class="k-def">targetX</span> - <span class="k-def">particlesMesh</span>.<span class="k-obj">rotation</span>.<span class="k-obj">y</span>);
    <span class="k-def">particlesMesh</span>.<span class="k-obj">rotation</span>.<span class="k-obj">x</span> += <span class="k-str">0.05</span> * (<span class="k-def">targetY</span> - <span class="k-def">particlesMesh</span>.<span class="k-obj">rotation</span>.<span class="k-obj">x</span>);

    <span class="k-def">renderer</span>.<span class="k-func">render</span>(<span class="k-def">scene</span>, <span class="k-def">camera</span>);
    <span class="k-func">requestAnimationFrame</span>(<span class="k-func">animate</span>);
}

<span class="k-func">animate</span>();`;

        const fileSequence = [
            { id: 'html', type: 'html', code: htmlCode, name: 'index.html', icon: 'fa-html5', color: '#e65100' },
            { id: 'css', type: 'css', code: cssCode, name: 'styles.css', icon: 'fa-css3', color: '#42a5f5' },
            { id: 'js', type: 'js', code: jsCode, name: 'main.js', icon: 'fa-js', color: '#fdd835' }
        ];

        let currentFileIndex = 0;
        let currentCodeChunks = [];

        function updateUIForFile(fileData) {
            document.querySelectorAll('.vs-file').forEach(el => el.classList.remove('active'));
            document.getElementById(`file-${fileData.id}`).classList.add('active');

            const tab = document.getElementById('active-tab');
            tab.innerHTML = `<i class="fa-brands ${fileData.icon}" style="color: ${fileData.color}"></i> ${fileData.name}`;
            
            document.getElementById('vs-window-title').innerText = `${fileData.name} - Visual Studio Code`;

            container.innerHTML = '<span class="typing-cursor"></span>';
            state.index = 0;
            currentCodeChunks = fileData.code.split(/(?=<span)|(?<=<\/span>)/g);
        }

        updateUIForFile(fileSequence[0]);

        // Function to type the next chunk (reusable)
        function typeNextChunk() {
            if (!state.previewVisible) {
                state.previewVisible = true;
                const prevPanel = document.getElementById('preview-container');
                prevPanel.style.opacity = 1;
            }

            if (state.index >= currentCodeChunks.length) {
                if (currentFileIndex < fileSequence.length - 1) {
                    currentFileIndex++;
                    updateUIForFile(fileSequence[currentFileIndex]);
                } else {
                    checkCodeProgress(container.innerText);
                }
                return;
            }

            const chunk = currentCodeChunks[state.index];
            const cursor = document.querySelector('.typing-cursor');
            if(cursor) {
                cursor.insertAdjacentHTML('beforebegin', chunk);
                state.index++;
                // Important: Only scroll the internal container, never the window
                if(container) container.scrollTop = container.scrollHeight;
            }

            if (fileSequence[currentFileIndex].id === 'js') {
                checkCodeProgress(container.innerText);
            }
        }

        document.addEventListener('keydown', (e) => {
            if(!state.isCoding || state.errorStage) return;
            typeNextChunk();
        });

        let typeWriterStarted = false;
        function checkCodeProgress(text) {
            if(text.includes('const scene') && !typeWriterStarted) {
                typeWriterStarted = true;
                typeWriter("IMERSÃO DEV", document.getElementById('typewriter-text'));
            }

            if(text.includes('particlesMesh = new THREE.Points')) {
                gsap.to('#sub-brand', { opacity: 1, y: 0, duration: 0.8, ease: "power2.out" });
                gsap.to('#sub-proj', { opacity: 1, y: 0, duration: 0.8, ease: "power2.out", delay: 0.2 });
            }

            if(text.includes('animate();')) {
                // Only trigger error on Desktop
                if(window.innerWidth >= 768) {
                    // Wait a bit then trigger error logic (managed by user input usually, but let's leave logic for CTA)
                } else {
                    // Mobile: Ensure state is set to access granted immediately
                    state.accessGranted = true;
                }
                
                gsap.to('#cta-btn', { opacity: 1, y: 0, duration: 0.8, ease: "back.out(1.7)" });
                
                const hint = document.getElementById('typing-hint');
                if(window.innerWidth < 768) {
                    hint.innerText = "CÓDIGO AUTOMATIZADO. ACESSO LIBERADO.";
                } else {
                    hint.innerHTML = "CÓDIGO FINALIZADO. CLIQUE EM 'ACESSAR SITE'.";
                }
                
                document.getElementById('status-bar-text').innerText = "COMPILATION SUCCESS";
            }
        }

        function typeWriter(text, element) {
            let i = 0;
            const interval = setInterval(() => {
                element.innerHTML += text.charAt(i);
                i++;
                if(i >= text.length) clearInterval(interval);
            }, 100);
        }

        // ==========================================
        // MOBILE AUTO TYPING
        // ==========================================
        function startMobileAutoTyping() {
            // Slower typing speed for mobile to be readable
            const typingSpeed = 40; 
            
            const autoTyper = setInterval(() => {
                // Stop if we are done with all files
                if (currentFileIndex === fileSequence.length - 1 && state.index >= currentCodeChunks.length) {
                    clearInterval(autoTyper);
                    return;
                }
                typeNextChunk();
            }, typingSpeed);
        }

        // ==========================================
        // ERROR & GEMINI FIX SEQUENCE
        // ==========================================
        const prevBtn = document.getElementById('cta-btn'); 
        const modal = document.getElementById('error-modal');
        const closeModal = document.getElementById('btn-close-modal');
        const ackModal = document.getElementById('btn-ack-error');
        const geminiTool = document.getElementById('gemini-tool');
        const successModal = document.getElementById('gemini-success-modal');
        const closeSuccess = document.getElementById('btn-close-success');

        function triggerError() {
            state.errorStage = true;
            
            if (currentFileIndex !== 2) {
                currentFileIndex = 2;
                updateUIForFile(fileSequence[2]);
                const cursor = document.querySelector('.typing-cursor');
                currentCodeChunks.forEach(c => cursor.insertAdjacentHTML('beforebegin', c));
            }

            document.getElementById('scene-vscode').classList.add('glitch-error');
            document.getElementById('code-container').style.color = 'red';
            document.getElementById('status-bar-text').innerText = "CRITICAL ERROR DETECTED";
            document.getElementById('status-bar-text').style.background = "red";
            
            modal.style.display = 'flex';
            gsap.to(modal, { opacity: 1, scale: 1, duration: 0.3, ease: "back.out" });
        }

        function hideErrorModal() {
            gsap.to(modal, { opacity: 0, scale: 0.8, duration: 0.2, onComplete: () => {
                modal.style.display = 'none';
                geminiTool.classList.add('pulse');
                document.getElementById('typing-hint').innerText = "CLIQUE NO BOTÃO GEMINI (BARRA LATERAL) PARA CORRIGIR.";
            }});
        }
        closeModal.addEventListener('click', hideErrorModal);
        ackModal.addEventListener('click', hideErrorModal);

        geminiTool.addEventListener('click', () => {
            if(!state.errorStage || state.fixed) return;
            
            geminiTool.classList.remove('pulse');
            currentFileIndex = 2; 
            updateUIForFile(fileSequence[2]); 

            const container = document.getElementById('code-container');
            container.style.color = '#d4d4d4'; 
            document.getElementById('scene-vscode').classList.remove('glitch-error');
            document.getElementById('status-bar-text').innerText = "GEMINI AI REWRITING...";
            document.getElementById('status-bar-text').style.background = "#8e24aa"; 

            triggerGeminiRewrite();
        });

        function triggerGeminiRewrite() {
            const chunks = jsCode.split(/(?=<span)|(?<=<\/span>)/g);
            let i = 0;

            const slowType = setInterval(() => {
                if(i >= chunks.length) {
                    clearInterval(slowType);
                    state.fixed = true;
                    state.errorStage = false;
                    showSuccessModal();
                    return;
                }
                
                const cursor = document.querySelector('.typing-cursor');
                let chunk = chunks[i];
                if(chunk.includes('k-')) chunk = chunk.replace('class="', 'class="gemini-glow ');
                
                cursor.insertAdjacentHTML('beforebegin', chunk);
                if(container) container.scrollTop = container.scrollHeight;
                i++;
            }, 20); 
        }

        function showSuccessModal() {
            successModal.style.display = 'flex';
            gsap.to(successModal, { opacity: 1, scale: 1, duration: 0.5, ease: "back.out" });
        }

        closeSuccess.addEventListener('click', () => {
            gsap.to(successModal, { opacity: 0, scale: 0.9, duration: 0.3, onComplete: () => {
                successModal.style.display = 'none';
                
                state.accessGranted = true;
                document.getElementById('typing-hint').innerText = "CORREÇÃO COMPLETA. ACESSO LIBERADO.";
                document.getElementById('status-bar-text').innerText = "READY";
                document.getElementById('status-bar-text').style.background = "#007acc";
                
                // Reset button style in preview
                const btn = document.getElementById('cta-btn');
                if(btn) {
                    btn.style.border = "1px solid #00ff00";
                    btn.style.color = "#00ff00";
                }
            }});
        });

        // ==========================================
        // THREE.JS STARFIELD (PREVIEW LOGIC)
        // ==========================================
        let particlesMesh, camera, material; 

        function initGeminiPreview() {
            const canvas = document.getElementById('canvas-preview');
            const container = document.getElementById('preview-container'); // Use preview container for sizing

            const scene = new THREE.Scene();
            
            // Correct Sizing based on container
            const width = container.clientWidth;
            const height = container.clientHeight;

            camera = new THREE.PerspectiveCamera(75, width / height, 0.1, 1000);
            camera.position.z = 3;

            const renderer = new THREE.WebGLRenderer({ canvas: canvas, alpha: true, antialias: true });
            renderer.setSize(width, height);
            renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));

            const geometry = new THREE.BufferGeometry();
            const count = 3000;
            const posArray = new Float32Array(count * 3);

            for(let i=0; i<count*3; i++) {
                posArray[i] = (Math.random() - 0.5) * 15; 
            }

            geometry.setAttribute('position', new THREE.BufferAttribute(posArray, 3));
            
            material = new THREE.PointsMaterial({ 
                size: 0.02, 
                color: 0x0078d7, 
                transparent: true, 
                opacity: 0.8,
                blending: THREE.AdditiveBlending,
                sizeAttenuation: true
            });
            
            particlesMesh = new THREE.Points(geometry, material);
            scene.add(particlesMesh);

            // Mouse Interaction Logic
            let mouseX = 0;
            let mouseY = 0;
            const windowHalfX = width / 2;
            const windowHalfY = height / 2;

            container.addEventListener('mousemove', (event) => {
                const rect = container.getBoundingClientRect();
                mouseX = (event.clientX - rect.left) - windowHalfX;
                mouseY = (event.clientY - rect.top) - windowHalfY;
            });

            // Handle Resize Logic for vertical layout on mobile
            window.addEventListener('resize', () => {
                const newWidth = container.clientWidth;
                const newHeight = container.clientHeight;
                renderer.setSize(newWidth, newHeight);
                camera.aspect = newWidth / newHeight;
                camera.updateProjectionMatrix();
            });

            const clock = new THREE.Clock();

            const animate = () => {
                requestAnimationFrame(animate);
                
                const elapsedTime = clock.getElapsedTime();

                particlesMesh.rotation.y = elapsedTime * 0.05;
                particlesMesh.rotation.x = elapsedTime * 0.02;

                const targetX = mouseX * 0.001;
                const targetY = mouseY * 0.001;

                particlesMesh.rotation.y += 0.05 * (targetX - particlesMesh.rotation.y);
                particlesMesh.rotation.x += 0.05 * (targetY - particlesMesh.rotation.x);
                
                // Error state visual feedback
                if(state.errorStage && !state.fixed) {
                    material.color.setHex(0xff0000);
                    particlesMesh.rotation.z += 0.05;
                } else if(state.fixed) {
                    material.color.setHex(0x00ff00);
                } else {
                    material.color.setHex(0x0078d7);
                }

                renderer.render(scene, camera);
            };
            animate();

            // Button Interaction inside Preview
            const ctaBtn = document.getElementById('cta-btn');
            if(ctaBtn) {
                ctaBtn.addEventListener('click', (e) => {
                    // Mobile check: always allow access on mobile
                    const isMobile = window.innerWidth < 768;
                    
                    if(!state.accessGranted && !isMobile) {
                        triggerError();
                        return;
                    }

                    const btn = e.target;
                    btn.innerHTML = "CARREGANDO...";
                    material.color.setHex(0x00ff00);
                    
                    gsap.to(particlesMesh.rotation, {
                        z: 5, duration: 2, ease: "expo.in"
                    });

                    gsap.to(camera.position, {
                        z: 0.5, duration: 2, ease: "expo.in",
                        onComplete: () => {
                            window.location.href = "main.html"; 
                        }
                    });
                });
            }
        }

    </script>
</body>
</html>